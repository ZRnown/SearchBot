{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/lib/admin-api.ts"],"sourcesContent":["// 获取后端 API 地址\n// 优先使用 ADMIN_API_BASE_URL，如果没有则使用默认值\nconst getBaseUrl = () => {\n  if (process.env.ADMIN_API_BASE_URL) {\n    return process.env.ADMIN_API_BASE_URL\n  }\n  // 默认使用 localhost\n  const port = process.env.WEB_PORT ?? \"8000\"\n  return `http://127.0.0.1:${port}`\n}\n\nconst BASE_URL = getBaseUrl()\n\n// 调试：输出 BASE_URL（仅在开发环境）\nif (process.env.NODE_ENV !== \"production\") {\n  console.log(\"[admin-api] BASE_URL:\", BASE_URL)\n}\n\nexport async function adminFetch(path: string, init?: RequestInit, token?: string) {\n  const url = path.startsWith(\"http\") ? path : `${BASE_URL}${path}`\n  const headers = new Headers(init?.headers)\n  if (token) {\n    headers.set(\"Authorization\", `Bearer ${token}`)\n  }\n  const response = await fetch(url, {\n    ...init,\n    headers,\n  })\n  return response\n}\n\n"],"names":[],"mappings":"AAAA,cAAc;AACd,qCAAqC;;;;;AACrC,MAAM,aAAa;IACjB,IAAI,QAAQ,GAAG,CAAC,kBAAkB,EAAE;QAClC,OAAO,QAAQ,GAAG,CAAC,kBAAkB;IACvC;IACA,iBAAiB;IACjB,MAAM,OAAO,QAAQ,GAAG,CAAC,QAAQ,IAAI;IACrC,OAAO,CAAC,iBAAiB,EAAE,MAAM;AACnC;AAEA,MAAM,WAAW;AAEjB,yBAAyB;AACzB,wCAA2C;IACzC,QAAQ,GAAG,CAAC,yBAAyB;AACvC;AAEO,eAAe,WAAW,IAAY,EAAE,IAAkB,EAAE,KAAc;IAC/E,MAAM,MAAM,KAAK,UAAU,CAAC,UAAU,OAAO,GAAG,WAAW,MAAM;IACjE,MAAM,UAAU,IAAI,QAAQ,MAAM;IAClC,IAAI,OAAO;QACT,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IAChD;IACA,MAAM,WAAW,MAAM,MAAM,KAAK;QAChC,GAAG,IAAI;QACP;IACF;IACA,OAAO;AACT"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { adminFetch } from \"@/lib/admin-api\"\n\nexport async function POST(request: Request) {\n  const payload = await request.json()\n  const upstream = await adminFetch(\"/auth/login\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const text = await upstream.text()\n  let data: any = {}\n  if (text) {\n    try {\n      data = JSON.parse(text)\n    } catch {\n      return new NextResponse(text, { status: upstream.status })\n    }\n  }\n  if (!upstream.ok) {\n    return NextResponse.json(data, { status: upstream.status })\n  }\n  const response = NextResponse.json({ username: payload.username })\n  // 判断是否为 HTTPS（只有在明确设置 FORCE_SECURE_COOKIE=true 时才使用 secure）\n  // 默认在 HTTP 环境下不使用 secure\n  const isSecure = process.env.FORCE_SECURE_COOKIE === \"true\"\n  response.cookies.set(\"admin_token\", data.access_token, {\n    httpOnly: true,\n    sameSite: \"lax\",\n    secure: isSecure, // HTTP 环境下为 false\n    path: \"/\",\n    maxAge: data.expires_in ?? 3600 * 24 * 7, // 默认7天\n  })\n  return response\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAgB;IACzC,MAAM,UAAU,MAAM,QAAQ,IAAI;IAClC,MAAM,WAAW,MAAM,IAAA,mIAAU,EAAC,eAAe;QAC/C,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,IAAI,OAAY,CAAC;IACjB,IAAI,MAAM;QACR,IAAI;YACF,OAAO,KAAK,KAAK,CAAC;QACpB,EAAE,OAAM;YACN,OAAO,IAAI,+QAAY,CAAC,MAAM;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAC1D;IACF;IACA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,OAAO,+QAAY,CAAC,IAAI,CAAC,MAAM;YAAE,QAAQ,SAAS,MAAM;QAAC;IAC3D;IACA,MAAM,WAAW,+QAAY,CAAC,IAAI,CAAC;QAAE,UAAU,QAAQ,QAAQ;IAAC;IAChE,4DAA4D;IAC5D,yBAAyB;IACzB,MAAM,WAAW,QAAQ,GAAG,CAAC,mBAAmB,KAAK;IACrD,SAAS,OAAO,CAAC,GAAG,CAAC,eAAe,KAAK,YAAY,EAAE;QACrD,UAAU;QACV,UAAU;QACV,QAAQ;QACR,MAAM;QACN,QAAQ,KAAK,UAAU,IAAI,OAAO,KAAK;IACzC;IACA,OAAO;AACT"}}]
}