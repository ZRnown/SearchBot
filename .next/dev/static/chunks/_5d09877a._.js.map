{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,uOAAO,EAAC,IAAA,iMAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,qPAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,+SAAI,GAAG;IAE9B,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/sidebar.tsx"],"sourcesContent":["\"use client\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Book, Heart, Settings, List, Link2, Users, PanelLeftClose, PanelLeft } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\n\ntype NavItem = \"novel-audio\" | \"comic\" | \"resources\" | \"buttons\" | \"users\" | \"settings\"\n\ninterface SidebarProps {\n  activeItem: NavItem\n  onItemChange: (item: NavItem) => void\n  collapsed: boolean\n  onCollapsedChange: (collapsed: boolean) => void\n  onLogout?: () => void\n}\n\nconst navItems = [\n  { id: \"novel-audio\" as const, label: \"小说 / 音频\", icon: Book },\n  { id: \"comic\" as const, label: \"漫画上传\", icon: Heart },\n  { id: \"resources\" as const, label: \"资源管理\", icon: List },\n  { id: \"buttons\" as const, label: \"搜索结果按钮\", icon: Link2 },\n  { id: \"users\" as const, label: \"用户管理\", icon: Users },\n  { id: \"settings\" as const, label: \"设置\", icon: Settings },\n]\n\nexport function Sidebar({ activeItem, onItemChange, collapsed, onCollapsedChange, onLogout }: SidebarProps) {\n  return (\n    <aside\n      className={cn(\n        \"flex flex-col border-r border-border bg-sidebar h-screen transition-all duration-300 sticky top-0\",\n        collapsed ? \"w-16\" : \"w-60\",\n      )}\n    >\n      <div className=\"flex items-center justify-between p-4 border-b border-border\">\n        {!collapsed && <span className=\"font-semibold text-sidebar-foreground text-balance\">TG 资源管理器</span>}\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => onCollapsedChange(!collapsed)}\n          className=\"text-sidebar-foreground\"\n        >\n          {collapsed ? <PanelLeft className=\"h-5 w-5\" /> : <PanelLeftClose className=\"h-5 w-5\" />}\n        </Button>\n      </div>\n\n      <nav className=\"flex-1 p-2 space-y-1\">\n        {navItems.map((item) => {\n          const Icon = item.icon\n          const isActive = activeItem === item.id\n          return (\n            <button\n              key={item.id}\n              onClick={() => onItemChange(item.id)}\n              className={cn(\n                \"flex items-center gap-3 w-full px-3 py-2.5 rounded-lg text-sm font-medium transition-colors\",\n                isActive\n                  ? \"bg-sidebar-accent text-sidebar-primary\"\n                  : \"text-sidebar-foreground hover:bg-sidebar-accent/50\",\n              )}\n            >\n              <Icon className=\"h-5 w-5 shrink-0\" />\n              {!collapsed && <span>{item.label}</span>}\n            </button>\n          )\n        })}\n      </nav>\n\n      <div className=\"p-2 border-t border-border\">\n        <Button\n          variant=\"ghost\"\n          className=\"w-full justify-center text-sm text-sidebar-foreground\"\n          onClick={onLogout}\n          disabled={!onLogout}\n        >\n          退出登录\n        </Button>\n      </div>\n    </aside>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;;;;;AAgBA,MAAM,WAAW;IACf;QAAE,IAAI;QAAwB,OAAO;QAAW,MAAM,iSAAI;IAAC;IAC3D;QAAE,IAAI;QAAkB,OAAO;QAAQ,MAAM,oSAAK;IAAC;IACnD;QAAE,IAAI;QAAsB,OAAO;QAAQ,MAAM,iSAAI;IAAC;IACtD;QAAE,IAAI;QAAoB,OAAO;QAAU,MAAM,wSAAK;IAAC;IACvD;QAAE,IAAI;QAAkB,OAAO;QAAQ,MAAM,oSAAK;IAAC;IACnD;QAAE,IAAI;QAAqB,OAAO;QAAM,MAAM,6SAAQ;IAAC;CACxD;AAEM,SAAS,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAE,SAAS,EAAE,iBAAiB,EAAE,QAAQ,EAAgB;IACxG,qBACE,4TAAC;QACC,WAAW,IAAA,qHAAE,EACX,qGACA,YAAY,SAAS;;0BAGvB,4TAAC;gBAAI,WAAU;;oBACZ,CAAC,2BAAa,4TAAC;wBAAK,WAAU;kCAAqD;;;;;;kCACpF,4TAAC,wIAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS,IAAM,kBAAkB,CAAC;wBAClC,WAAU;kCAET,0BAAY,4TAAC,oTAAS;4BAAC,WAAU;;;;;iDAAe,4TAAC,uUAAc;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAI/E,4TAAC;gBAAI,WAAU;0BACZ,SAAS,GAAG,CAAC,CAAC;oBACb,MAAM,OAAO,KAAK,IAAI;oBACtB,MAAM,WAAW,eAAe,KAAK,EAAE;oBACvC,qBACE,4TAAC;wBAEC,SAAS,IAAM,aAAa,KAAK,EAAE;wBACnC,WAAW,IAAA,qHAAE,EACX,+FACA,WACI,2CACA;;0CAGN,4TAAC;gCAAK,WAAU;;;;;;4BACf,CAAC,2BAAa,4TAAC;0CAAM,KAAK,KAAK;;;;;;;uBAV3B,KAAK,EAAE;;;;;gBAalB;;;;;;0BAGF,4TAAC;gBAAI,WAAU;0BACb,cAAA,4TAAC,wIAAM;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS;oBACT,UAAU,CAAC;8BACZ;;;;;;;;;;;;;;;;;AAMT;KAtDgB"}},
    {"offset": {"line": 253, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 373, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,4TAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 404, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/label.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as LabelPrimitive from '@radix-ui/react-label'\n\nimport { cn } from '@/lib/utils'\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,4TAAC,gYAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 437, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/badge.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst badgeVariants = cva(\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\n        destructive:\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'span'> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : 'span'\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,qPAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,+SAAI,GAAG;IAE9B,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS"}},
    {"offset": {"line": 489, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/lib/api.ts"],"sourcesContent":["export type ResourceRecord = {\n  id: string\n  title: string\n  type: \"novel\" | \"audio\" | \"comic\"\n  isVip: boolean\n  link: string\n  previewLink?: string | null\n  deepLink?: string | null\n  createdAt: string\n}\n\nexport type ComicUploadResult = {\n  id: string\n  pages: number\n  deepLink: string\n  previewLink: string\n}\n\nexport type ComicFileRecord = {\n  id: number\n  fileId: string\n  order: number\n}\n\nexport type ComicFilesData = {\n  resourceId: string\n  title: string\n  files: ComicFileRecord[]\n}\n\nexport type SearchButtonRecord = {\n  id: number\n  label: string\n  url: string\n  sortOrder: number\n}\n\nexport type SettingsPayload = {\n  pageSize: number\n  searchChannelId: number\n  comicPreviewChannelId: number\n  storageChannelId: number\n}\n\nexport type UserRecord = {\n  userId: number\n  firstName: string | null\n  username: string | null\n  vipExpiry: string | null\n  isBlocked: boolean\n  usageQuota: number\n  createdAt: string\n  updatedAt: string\n}\n\nasync function handleJson<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    const text = await response.text()\n    throw new Error(text || `Request failed with status ${response.status}`)\n  }\n  return (await response.json()) as T\n}\n\nexport async function fetchResources(\n  filter: \"all\" | \"novel\" | \"audio\" | \"comic\" = \"all\",\n  skip: number = 0,\n  limit: number = 50\n) {\n  const params = new URLSearchParams()\n  if (filter !== \"all\") {\n    params.append(\"type\", filter)\n  }\n  params.append(\"skip\", skip.toString())\n  params.append(\"limit\", limit.toString())\n  const query = params.toString() ? `?${params.toString()}` : \"\"\n  const response = await fetch(`/api/resources${query}`, { cache: \"no-store\" })\n  const data = await handleJson<any[]>(response)\n  return data.map((item) => ({\n    id: item.id,\n    title: item.title,\n    type: item.type,\n    isVip: item.is_vip,\n    link: item.link,\n    previewLink: item.preview_link,\n    deepLink: item.deep_link,\n    createdAt: item.created_at,\n  })) as ResourceRecord[]\n}\n\nexport async function createIndexedResource(payload: {\n  title: string\n  type: \"novel\" | \"audio\"\n  jump_url: string\n}) {\n  const response = await fetch(\"/api/resources/indexed\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    title: item.title,\n    type: item.type,\n    isVip: item.is_vip ?? false,\n    link: item.link,\n    previewLink: item.preview_link ?? item.link,\n    deepLink: null,\n    createdAt: new Date().toISOString(),\n  } as ResourceRecord\n}\n\nexport async function deleteResource(resourceId: string) {\n  const response = await fetch(`/api/resources/${resourceId}`, { method: \"DELETE\" })\n  if (!response.ok) {\n    const message = await response.text()\n    throw new Error(message || \"删除失败\")\n  }\n}\n\nexport async function batchDeleteResources(resourceIds: string[]) {\n  const response = await fetch(\"/api/resources/batch-delete\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(resourceIds),\n  })\n  if (!response.ok) {\n    const message = await response.text()\n    throw new Error(message || \"批量删除失败\")\n  }\n}\n\nexport async function updateResource(resourceId: string, payload: {\n  title?: string\n  jump_url?: string\n  preview_url?: string\n}) {\n  const response = await fetch(`/api/resources/${resourceId}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    title: item.title,\n    type: item.type,\n    isVip: item.is_vip,\n    link: item.link,\n    previewLink: item.preview_link,\n    deepLink: item.deep_link,\n    createdAt: item.created_at,\n  } as ResourceRecord\n}\n\nexport async function uploadComic(payload: { title: string; isVip: boolean; files: File[] }) {\n  const form = new FormData()\n  form.append(\"title\", payload.title)\n  form.append(\"is_vip\", String(payload.isVip))\n  form.append(\"preview_count\", \"5\")  // 默认发送前5张预览图\n  payload.files.forEach((file) => form.append(\"files\", file, file.name))\n  const response = await fetch(\"/api/resources/comics\", {\n    method: \"POST\",\n    body: form,\n  })\n  const data = await handleJson<any>(response)\n  return {\n    id: data.id,\n    pages: data.pages,\n    deepLink: data.deep_link,\n    previewLink: data.preview_link,\n  } as ComicUploadResult\n}\n\nexport async function uploadComicArchive(payload: {\n  title: string\n  isVip: boolean\n  archive: File\n  previewCount?: number\n}) {\n  const form = new FormData()\n  form.append(\"title\", payload.title)\n  form.append(\"is_vip\", String(payload.isVip))\n  form.append(\"archive\", payload.archive, payload.archive.name)\n  form.append(\"preview_count\", String(payload.previewCount ?? 5))\n  const response = await fetch(\"/api/resources/comics/archive\", {\n    method: \"POST\",\n    body: form,\n    // 增加超时时间以支持大文件上传（5分钟）\n    signal: AbortSignal.timeout(5 * 60 * 1000),\n  })\n  const data = await handleJson<any>(response)\n  return {\n    id: data.id,\n    pages: data.pages,\n    deepLink: data.deep_link,\n    previewLink: data.preview_link,\n  } as ComicUploadResult\n}\n\nexport async function batchUploadComicArchives(payload: {\n  archives: File[]\n  isVip: boolean\n  previewCount?: number\n}) {\n  const form = new FormData()\n  form.append(\"is_vip\", String(payload.isVip))\n  form.append(\"preview_count\", String(payload.previewCount ?? 5))\n  payload.archives.forEach((archive) => {\n    form.append(\"archives\", archive, archive.name)\n  })\n  const response = await fetch(\"/api/resources/comics/batch-archive\", {\n    method: \"POST\",\n    body: form,\n    // 增加超时时间以支持大文件批量上传（10分钟）\n    signal: AbortSignal.timeout(10 * 60 * 1000),\n  })\n  const data = await handleJson<any[]>(response)\n  return data.map((item) => ({\n    id: item.id,\n    pages: item.pages,\n    deepLink: item.deep_link,\n    previewLink: item.preview_link || item.deep_link,\n  })) as ComicUploadResult[]\n}\n\nexport async function getComicFiles(resourceId: string) {\n  const response = await fetch(`/api/resources/comics/${resourceId}/files`, {\n    cache: \"no-store\",\n  })\n  const data = await handleJson<any>(response)\n  return {\n    resourceId: data.resource_id,\n    title: data.title,\n    files: data.files.map((f: any) => ({\n      id: f.id,\n      fileId: f.file_id,\n      order: f.order,\n    })),\n  } as ComicFilesData\n}\n\nexport async function updateComicFilesOrder(\n  resourceId: string,\n  fileOrders: Array<{ id: number; order: number }>\n) {\n  const response = await fetch(`/api/resources/comics/${resourceId}/files/order`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ file_orders: fileOrders }),\n  })\n  await handleJson(response)\n}\n\nexport async function getComicFileUrl(fileId: string): Promise<string> {\n  const response = await fetch(`/api/resources/comics/files/${fileId}/url`, {\n    cache: \"no-store\",\n  })\n  const data = await handleJson<{ url: string }>(response)\n  return data.url\n}\n\nexport async function fetchSettings() {\n  const response = await fetch(\"/api/settings\", { cache: \"no-store\" })\n  const data = await handleJson<any>(response)\n  return {\n    pageSize: data.page_size,\n    searchChannelId: data.search_channel_id,\n    comicPreviewChannelId: data.comic_preview_channel_id,\n    storageChannelId: data.storage_channel_id,\n  } as SettingsPayload\n}\n\nexport async function fetchUsers(search?: string, skip: number = 0, limit: number = 50) {\n  const params = new URLSearchParams()\n  if (search) {\n    params.append(\"search\", search)\n  }\n  params.append(\"skip\", skip.toString())\n  params.append(\"limit\", limit.toString())\n  const query = params.toString() ? `?${params.toString()}` : \"\"\n  const response = await fetch(`/api/users${query}`, { cache: \"no-store\" })\n  const data = await handleJson<any[]>(response)\n  return data.map((item) => ({\n    userId: item.user_id,\n    firstName: item.first_name,\n    username: item.username,\n    vipExpiry: item.vip_expiry,\n    isBlocked: item.is_blocked,\n    usageQuota: item.usage_quota,\n    createdAt: item.created_at,\n    updatedAt: item.updated_at,\n  })) as UserRecord[]\n}\n\nexport async function updateUser(userId: number, payload: Partial<UserRecord>) {\n  const body: Record<string, unknown> = {}\n  if (payload.firstName !== undefined) {\n    body.first_name = payload.firstName\n  }\n  if (payload.username !== undefined) {\n    body.username = payload.username\n  }\n  if (payload.vipExpiry !== undefined) {\n    body.vip_expiry = payload.vipExpiry\n  }\n  if (payload.isBlocked !== undefined) {\n    body.is_blocked = payload.isBlocked\n  }\n  const response = await fetch(`/api/users/${userId}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(body),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    userId: item.user_id,\n    firstName: item.first_name,\n    username: item.username,\n    vipExpiry: item.vip_expiry,\n    isBlocked: item.is_blocked,\n    usageQuota: item.usage_quota,\n    createdAt: item.created_at,\n    updatedAt: item.updated_at,\n  } as UserRecord\n}\n\nexport async function deleteUser(userId: number) {\n  const response = await fetch(`/api/users/${userId}`, { method: \"DELETE\" })\n  if (!response.ok) {\n    const message = await response.text()\n    throw new Error(message || \"删除失败\")\n  }\n}\n\nexport async function batchDeleteUsers(userIds: number[]) {\n  const response = await fetch(\"/api/users/batch-delete\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(userIds),\n  })\n  if (!response.ok) {\n    const message = await response.text()\n    throw new Error(message || \"批量删除失败\")\n  }\n}\n\nexport async function fetchSearchButtons() {\n  const response = await fetch(\"/api/search-buttons\", { cache: \"no-store\" })\n  const data = await handleJson<any[]>(response)\n  return data.map((item) => ({\n    id: item.id,\n    label: item.label,\n    url: item.url,\n    sortOrder: item.sort_order,\n  })) as SearchButtonRecord[]\n}\n\nexport async function createSearchButton(payload: { label: string; url: string; sort_order: number }) {\n  const response = await fetch(\"/api/search-buttons\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    label: item.label,\n    url: item.url,\n    sortOrder: item.sort_order,\n  } as SearchButtonRecord\n}\n\nexport async function updateSearchButton(\n  buttonId: number,\n  payload: { label: string; url: string; sort_order: number },\n) {\n  const response = await fetch(`/api/search-buttons/${buttonId}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    label: item.label,\n    url: item.url,\n    sortOrder: item.sort_order,\n  } as SearchButtonRecord\n}\n\nexport async function deleteSearchButton(buttonId: number) {\n  const response = await fetch(`/api/search-buttons/${buttonId}`, { method: \"DELETE\" })\n  if (!response.ok) {\n    const text = await response.text()\n    throw new Error(text || \"删除失败\")\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 866, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/use-toast.ts"],"sourcesContent":["'use client'\n\n// Inspired by react-hot-toast library\nimport * as React from 'react'\n\nimport type { ToastActionElement, ToastProps } from '@/components/ui/toast'\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: 'ADD_TOAST',\n  UPDATE_TOAST: 'UPDATE_TOAST',\n  DISMISS_TOAST: 'DISMISS_TOAST',\n  REMOVE_TOAST: 'REMOVE_TOAST',\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType['ADD_TOAST']\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType['UPDATE_TOAST']\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType['DISMISS_TOAST']\n      toastId?: ToasterToast['id']\n    }\n  | {\n      type: ActionType['REMOVE_TOAST']\n      toastId?: ToasterToast['id']\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: 'REMOVE_TOAST',\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case 'ADD_TOAST':\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case 'UPDATE_TOAST':\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t,\n        ),\n      }\n\n    case 'DISMISS_TOAST': {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t,\n        ),\n      }\n    }\n    case 'REMOVE_TOAST':\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, 'id'>\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: 'UPDATE_TOAST',\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id })\n\n  dispatch({\n    type: 'ADD_TOAST',\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1033, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/novel-audio-form.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Book, Headphones, CheckCircle2 } from \"lucide-react\"\nimport { createIndexedResource } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\nexport function NovelAudioForm({ className = \"\" }: { className?: string } = {}) {\n  const [title, setTitle] = useState(\"\")\n  const [type, setType] = useState<\"novel\" | \"audio\">(\"novel\")\n  const [telegramLink, setTelegramLink] = useState(\"\")\n  const [synced, setSynced] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const { toast } = useToast()\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!title.trim() || !telegramLink.trim()) {\n      toast({\n        title: \"请填写完整信息\",\n        description: \"标题与 Telegram 链接不能为空\",\n        variant: \"destructive\",\n      })\n      return\n    }\n    try {\n      setLoading(true)\n      const resource = await createIndexedResource({\n        title: title.trim(),\n        type,\n        jump_url: telegramLink.trim(),\n      })\n    setSynced(true)\n      toast({\n        title: \"索引成功\",\n        description: `已创建资源：${resource.title}`,\n      })\n    setTimeout(() => setSynced(false), 3000)\n      setTitle(\"\")\n      setTelegramLink(\"\")\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"保存失败\"\n      toast({\n        title: \"保存失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Card className={className}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-card-foreground\">索引小说 / 音频</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <form onSubmit={handleSubmit} className=\"space-y-5\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"title\">标题</Label>\n            <Input id=\"title\" placeholder=\"输入资源标题...\" value={title} onChange={(e) => setTitle(e.target.value)} />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>资源类型</Label>\n            <div className=\"flex gap-2\">\n              <Button\n                type=\"button\"\n                variant={type === \"novel\" ? \"default\" : \"outline\"}\n                onClick={() => setType(\"novel\")}\n                className=\"flex-1\"\n              >\n                <Book className=\"h-4 w-4 mr-2\" />\n                小说\n              </Button>\n              <Button\n                type=\"button\"\n                variant={type === \"audio\" ? \"default\" : \"outline\"}\n                onClick={() => setType(\"audio\")}\n                className=\"flex-1\"\n              >\n                <Headphones className=\"h-4 w-4 mr-2\" />\n                音频\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"link\">Telegram 链接</Label>\n            <Input\n              id=\"link\"\n              placeholder=\"https://t.me/...\"\n              value={telegramLink}\n              onChange={(e) => setTelegramLink(e.target.value)}\n            />\n          </div>\n\n          <Button type=\"submit\" className=\"w-full\" disabled={loading}>\n            保存并同步到频道\n          </Button>\n\n          {synced && (\n            <Badge className=\"w-full justify-center py-2 bg-success text-success-foreground\">\n              <CheckCircle2 className=\"h-4 w-4 mr-2\" />\n              已同步到预览频道\n            </Badge>\n          )}\n        </form>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1306, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/switch.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SwitchPrimitive from '@radix-ui/react-switch'\n\nimport { cn } from '@/lib/utils'\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        'peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={\n          'bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0'\n        }\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,4TAAC,iYAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,4TAAC,kYAAqB;YACpB,aAAU;YACV,WACE;;;;;;;;;;;AAKV;KArBS"}},
    {"offset": {"line": 1347, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/progress.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ProgressPrimitive from '@radix-ui/react-progress'\n\nimport { cn } from '@/lib/utils'\n\nfunction Progress({\n  className,\n  value,\n  ...props\n}: React.ComponentProps<typeof ProgressPrimitive.Root>) {\n  return (\n    <ProgressPrimitive.Root\n      data-slot=\"progress\"\n      className={cn(\n        'bg-primary/20 relative h-2 w-full overflow-hidden rounded-full',\n        className,\n      )}\n      {...props}\n    >\n      <ProgressPrimitive.Indicator\n        data-slot=\"progress-indicator\"\n        className=\"bg-primary h-full w-full flex-1 transition-all\"\n        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n      />\n    </ProgressPrimitive.Root>\n  )\n}\n\nexport { Progress }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,SAAS,EAChB,SAAS,EACT,KAAK,EACL,GAAG,OACiD;IACpD,qBACE,4TAAC,gYAAsB;QACrB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;kBAET,cAAA,4TAAC,qYAA2B;YAC1B,aAAU;YACV,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;AAIlE;KArBS"}},
    {"offset": {"line": 1391, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/upload-dropzone.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useCallback, useState, useEffect } from \"react\"\nimport { useDropzone } from \"react-dropzone\"\nimport { Upload, X, GripVertical } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Progress } from \"@/components/ui/progress\"\nimport { cn } from \"@/lib/utils\"\n\ninterface UploadDropzoneProps {\n  images: File[]\n  onImagesChange: (images: File[]) => void\n  maxImages?: number\n}\n\nexport function UploadDropzone({ images, onImagesChange, maxImages = 200 }: UploadDropzoneProps) {\n  const [uploadProgress, setUploadProgress] = useState(0)\n  const [draggedIndex, setDraggedIndex] = useState<number | null>(null)\n  const [dragOverIndex, setDragOverIndex] = useState<number | null>(null)\n  const [previewUrls, setPreviewUrls] = useState<string[]>([])\n\n  useEffect(() => {\n    const urls = images.map((file) => URL.createObjectURL(file))\n    setPreviewUrls(urls)\n\n    return () => {\n      urls.forEach((url) => URL.revokeObjectURL(url))\n    }\n  }, [images])\n\n  const onDrop = useCallback(\n    (acceptedFiles: File[]) => {\n      const newImages = [...images, ...acceptedFiles].slice(0, maxImages)\n      onImagesChange(newImages)\n\n      setUploadProgress(0)\n      const interval = setInterval(() => {\n        setUploadProgress((prev) => {\n          if (prev >= 100) {\n            clearInterval(interval)\n            return 100\n          }\n          return prev + 10\n        })\n      }, 100)\n    },\n    [images, onImagesChange, maxImages],\n  )\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: { \"image/*\": [\".png\", \".jpg\", \".jpeg\", \".webp\"] },\n    maxFiles: maxImages - images.length,\n  })\n\n  const removeImage = (index: number) => {\n    onImagesChange(images.filter((_, i) => i !== index))\n  }\n\n  const handleDragStart = (e: React.DragEvent, index: number) => {\n    setDraggedIndex(index)\n    e.dataTransfer.effectAllowed = \"move\"\n  }\n\n  const handleDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault()\n    setDragOverIndex(index)\n  }\n\n  const handleDragEnd = () => {\n    if (draggedIndex !== null && dragOverIndex !== null && draggedIndex !== dragOverIndex) {\n      const newImages = [...images]\n      const [removed] = newImages.splice(draggedIndex, 1)\n      newImages.splice(dragOverIndex, 0, removed)\n      onImagesChange(newImages)\n    }\n    setDraggedIndex(null)\n    setDragOverIndex(null)\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\n          isDragActive ? \"border-primary bg-primary/5\" : \"border-border hover:border-primary/50\",\n        )}\n      >\n        <input {...getInputProps()} />\n        <Upload className=\"h-10 w-10 mx-auto text-muted-foreground mb-3\" />\n        <p className=\"text-sm text-muted-foreground\">{isDragActive ? \"将图片放在这里...\" : \"拖放图片，或点击选择\"}</p>\n        <p className=\"text-xs text-muted-foreground mt-1\">\n          {images.length} / {maxImages} 张图片\n        </p>\n      </div>\n\n      {uploadProgress > 0 && uploadProgress < 100 && (\n        <div className=\"space-y-2\">\n          <Progress value={uploadProgress} />\n          <p className=\"text-xs text-muted-foreground text-center\">上传中... {uploadProgress}%</p>\n        </div>\n      )}\n\n      {images.length > 0 && (\n        <div className=\"space-y-2\">\n          <p className=\"text-xs text-muted-foreground\">拖动图片可调整顺序</p>\n          <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3 max-h-80 overflow-y-auto p-2 bg-muted rounded-lg\">\n            {images.map((file, index) => (\n              <div\n                key={index}\n                draggable\n                onDragStart={(e) => handleDragStart(e, index)}\n                onDragOver={(e) => handleDragOver(e, index)}\n                onDragEnd={handleDragEnd}\n                className={cn(\n                  \"relative group aspect-[3/4] cursor-move transition-all rounded-lg overflow-hidden border-2 border-transparent\",\n                  draggedIndex === index && \"opacity-50 scale-95\",\n                  dragOverIndex === index && draggedIndex !== index && \"border-primary\",\n                )}\n              >\n                <img\n                  src={previewUrls[index] || \"/placeholder.svg\"}\n                  alt={`第 ${index + 1} 页`}\n                  className=\"w-full h-full object-cover\"\n                />\n                {/* 拖动手柄 */}\n                <div className=\"absolute top-1 left-1 bg-black/50 rounded p-0.5 opacity-0 group-hover:opacity-100 transition-opacity\">\n                  <GripVertical className=\"h-4 w-4 text-white\" />\n                </div>\n                {/* 删除按钮 */}\n                <Button\n                  variant=\"destructive\"\n                  size=\"icon\"\n                  className=\"absolute top-1 right-1 h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity\"\n                  onClick={() => removeImage(index)}\n                >\n                  <X className=\"h-3 w-3\" />\n                </Button>\n                {/* 页码标签 */}\n                <span className=\"absolute bottom-0 left-0 right-0 text-xs text-center bg-primary/90 text-primary-foreground font-medium py-1\">\n                  第 {index + 1} 页\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1685, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/dialog.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\nimport { XIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\n          className,\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn('text-lg leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,4TAAC,iYAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,4TAAC,oYAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,4TAAC,mYAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,4TAAC,kYAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,4TAAC,oYAAuB;QACtB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,4TAAC;QAAa,aAAU;;0BACtB,4TAAC;;;;;0BACD,4TAAC,oYAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,qHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,4TAAC,kYAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,4TAAC,gSAAK;;;;;0CACN,4TAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;MAhCS;AAkCT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,4TAAC,kYAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,4TAAC,wYAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 1891, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/comic-files-manager.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\nimport { GripVertical, Save, X } from \"lucide-react\"\nimport { getComicFiles, updateComicFilesOrder, getComicFileUrl, type ComicFilesData } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\nimport { cn } from \"@/lib/utils\"\n\ninterface ComicFilesManagerProps {\n  resourceId: string\n  open: boolean\n  onClose: () => void\n}\n\nexport function ComicFilesManager({ resourceId, open, onClose }: ComicFilesManagerProps) {\n  const [data, setData] = useState<ComicFilesData | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [saving, setSaving] = useState(false)\n  const [files, setFiles] = useState<Array<{ id: number; fileId: string; order: number }>>([])\n  const [draggedIndex, setDraggedIndex] = useState<number | null>(null)\n  const [dragOverIndex, setDragOverIndex] = useState<number | null>(null)\n  const [imageUrls, setImageUrls] = useState<Record<string, string>>({})\n  const { toast } = useToast()\n\n  useEffect(() => {\n    if (open && resourceId) {\n      loadFiles()\n    }\n  }, [open, resourceId])\n\n  useEffect(() => {\n    if (open && files.length > 0) {\n      // 加载所有图片 URL\n      const loadUrls = async () => {\n        const urls: Record<string, string> = {}\n        for (const file of files) {\n          try {\n            const url = await getComicFileUrl(file.fileId)\n            urls[file.id] = url\n          } catch (error) {\n            console.error(`Failed to load image for file ${file.id}:`, error)\n          }\n        }\n        setImageUrls(urls)\n      }\n      loadUrls()\n    }\n  }, [open, files])\n\n  const loadFiles = async () => {\n    try {\n      setLoading(true)\n      const result = await getComicFiles(resourceId)\n      setData(result)\n      setFiles([...result.files].sort((a, b) => a.order - b.order))\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"加载失败\"\n      toast({\n        title: \"加载失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleDragStart = (e: React.DragEvent, index: number) => {\n    setDraggedIndex(index)\n    e.dataTransfer.effectAllowed = \"move\"\n  }\n\n  const handleDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault()\n    setDragOverIndex(index)\n  }\n\n  const handleDragEnd = () => {\n    if (draggedIndex !== null && dragOverIndex !== null && draggedIndex !== dragOverIndex) {\n      const newFiles = [...files]\n      const [removed] = newFiles.splice(draggedIndex, 1)\n      newFiles.splice(dragOverIndex, 0, removed)\n      // 更新顺序\n      const updatedFiles = newFiles.map((file, idx) => ({\n        ...file,\n        order: idx + 1,\n      }))\n      setFiles(updatedFiles)\n    }\n    setDraggedIndex(null)\n    setDragOverIndex(null)\n  }\n\n  const handleSave = async () => {\n    try {\n      setSaving(true)\n      const fileOrders = files.map((file) => ({\n        id: file.id,\n        order: file.order,\n      }))\n      await updateComicFilesOrder(resourceId, fileOrders)\n      toast({\n        title: \"保存成功\",\n        description: \"图片顺序已更新\",\n      })\n      await loadFiles() // 重新加载以确认\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"保存失败\"\n      toast({\n        title: \"保存失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"!max-w-[100vw] !w-[100vw] !max-h-[100vh] !h-[100vh] overflow-hidden flex flex-col p-4 !m-0 !rounded-none\">\n        <DialogHeader className=\"flex-shrink-0 pb-3\">\n          <DialogTitle className=\"text-2xl font-bold\">管理图片顺序 - {data?.title}</DialogTitle>\n          <DialogDescription className=\"text-base\">\n            拖动图片可调整顺序，调整后点击保存按钮\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"flex-1 overflow-y-auto\">\n          {loading ? (\n            <div className=\"py-8 text-center text-muted-foreground\">加载中...</div>\n          ) : files.length === 0 ? (\n            <div className=\"py-8 text-center text-muted-foreground\">暂无图片</div>\n          ) : (\n            <div className=\"space-y-4 py-4\">\n              <p className=\"text-base font-medium\">\n                共 {files.length} 张图片，当前按顺序排列\n              </p>\n              <div className=\"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 2xl:grid-cols-12 gap-4\">\n                {files.map((file, index) => (\n                  <div\n                    key={file.id}\n                    draggable\n                    onDragStart={(e) => handleDragStart(e, index)}\n                    onDragOver={(e) => handleDragOver(e, index)}\n                    onDragEnd={handleDragEnd}\n                  className={cn(\n                    \"relative group aspect-[3/4] border-3 rounded-xl overflow-hidden cursor-move transition-all shadow-lg hover:shadow-xl\",\n                    draggedIndex === index && \"opacity-50 scale-95\",\n                    dragOverIndex === index && draggedIndex !== index && \"border-primary ring-4 ring-primary ring-opacity-50\",\n                  )}\n                >\n                  <div className=\"absolute top-2 left-2 z-10 bg-black/70 rounded-md p-1.5 opacity-0 group-hover:opacity-100 transition-opacity\">\n                    <GripVertical className=\"h-5 w-5 text-white\" />\n                  </div>\n                  <div className=\"w-full h-full bg-muted flex items-center justify-center\">\n                    {imageUrls[file.id] ? (\n                      <img\n                        src={imageUrls[file.id]}\n                        alt={`第 ${file.order} 张`}\n                        className=\"w-full h-full object-cover\"\n                        loading=\"lazy\"\n                      />\n                    ) : (\n                      <div className=\"text-sm text-muted-foreground text-center p-4\">加载中...</div>\n                    )}\n                  </div>\n                  <div className=\"absolute bottom-0 left-0 right-0 bg-black/80 text-white text-sm font-semibold text-center py-2\">\n                    第 {file.order} 张\n                  </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        <DialogFooter className=\"flex-shrink-0 border-t pt-4 mt-4\">\n          <Button variant=\"outline\" onClick={onClose}>\n            取消\n          </Button>\n          <Button onClick={handleSave} disabled={saving || loading}>\n            {saving ? \"保存中...\" : \"保存顺序\"}\n            <Save className=\"h-4 w-4 ml-2\" />\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2236, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/comic-upload-wizard.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Switch } from \"@/components/ui/switch\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { UploadDropzone } from \"./upload-dropzone\"\nimport { Heart, ChevronRight, ChevronLeft, Check, Link2, Copy, Archive, Upload, X, GripVertical, Save, List } from \"lucide-react\"\nimport { uploadComic, uploadComicArchive, batchUploadComicArchives, updateResource } from \"@/lib/api\"\nimport { ComicFilesManager } from \"./comic-files-manager\"\nimport { useToast } from \"@/components/ui/use-toast\"\nimport JSZip from \"jszip\"\n\ntype Step = 1 | 2 | 3\ntype UploadMode = \"images\" | \"archive\" | \"batch-archive\"\n\nexport function ComicUploadWizard({ className = \"\" }: { className?: string } = {}) {\n  const [step, setStep] = useState<Step>(1)\n  const [uploadMode, setUploadMode] = useState<UploadMode>(\"images\")\n  const [title, setTitle] = useState(\"\")\n  const [isVip, setIsVip] = useState(false)\n  const [images, setImages] = useState<File[]>([])\n  const [archive, setArchive] = useState<File | null>(null)\n  const [archives, setArchives] = useState<File[]>([])\n  const [archiveImages, setArchiveImages] = useState<Array<{ name: string; url: string; file: File }>>([])\n  const [archiveImagesLoading, setArchiveImagesLoading] = useState(false)\n  const [draggedImageIndex, setDraggedImageIndex] = useState<number | null>(null)\n  const [dragOverImageIndex, setDragOverImageIndex] = useState<number | null>(null)\n  const [uploadedPages, setUploadedPages] = useState<number>(0)\n  const [deepLink, setDeepLink] = useState(\"\")\n  const [previewLink, setPreviewLink] = useState(\"\")\n  const [uploadResults, setUploadResults] = useState<Array<{ id: string; title: string; originalFileName: string; order: number; pages: number; deepLink: string; previewLink: string }>>([])\n  const [editingTitles, setEditingTitles] = useState<Record<string, string>>({})\n  const [isUploading, setIsUploading] = useState(false)\n  const [comicFilesManagerOpen, setComicFilesManagerOpen] = useState(false)\n  const [selectedComicId, setSelectedComicId] = useState<string>(\"\")\n  const { toast } = useToast()\n\n  const canProceedStep1 = uploadMode === \"batch-archive\" ? archives.length > 0 : title.trim().length > 0\n  const canProceedStep2 = \n    uploadMode === \"images\" ? images.length > 0 : \n    uploadMode === \"archive\" ? archive !== null : \n    archives.length > 0\n\n  const handleFinish = async () => {\n    if (!canProceedStep1 || !canProceedStep2 || isUploading) return\n    try {\n      setIsUploading(true)\n      if (uploadMode === \"batch-archive\" && archives.length > 0) {\n        const results = await batchUploadComicArchives({\n          archives,\n          isVip,\n          previewCount: 5,\n        })\n        const resultsWithTitles = results.map((r, idx) => ({\n          id: r.id,\n          title: archives[idx]?.name.replace(/\\.(zip|rar)$/i, \"\") || `漫画 ${idx + 1}`,\n          originalFileName: archives[idx]?.name || `漫画 ${idx + 1}`,\n          order: idx + 1,\n          pages: r.pages,\n          deepLink: r.deepLink,\n          previewLink: r.previewLink,\n        }))\n        setUploadResults(resultsWithTitles)\n        // 初始化编辑状态\n        const initialTitles: Record<string, string> = {}\n        resultsWithTitles.forEach(r => {\n          initialTitles[r.id] = r.title\n        })\n        setEditingTitles(initialTitles)\n        setStep(3)\n        toast({\n          title: \"批量上传成功\",\n          description: `成功上传 ${results.length} 个压缩包`,\n        })\n      } else {\n        let result\n        if (uploadMode === \"archive\" && archive) {\n          result = await uploadComicArchive({\n            title: title.trim(),\n            isVip,\n            archive,\n            previewCount: 5,\n          })\n        } else {\n          result = await uploadComic({\n            title: title.trim(),\n            isVip,\n            files: images,\n          })\n        }\n        setDeepLink(result.deepLink)\n        setPreviewLink(result.previewLink)\n        setUploadedPages(result.pages)\n    setStep(3)\n        toast({\n          title: \"上传成功\",\n          description: `共 ${result.pages} 张图片，链接已就绪`,\n        })\n      }\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"上传失败\"\n      toast({\n        title: \"上传失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setIsUploading(false)\n    }\n  }\n\n  const copyLink = () => {\n    navigator.clipboard.writeText(deepLink)\n  }\n\n  const extractImagesFromZip = async (file: File): Promise<Array<{ name: string; url: string; file: File }>> => {\n    try {\n      const zip = await JSZip.loadAsync(file)\n      const imageFiles: Array<{ name: string; url: string; file: File }> = []\n      const imageExtensions = ['.jpg', '.jpeg', '.png', '.webp', '.gif', '.bmp']\n      \n      for (const [filename, zipEntry] of Object.entries(zip.files)) {\n        if (zipEntry.dir) continue\n        const ext = filename.toLowerCase().substring(filename.lastIndexOf('.'))\n        if (imageExtensions.includes(ext)) {\n          const blob = await zipEntry.async('blob')\n          const file = new File([blob], filename, { type: `image/${ext.slice(1)}` })\n          const url = URL.createObjectURL(blob)\n          imageFiles.push({ name: filename, url, file })\n        }\n      }\n      \n      // 按文件名排序\n      imageFiles.sort((a, b) => a.name.localeCompare(b.name))\n      return imageFiles\n    } catch (error) {\n      console.error('解压失败:', error)\n      throw new Error('无法解压压缩包，请确保是有效的 zip 文件')\n    }\n  }\n\n  const handleArchiveSelect = async (file: File) => {\n    if (file.name.toLowerCase().endsWith('.zip')) {\n      try {\n        setArchiveImagesLoading(true)\n        const images = await extractImagesFromZip(file)\n        setArchiveImages(images)\n        setArchive(file)\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"解压失败\"\n        toast({\n          title: \"解压失败\",\n          description: message,\n          variant: \"destructive\",\n        })\n      } finally {\n        setArchiveImagesLoading(false)\n      }\n    } else {\n      // RAR 文件无法在前端解压，只设置文件\n      setArchive(file)\n      setArchiveImages([])\n    }\n  }\n\n  const handleImageDragStart = (e: React.DragEvent, index: number) => {\n    setDraggedImageIndex(index)\n    e.dataTransfer.effectAllowed = \"move\"\n  }\n\n  const handleImageDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault()\n    setDragOverImageIndex(index)\n  }\n\n  const handleImageDragEnd = () => {\n    if (draggedImageIndex !== null && dragOverImageIndex !== null && draggedImageIndex !== dragOverImageIndex) {\n      const newImages = [...archiveImages]\n      const [removed] = newImages.splice(draggedImageIndex, 1)\n      newImages.splice(dragOverImageIndex, 0, removed)\n      setArchiveImages(newImages)\n    }\n    setDraggedImageIndex(null)\n    setDragOverImageIndex(null)\n  }\n\n  const resetWizard = () => {\n    setStep(1)\n    setUploadMode(\"images\")\n    setTitle(\"\")\n    setIsVip(false)\n    setImages([])\n    setArchive(null)\n    setArchives([])\n    setArchiveImages([])\n    setUploadedPages(0)\n    setDeepLink(\"\")\n    setPreviewLink(\"\")\n    setUploadResults([])\n    // 清理 URL\n    archiveImages.forEach(img => URL.revokeObjectURL(img.url))\n  }\n\n  return (\n    <Card className={className}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n          <Heart className=\"h-5 w-5 text-chart-5\" />\n          上传漫画\n        </CardTitle>\n        <div className=\"flex items-center gap-2 mt-4\">\n          {[1, 2, 3].map((s) => (\n            <div key={s} className=\"flex items-center\">\n              <div\n                className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${step >= s ? \"bg-primary text-primary-foreground\" : \"bg-muted text-muted-foreground\"}`}\n              >\n                {step > s ? <Check className=\"h-4 w-4\" /> : s}\n              </div>\n              {s < 3 && <div className={`w-12 h-0.5 mx-1 ${step > s ? \"bg-primary\" : \"bg-muted\"}`}></div>}\n            </div>\n          ))}\n        </div>\n      </CardHeader>\n      <CardContent>\n        {step === 1 && (\n          <div className=\"space-y-5\">\n            {uploadMode !== \"batch-archive\" && (\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"comic-title\">漫画标题</Label>\n              <Input\n                id=\"comic-title\"\n                placeholder=\"输入漫画标题...\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n              />\n            </div>\n            )}\n\n            <div className=\"space-y-2\">\n              <Label>上传方式</Label>\n              <div className=\"grid grid-cols-3 gap-2\">\n                <Button\n                  type=\"button\"\n                  variant={uploadMode === \"images\" ? \"default\" : \"outline\"}\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setUploadMode(\"images\")\n                    setArchive(null)\n                    setArchives([])\n                  }}\n                >\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  上传图片\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant={uploadMode === \"archive\" ? \"default\" : \"outline\"}\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setUploadMode(\"archive\")\n                    setImages([])\n                    setArchives([])\n                  }}\n                >\n                  <Archive className=\"h-4 w-4 mr-2\" />\n                  单个压缩包\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant={uploadMode === \"batch-archive\" ? \"default\" : \"outline\"}\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setUploadMode(\"batch-archive\")\n                    setImages([])\n                    setArchive(null)\n                  }}\n                >\n                  <Archive className=\"h-4 w-4 mr-2\" />\n                  批量压缩包\n                </Button>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                {uploadMode === \"archive\"\n                  ? \"支持 zip/rar 格式，将自动解压并发送到存储频道和预览频道\"\n                  : uploadMode === \"batch-archive\"\n                  ? \"批量上传多个压缩包，每个压缩包将自动创建独立的漫画资源，默认使用压缩包名称作为标题\"\n                  : \"逐个上传图片文件\"}\n              </p>\n            </div>\n\n            {uploadMode === \"batch-archive\" && (\n              <div className=\"space-y-4\">\n                <Label>批量上传压缩包 (zip/rar)</Label>\n                <div\n                  className=\"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors hover:border-primary/50\"\n                  onClick={() => {\n                    const input = document.createElement(\"input\")\n                    input.type = \"file\"\n                    input.accept = \".zip,.rar\"\n                    input.multiple = true\n                    input.onchange = (e) => {\n                      const files = Array.from((e.target as HTMLInputElement).files || [])\n                      if (files.length > 0) {\n                        setArchives([...archives, ...files])\n                      }\n                    }\n                    input.click()\n                  }}\n                >\n                  <Archive className=\"h-10 w-10 mx-auto text-muted-foreground mb-3\" />\n                  <p className=\"text-sm text-muted-foreground\">\n                    点击选择多个压缩包文件\n                  </p>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    支持 zip 和 rar 格式，每个压缩包将自动创建独立的漫画资源\n                  </p>\n                </div>\n                {archives.length > 0 && (\n                  <div className=\"space-y-2\">\n                    <p className=\"text-sm font-medium\">已选择 {archives.length} 个压缩包：</p>\n                    <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n                      {archives.map((file, idx) => (\n                        <div key={idx} className=\"p-3 bg-muted rounded-lg flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2\">\n                            <Archive className=\"h-4 w-4\" />\n                            <span className=\"text-sm\">{file.name}</span>\n                            <span className=\"text-xs text-muted-foreground\">\n                              ({(file.size / 1024 / 1024).toFixed(2)} MB)\n                            </span>\n                          </div>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => setArchives(archives.filter((_, i) => i !== idx))}\n                          >\n                            <X className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n              <div className=\"space-y-0.5\">\n                <Label htmlFor=\"comic-vip\" className=\"cursor-pointer\">\n                  仅限 VIP\n                </Label>\n                <p className=\"text-xs text-muted-foreground\">限制为 VIP 会员访问</p>\n              </div>\n              <Switch id=\"comic-vip\" checked={isVip} onCheckedChange={setIsVip} />\n            </div>\n\n            <Button\n              className=\"w-full\"\n              onClick={() => setStep(2)}\n              disabled={!canProceedStep1}\n            >\n              下一步：{uploadMode === \"batch-archive\" ? \"确认上传\" : uploadMode === \"archive\" ? \"上传压缩包\" : \"上传图片\"}\n              <ChevronRight className=\"h-4 w-4 ml-2\" />\n            </Button>\n          </div>\n        )}\n\n        {step === 2 && (\n          <div className=\"space-y-5\">\n            {uploadMode === \"images\" ? (\n            <UploadDropzone images={images} onImagesChange={setImages} maxImages={200} />\n            ) : uploadMode === \"batch-archive\" ? (\n              <div className=\"space-y-4\">\n                <div className=\"p-4 bg-muted rounded-lg\">\n                  <p className=\"text-sm font-medium mb-2\">准备上传 {archives.length} 个压缩包：</p>\n                  <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n                    {archives.map((file, idx) => (\n                      <div key={idx} className=\"p-2 bg-background rounded flex items-center gap-2\">\n                        <Archive className=\"h-4 w-4 shrink-0\" />\n                        <span className=\"text-sm flex-1\">{file.name}</span>\n                        <span className=\"text-xs text-muted-foreground shrink-0\">\n                          ({(file.size / 1024 / 1024).toFixed(2)} MB)\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-3\">\n                    每个压缩包将自动创建独立的漫画资源，默认使用压缩包名称（去掉扩展名）作为漫画标题\n                  </p>\n                </div>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <Label>上传压缩包 (zip/rar)</Label>\n                <div\n                  className=\"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors hover:border-primary/50\"\n                  onClick={() => {\n                    const input = document.createElement(\"input\")\n                    input.type = \"file\"\n                    input.accept = \".zip,.rar\"\n                    input.onchange = (e) => {\n                      const file = (e.target as HTMLInputElement).files?.[0]\n                      if (file) {\n                        handleArchiveSelect(file)\n                      }\n                    }\n                    input.click()\n                  }}\n                >\n                  <Archive className=\"h-10 w-10 mx-auto text-muted-foreground mb-3\" />\n                  <p className=\"text-sm text-muted-foreground\">\n                    {archive ? archive.name : \"点击选择压缩包文件\"}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    支持 zip 和 rar 格式，将自动解压并上传所有图片\n                  </p>\n                </div>\n                {archiveImagesLoading && (\n                  <div className=\"text-center py-4 text-muted-foreground\">正在解压并加载图片...</div>\n                )}\n                {archive && !archiveImagesLoading && (\n                  <>\n                    <div className=\"p-3 bg-muted rounded-lg flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Archive className=\"h-4 w-4\" />\n                        <span className=\"text-sm\">{archive.name}</span>\n                        <span className=\"text-xs text-muted-foreground\">\n                          ({(archive.size / 1024 / 1024).toFixed(2)} MB)\n                        </span>\n                        {archiveImages.length > 0 && (\n                          <span className=\"text-xs text-muted-foreground\">\n                            • {archiveImages.length} 张图片\n                          </span>\n                        )}\n                      </div>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => {\n                          archiveImages.forEach(img => URL.revokeObjectURL(img.url))\n                          setArchive(null)\n                          setArchiveImages([])\n                        }}\n                      >\n                        <X className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    {archiveImages.length > 0 && (\n                      <div className=\"space-y-4\">\n                        <p className=\"text-base font-medium\">图片预览（拖动可调整顺序）：</p>\n                        <div className=\"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 2xl:grid-cols-12 gap-4 max-h-96 overflow-y-auto p-2 bg-muted rounded-lg\">\n                          {archiveImages.map((img, idx) => (\n                            <div\n                              key={idx}\n                              draggable\n                              onDragStart={(e) => handleImageDragStart(e, idx)}\n                              onDragOver={(e) => handleImageDragOver(e, idx)}\n                              onDragEnd={handleImageDragEnd}\n                              className={cn(\n                                \"relative group aspect-[3/4] border-3 rounded-xl overflow-hidden cursor-move transition-all shadow-lg hover:shadow-xl\",\n                                draggedImageIndex === idx && \"opacity-50 scale-95\",\n                                dragOverImageIndex === idx && draggedImageIndex !== idx && \"border-primary ring-4 ring-primary ring-opacity-50\",\n                              )}\n                            >\n                              <div className=\"absolute top-2 left-2 z-10 bg-black/70 rounded-md p-1.5 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                <GripVertical className=\"h-5 w-5 text-white\" />\n                              </div>\n                              <img\n                                src={img.url}\n                                alt={img.name}\n                                className=\"w-full h-full object-cover\"\n                              />\n                              <div className=\"absolute bottom-0 left-0 right-0 bg-black/80 text-white text-sm font-semibold text-center py-2\">\n                                {idx + 1}\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </>\n                )}\n              </div>\n            )}\n\n            <div className=\"flex gap-3\">\n              <Button variant=\"outline\" onClick={() => setStep(1)} className=\"flex-1\">\n                <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                返回\n              </Button>\n              <Button onClick={handleFinish} disabled={!canProceedStep2 || isUploading} className=\"flex-1\">\n                {isUploading ? \"上传中...\" : \"完成上传\"}\n                <ChevronRight className=\"h-4 w-4 ml-2\" />\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {step === 3 && (\n          <div className=\"space-y-5 text-center\">\n            <div className=\"w-16 h-16 rounded-full bg-success/10 flex items-center justify-center mx-auto\">\n              <Check className=\"h-8 w-8 text-success\" />\n            </div>\n\n            {uploadMode === \"batch-archive\" ? (\n              <>\n                <div>\n                  <h3 className=\"font-semibold text-lg text-card-foreground\">批量上传成功</h3>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    成功上传 {uploadResults.length} 个压缩包\n                    {isVip && \" • 仅限 VIP\"}\n                  </p>\n                </div>\n\n                <div className=\"space-y-3 max-h-96 overflow-y-auto text-left\">\n                  {uploadResults.map((result) => (\n                    <div key={result.id} className=\"p-4 bg-muted rounded-lg space-y-3\">\n                      <div className=\"flex items-center justify-between gap-3\">\n                        <div className=\"flex-1 space-y-2\">\n                          <div className=\"flex items-center gap-2\">\n                            <Badge variant=\"outline\" className=\"shrink-0\">\n                              第 {result.order} 个\n                            </Badge>\n                            <Input\n                              value={editingTitles[result.id] ?? result.title}\n                              onChange={(e) => {\n                                setEditingTitles({\n                                  ...editingTitles,\n                                  [result.id]: e.target.value,\n                                })\n                              }}\n                              className=\"font-medium flex-1\"\n                              placeholder=\"漫画标题\"\n                            />\n                            <Button\n                              size=\"sm\"\n                              onClick={async () => {\n                                try {\n                                  const newTitle = editingTitles[result.id]?.trim()\n                                  if (!newTitle) {\n                                    toast({\n                                      title: \"标题不能为空\",\n                                      variant: \"destructive\",\n                                    })\n                                    return\n                                  }\n                                  await updateResource(result.id, { title: newTitle })\n                                  setUploadResults(uploadResults.map(r =>\n                                    r.id === result.id ? { ...r, title: newTitle } : r\n                                  ))\n                                  toast({\n                                    title: \"标题已更新\",\n                                  })\n                                } catch (error) {\n                                  const message = error instanceof Error ? error.message : \"更新失败\"\n                                  toast({\n                                    title: \"更新失败\",\n                                    description: message,\n                                    variant: \"destructive\",\n                                  })\n                                }\n                              }}\n                            >\n                              <Save className=\"h-3 w-3 mr-1\" />\n                              保存\n                            </Button>\n                          </div>\n                          <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                            <span>原文件名：{result.originalFileName}</span>\n                            <span>•</span>\n                            <span>{result.pages} 张图片</span>\n                          </div>\n                        </div>\n                        <Badge className=\"bg-success text-success-foreground shrink-0\">已上传</Badge>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <div className=\"flex gap-2\">\n                          <div className=\"flex-1 p-2 bg-background rounded text-xs\">\n                            <p className=\"text-muted-foreground mb-1\">深度链接</p>\n                            <p className=\"font-mono truncate\">{result.deepLink}</p>\n                          </div>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => {\n                              navigator.clipboard.writeText(result.deepLink)\n                              toast({ title: \"已复制深度链接\" })\n                            }}\n                          >\n                            <Copy className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <div className=\"flex-1 p-2 bg-background rounded text-xs\">\n                            <p className=\"text-muted-foreground mb-1\">预览频道链接</p>\n                            <p className=\"font-mono truncate\">{result.previewLink}</p>\n                          </div>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => {\n                              navigator.clipboard.writeText(result.previewLink)\n                              toast({ title: \"已复制预览链接\" })\n                            }}\n                          >\n                            <Copy className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      </div>\n                      <div className=\"flex justify-end\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setSelectedComicId(result.id)\n                            setComicFilesManagerOpen(true)\n                          }}\n                        >\n                          <List className=\"h-3 w-3 mr-1\" />\n                          管理图片顺序\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </>\n            ) : (\n              <>\n            <div>\n              <h3 className=\"font-semibold text-lg text-card-foreground\">{title}</h3>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                    已上传 {uploadedPages} 张图片\n                {isVip && \" • 仅限 VIP\"}\n              </p>\n            </div>\n\n            <div className=\"p-4 bg-muted rounded-lg space-y-2\">\n              <Label className=\"text-xs text-muted-foreground\">深度链接</Label>\n              <div className=\"flex gap-2\">\n                <Input value={deepLink} readOnly className=\"font-mono text-xs\" />\n                <Button variant=\"outline\" size=\"icon\" onClick={copyLink}>\n                  <Copy className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n\n                <div className=\"p-4 bg-muted rounded-lg space-y-2\">\n                  <Label className=\"text-xs text-muted-foreground\">当前跳转链接</Label>\n                  <Input value={previewLink} readOnly className=\"font-mono text-xs\" />\n            </div>\n\n            <Badge className=\"bg-success text-success-foreground\">\n              <Link2 className=\"h-3 w-3 mr-1\" />\n              已准备好分享\n            </Badge>\n              </>\n            )}\n\n            <Button variant=\"outline\" onClick={resetWizard} className=\"w-full bg-transparent\">\n              上传另一部漫画\n            </Button>\n          </div>\n        )}\n      </CardContent>\n      {selectedComicId && (\n        <ComicFilesManager\n          resourceId={selectedComicId}\n          open={comicFilesManagerOpen}\n          onClose={() => {\n            setComicFilesManagerOpen(false)\n            setSelectedComicId(\"\")\n          }}\n        />\n      )}\n    </Card>\n  )\n}\n\nfunction cn(...classes: (string | boolean | undefined)[]) {\n  return classes.filter(Boolean).join(\" \")\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3804, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/table.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Table({ className, ...props }: React.ComponentProps<'table'>) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn('w-full caption-bottom text-sm', className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<'thead'>) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn('[&_tr]:border-b', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<'tbody'>) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn('[&_tr:last-child]:border-0', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<'tfoot'>) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        'bg-muted/50 border-t font-medium [&>tr]:last:border-b-0',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<'tr'>) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        'hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<'th'>) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        'text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<'td'>) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        'p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<'caption'>) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn('text-muted-foreground mt-4 text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,4TAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,4TAAC;YACC,aAAU;YACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;KAbS;AAeT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,sJACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 3948, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/checkbox.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as CheckboxPrimitive from '@radix-ui/react-checkbox'\nimport { CheckIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Checkbox({\n  className,\n  ...props\n}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {\n  return (\n    <CheckboxPrimitive.Root\n      data-slot=\"checkbox\"\n      className={cn(\n        'peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <CheckboxPrimitive.Indicator\n        data-slot=\"checkbox-indicator\"\n        className=\"flex items-center justify-center text-current transition-none\"\n      >\n        <CheckIcon className=\"size-3.5\" />\n      </CheckboxPrimitive.Indicator>\n    </CheckboxPrimitive.Root>\n  )\n}\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACiD;IACpD,qBACE,4TAAC,gYAAsB;QACrB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,+eACA;QAED,GAAG,KAAK;kBAET,cAAA,4TAAC,qYAA2B;YAC1B,aAAU;YACV,WAAU;sBAEV,cAAA,4TAAC,4SAAS;gBAAC,WAAU;;;;;;;;;;;;;;;;AAI7B;KArBS"}},
    {"offset": {"line": 3998, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/pagination.tsx"],"sourcesContent":["import * as React from 'react'\nimport {\n  ChevronLeftIcon,\n  ChevronRightIcon,\n  MoreHorizontalIcon,\n} from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\nimport { Button, buttonVariants } from '@/components/ui/button'\n\nfunction Pagination({ className, ...props }: React.ComponentProps<'nav'>) {\n  return (\n    <nav\n      role=\"navigation\"\n      aria-label=\"pagination\"\n      data-slot=\"pagination\"\n      className={cn('mx-auto flex w-full justify-center', className)}\n      {...props}\n    />\n  )\n}\n\nfunction PaginationContent({\n  className,\n  ...props\n}: React.ComponentProps<'ul'>) {\n  return (\n    <ul\n      data-slot=\"pagination-content\"\n      className={cn('flex flex-row items-center gap-1', className)}\n      {...props}\n    />\n  )\n}\n\nfunction PaginationItem({ ...props }: React.ComponentProps<'li'>) {\n  return <li data-slot=\"pagination-item\" {...props} />\n}\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<React.ComponentProps<typeof Button>, 'size'> &\n  React.ComponentProps<'a'>\n\nfunction PaginationLink({\n  className,\n  isActive,\n  size = 'icon',\n  ...props\n}: PaginationLinkProps) {\n  return (\n    <a\n      aria-current={isActive ? 'page' : undefined}\n      data-slot=\"pagination-link\"\n      data-active={isActive}\n      className={cn(\n        buttonVariants({\n          variant: isActive ? 'outline' : 'ghost',\n          size,\n        }),\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction PaginationPrevious({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) {\n  return (\n    <PaginationLink\n      aria-label=\"Go to previous page\"\n      size=\"default\"\n      className={cn('gap-1 px-2.5 sm:pl-2.5', className)}\n      {...props}\n    >\n      <ChevronLeftIcon />\n      <span className=\"hidden sm:block\">Previous</span>\n    </PaginationLink>\n  )\n}\n\nfunction PaginationNext({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) {\n  return (\n    <PaginationLink\n      aria-label=\"Go to next page\"\n      size=\"default\"\n      className={cn('gap-1 px-2.5 sm:pr-2.5', className)}\n      {...props}\n    >\n      <span className=\"hidden sm:block\">Next</span>\n      <ChevronRightIcon />\n    </PaginationLink>\n  )\n}\n\nfunction PaginationEllipsis({\n  className,\n  ...props\n}: React.ComponentProps<'span'>) {\n  return (\n    <span\n      aria-hidden\n      data-slot=\"pagination-ellipsis\"\n      className={cn('flex size-9 items-center justify-center', className)}\n      {...props}\n    >\n      <MoreHorizontalIcon className=\"size-4\" />\n      <span className=\"sr-only\">More pages</span>\n    </span>\n  )\n}\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AACA;AAAA;AAAA;AAMA;AACA;;;;;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,MAAK;QACL,cAAW;QACX,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;KAVS;AAYT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACwB;IAC3B,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,oCAAoC;QACjD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,eAAe,EAAE,GAAG,OAAmC;IAC9D,qBAAO,4TAAC;QAAG,aAAU;QAAmB,GAAG,KAAK;;;;;;AAClD;MAFS;AAST,SAAS,eAAe,EACtB,SAAS,EACT,QAAQ,EACR,OAAO,MAAM,EACb,GAAG,OACiB;IACpB,qBACE,4TAAC;QACC,gBAAc,WAAW,SAAS;QAClC,aAAU;QACV,eAAa;QACb,WAAW,IAAA,qHAAE,EACX,IAAA,gJAAc,EAAC;YACb,SAAS,WAAW,YAAY;YAChC;QACF,IACA;QAED,GAAG,KAAK;;;;;;AAGf;MArBS;AAuBT,SAAS,mBAAmB,EAC1B,SAAS,EACT,GAAG,OACyC;IAC5C,qBACE,4TAAC;QACC,cAAW;QACX,MAAK;QACL,WAAW,IAAA,qHAAE,EAAC,0BAA0B;QACvC,GAAG,KAAK;;0BAET,4TAAC,kUAAe;;;;;0BAChB,4TAAC;gBAAK,WAAU;0BAAkB;;;;;;;;;;;;AAGxC;MAfS;AAiBT,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACyC;IAC5C,qBACE,4TAAC;QACC,cAAW;QACX,MAAK;QACL,WAAW,IAAA,qHAAE,EAAC,0BAA0B;QACvC,GAAG,KAAK;;0BAET,4TAAC;gBAAK,WAAU;0BAAkB;;;;;;0BAClC,4TAAC,qUAAgB;;;;;;;;;;;AAGvB;MAfS;AAiBT,SAAS,mBAAmB,EAC1B,SAAS,EACT,GAAG,OAC0B;IAC7B,qBACE,4TAAC;QACC,aAAW;QACX,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;0BAET,4TAAC,iUAAkB;gBAAC,WAAU;;;;;;0BAC9B,4TAAC;gBAAK,WAAU;0BAAU;;;;;;;;;;;;AAGhC;MAfS"}},
    {"offset": {"line": 4180, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/resource-list.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useEffect, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\nimport { Book, Headphones, Heart, Crown, Search, ExternalLink, Trash2, Save, Copy, List } from \"lucide-react\"\nimport {\n  Pagination,\n  PaginationContent,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n} from \"@/components/ui/pagination\"\nimport { deleteResource, fetchResources, type ResourceRecord, updateResource, batchDeleteResources } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\nimport { ComicFilesManager } from \"./comic-files-manager\"\n\ntype ResourceType = \"all\" | \"novel\" | \"audio\" | \"comic\"\n\nconst typeConfig = {\n  novel: { icon: Book, label: \"小说\", className: \"bg-primary/10 text-primary\" },\n  audio: { icon: Headphones, label: \"音频\", className: \"bg-chart-2/10 text-chart-2\" },\n  comic: { icon: Heart, label: \"漫画\", className: \"bg-chart-5/10 text-chart-5\" },\n}\n\nconst filterLabels: Record<ResourceType, string> = {\n  all: \"全部\",\n  novel: \"小说\",\n  audio: \"音频\",\n  comic: \"漫画\",\n}\n\nexport function ResourceList() {\n  const [filter, setFilter] = useState<ResourceType>(\"all\")\n  const [search, setSearch] = useState(\"\")\n  const [resources, setResources] = useState<ResourceRecord[]>([])\n  const [loading, setLoading] = useState(false)\n  const [page, setPage] = useState(1)\n  const [totalCount, setTotalCount] = useState(0)\n  const pageSize = 50\n  const [editMap, setEditMap] = useState<\n    Record<\n      string,\n      {\n        title: string\n        link: string\n        dirty: boolean\n        saving: boolean\n      }\n    >\n  >({})\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set())\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false)\n  const [batchDeleteDialogOpen, setBatchDeleteDialogOpen] = useState(false)\n  const [deletingId, setDeletingId] = useState<string | null>(null)\n  const [comicFilesManagerOpen, setComicFilesManagerOpen] = useState(false)\n  const [selectedComicId, setSelectedComicId] = useState<string | null>(null)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let ignore = false\n    const load = async () => {\n      try {\n        setLoading(true)\n        const skip = (page - 1) * pageSize\n        const data = await fetchResources(filter, skip, pageSize)\n        if (!ignore) {\n          setResources(data)\n          const nextMap: typeof editMap = {}\n          data.forEach((item) => {\n            nextMap[item.id] = {\n              title: item.title,\n              link: item.link,\n              dirty: false,\n              saving: false,\n            }\n          })\n          setEditMap(nextMap)\n        }\n        // 获取总数\n        const countResponse = await fetch(`/api/resources/count?${filter !== \"all\" ? `resource_type=${filter}` : \"\"}`)\n        if (countResponse.ok) {\n          const countData = await countResponse.json()\n          if (!ignore) {\n            setTotalCount(countData.count || 0)\n          }\n        }\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"加载失败\"\n        toast({\n          title: \"读取资源失败\",\n          description: message,\n          variant: \"destructive\",\n        })\n      } finally {\n        if (!ignore) {\n          setLoading(false)\n        }\n      }\n    }\n    load()\n    return () => {\n      ignore = true\n    }\n  }, [filter, page, toast])\n\n  // 注意：搜索现在在客户端进行，但也可以改为服务端搜索\n  // 由于使用了服务端分页，这里不需要客户端过滤\n  const filteredResources = resources\n  \n  // 当筛选或搜索改变时，重置到第一页\n  useEffect(() => {\n    setPage(1)\n  }, [filter, search])\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIds(new Set(filteredResources.map((r) => r.id)))\n    } else {\n      setSelectedIds(new Set())\n    }\n  }\n\n  const handleSelectOne = (id: string, checked: boolean) => {\n    const next = new Set(selectedIds)\n    if (checked) {\n      next.add(id)\n    } else {\n      next.delete(id)\n    }\n    setSelectedIds(next)\n  }\n\n  const removeResource = async (id: string) => {\n    try {\n      await deleteResource(id)\n      setResources((prev) => prev.filter((item) => item.id !== id))\n      setEditMap((prev) => {\n        const clone = { ...prev }\n        delete clone[id]\n        return clone\n      })\n      toast({ title: \"已删除资源\" })\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"删除失败\"\n      toast({\n        title: \"删除失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleBatchDelete = async () => {\n    if (selectedIds.size === 0) return\n    try {\n      await batchDeleteResources(Array.from(selectedIds))\n      toast({ title: `已删除 ${selectedIds.size} 个资源` })\n      setBatchDeleteDialogOpen(false)\n      setResources((prev) => prev.filter((item) => !selectedIds.has(item.id)))\n      setEditMap((prev) => {\n        const clone = { ...prev }\n        selectedIds.forEach((id) => delete clone[id])\n        return clone\n      })\n      setSelectedIds(new Set())\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"批量删除失败\"\n      toast({\n        title: \"批量删除失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleCopyDeepLink = async (resource: ResourceRecord) => {\n    const link = resource.deepLink ?? resource.link\n    if (!link) {\n      toast({ title: \"没有可复制的链接\", variant: \"destructive\" })\n      return\n    }\n    try {\n      await navigator.clipboard.writeText(link)\n      toast({ title: \"深度链接已复制\" })\n    } catch (error) {\n      toast({\n        title: \"复制失败\",\n        description: error instanceof Error ? error.message : \"浏览器未授权\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleFieldChange = (id: string, field: \"title\" | \"link\", value: string) => {\n    setEditMap((prev) => {\n      const current = prev[id] ?? {\n        title: \"\",\n        link: \"\",\n        dirty: false,\n        saving: false,\n      }\n      return {\n        ...prev,\n        [id]: {\n          ...current,\n          [field]: value,\n          dirty: true,\n        },\n      }\n    })\n  }\n\n  const handleRowSave = async (resource: ResourceRecord) => {\n    const entry = editMap[resource.id]\n    if (!entry || entry.saving || !entry.dirty) {\n      return\n    }\n    if (!entry.title.trim() || !entry.link.trim()) {\n      toast({ title: \"请填写完整信息\", variant: \"destructive\" })\n      return\n    }\n    try {\n      setEditMap((prev) => ({\n        ...prev,\n        [resource.id]: { ...entry, saving: true },\n      }))\n      const payload: { title?: string; jump_url?: string; preview_url?: string } = {\n        title: entry.title.trim(),\n      }\n      if (resource.type === \"comic\") {\n        payload.preview_url = entry.link.trim()\n      } else {\n        payload.jump_url = entry.link.trim()\n      }\n      const updated = await updateResource(resource.id, payload)\n      setResources((prev) =>\n        prev.map((item) => (item.id === updated.id ? updated : item)),\n      )\n      setEditMap((prev) => ({\n        ...prev,\n        [resource.id]: {\n          title: updated.title,\n          link: updated.link,\n          dirty: false,\n          saving: false,\n        },\n      }))\n      toast({ title: \"已更新资源\" })\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"更新失败\"\n      toast({\n        title: \"更新失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n      setEditMap((prev) => ({\n        ...prev,\n        [resource.id]: { ...entry, saving: false },\n      }))\n    }\n  }\n\n  return (\n    <>\n      <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"text-card-foreground\">资源列表</CardTitle>\n        <div className=\"flex flex-col sm:flex-row gap-3 mt-4\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"搜索资源...\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              className=\"pl-9\"\n            />\n          </div>\n          <div className=\"flex gap-2\">\n            {([\"all\", \"novel\", \"audio\", \"comic\"] as const).map((type) => (\n              <Button\n                key={type}\n                variant={filter === type ? \"default\" : \"outline\"}\n                size=\"sm\"\n                onClick={() => setFilter(type)}\n              >\n                {filterLabels[type]}\n              </Button>\n            ))}\n            {selectedIds.size > 0 && (\n              <Button\n                variant=\"destructive\"\n                size=\"sm\"\n                onClick={() => setBatchDeleteDialogOpen(true)}\n              >\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                批量删除 ({selectedIds.size})\n              </Button>\n            )}\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <p className=\"text-sm text-muted-foreground px-1\">\n          小说和音频默认免费；可在此直接修改标题与链接，并保存到数据库。\n        </p>\n        <div className=\"rounded-lg border border-border overflow-hidden px-1\">\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-muted/50\">\n                <TableHead className=\"w-12\">\n                  <Checkbox\n                    checked={selectedIds.size === filteredResources.length && filteredResources.length > 0}\n                    onCheckedChange={handleSelectAll}\n                  />\n                </TableHead>\n                <TableHead className=\"w-1/4\">标题</TableHead>\n                <TableHead className=\"w-1/4\">Telegram 链接</TableHead>\n                <TableHead>类型</TableHead>\n                <TableHead>状态</TableHead>\n                <TableHead>创建日期</TableHead>\n                <TableHead className=\"w-64 text-right\">操作</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredResources.map((resource) => {\n                const config = typeConfig[resource.type]\n                const Icon = config.icon\n                const entry = editMap[resource.id]\n                return (\n                  <TableRow key={resource.id}>\n                    <TableCell>\n                      <Checkbox\n                        checked={selectedIds.has(resource.id)}\n                        onCheckedChange={(checked) =>\n                          handleSelectOne(resource.id, checked as boolean)\n                        }\n                      />\n                    </TableCell>\n                    <TableCell className=\"font-medium\">\n                      <Input\n                        value={entry?.title ?? resource.title}\n                        onChange={(e) => handleFieldChange(resource.id, \"title\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Input\n                        value={entry?.link ?? resource.link}\n                        onChange={(e) => handleFieldChange(resource.id, \"link\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"secondary\" className={config.className}>\n                        <Icon className=\"h-3 w-3 mr-1\" />\n                        {config.label}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge className={resource.isVip ? \"bg-warning text-warning-foreground\" : \"bg-muted text-muted-foreground\"}>\n                        {resource.isVip ? (\n                          <>\n                          <Crown className=\"h-3 w-3 mr-1\" />\n                            会员\n                          </>\n                        ) : (\n                          \"非会员\"\n                        )}\n                        </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-muted-foreground text-sm\">{resource.createdAt}</TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex flex-wrap justify-end gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => window.open(resource.link, \"_blank\")}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                        </Button>\n                        <Button variant=\"secondary\" size=\"icon\" onClick={() => handleCopyDeepLink(resource)}>\n                          <Copy className=\"h-4 w-4\" />\n                        </Button>\n                        {resource.type === \"comic\" && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            onClick={() => {\n                              setSelectedComicId(resource.id)\n                              setComicFilesManagerOpen(true)\n                            }}\n                            title=\"管理图片顺序\"\n                          >\n                            <List className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                        <Button\n                          size=\"icon\"\n                          onClick={() => handleRowSave(resource)}\n                          disabled={!entry?.dirty || entry?.saving}\n                        >\n                          <Save className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => {\n                            setDeletingId(resource.id)\n                            setDeleteDialogOpen(true)\n                          }}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                )\n              })}\n              {loading && (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center py-8 text-muted-foreground\">\n                    正在加载数据...\n                  </TableCell>\n                </TableRow>\n              )}\n              {!loading && filteredResources.length === 0 && (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center py-8 text-muted-foreground\">\n                    未找到资源\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </div>\n        {totalCount > 0 && totalCount > pageSize && (\n          <div className=\"mt-4 flex justify-center\">\n            <Pagination>\n              <PaginationContent>\n                <PaginationItem>\n                  <PaginationPrevious\n                    href=\"#\"\n                    onClick={(e) => {\n                      e.preventDefault()\n                      if (page > 1) setPage(page - 1)\n                    }}\n                    className={page === 1 ? \"pointer-events-none opacity-50\" : \"\"}\n                  />\n                </PaginationItem>\n                {Array.from({ length: Math.ceil(totalCount / pageSize) }, (_, i) => i + 1)\n                  .filter((p) => {\n                    // 只显示当前页附近的页码\n                    return p === 1 || p === Math.ceil(totalCount / pageSize) || Math.abs(p - page) <= 2\n                  })\n                  .map((p, idx, arr) => {\n                    // 如果当前页码和下一个页码之间有间隔，显示省略号\n                    const prev = arr[idx - 1]\n                    const showEllipsis = prev && p - prev > 1\n                    return (\n                      <React.Fragment key={p}>\n                        {showEllipsis && (\n                          <PaginationItem>\n                            <span className=\"px-2\">...</span>\n                          </PaginationItem>\n                        )}\n                        <PaginationItem>\n                          <PaginationLink\n                            href=\"#\"\n                            onClick={(e) => {\n                              e.preventDefault()\n                              setPage(p)\n                            }}\n                            isActive={p === page}\n                          >\n                            {p}\n                          </PaginationLink>\n                        </PaginationItem>\n                      </React.Fragment>\n                    )\n                  })}\n                <PaginationItem>\n                  <PaginationNext\n                    href=\"#\"\n                    onClick={(e) => {\n                      e.preventDefault()\n                      if (page < Math.ceil(totalCount / pageSize)) setPage(page + 1)\n                    }}\n                    className={page >= Math.ceil(totalCount / pageSize) ? \"pointer-events-none opacity-50\" : \"\"}\n                  />\n                </PaginationItem>\n              </PaginationContent>\n            </Pagination>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n\n      <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>确认删除</DialogTitle>\n            <DialogDescription>\n              确定要删除这个资源吗？此操作不可恢复。\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => {\n              setDeleteDialogOpen(false)\n              setDeletingId(null)\n            }}>\n              取消\n            </Button>\n            <Button\n              variant=\"destructive\"\n              onClick={() => {\n                if (deletingId) {\n                  removeResource(deletingId)\n                  setDeleteDialogOpen(false)\n                  setDeletingId(null)\n                }\n              }}\n            >\n              删除\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={batchDeleteDialogOpen} onOpenChange={setBatchDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>确认批量删除</DialogTitle>\n            <DialogDescription>\n              确定要删除选中的 {selectedIds.size} 个资源吗？此操作不可恢复。\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setBatchDeleteDialogOpen(false)}>\n              取消\n            </Button>\n            <Button variant=\"destructive\" onClick={handleBatchDelete}>\n              删除\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {selectedComicId && (\n        <ComicFilesManager\n          resourceId={selectedComicId}\n          open={comicFilesManagerOpen}\n          onClose={() => {\n            setComicFilesManagerOpen(false)\n            setSelectedComicId(null)\n          }}\n        />\n      )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5243, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/settings-drawer.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Settings, Save, Hash } from \"lucide-react\"\nimport { fetchSettings } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ninterface SettingsDrawerProps {\n  username?: string | null\n}\n\nexport function SettingsDrawer({ username }: SettingsDrawerProps) {\n  const [pageSize, setPageSize] = useState(\"\")\n  const [channels, setChannels] = useState<\n    { id: number; name: string }[]\n  >([])\n  const [loading, setLoading] = useState(true)\n  const [currentPassword, setCurrentPassword] = useState(\"\")\n  const [newPassword, setNewPassword] = useState(\"\")\n  const [confirmPassword, setConfirmPassword] = useState(\"\")\n  const [changingPassword, setChangingPassword] = useState(false)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let ignore = false\n    const load = async () => {\n      try {\n        setLoading(true)\n        const data = await fetchSettings()\n        if (!ignore) {\n          setPageSize(String(data.pageSize))\n          const entries = [\n            { id: data.searchChannelId, name: \"搜索群组 / 频道\" },\n            { id: data.storageChannelId, name: \"漫画仓库频道\" },\n  ]\n          setChannels(entries)\n        }\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"加载失败\"\n        toast({\n          title: \"读取设置失败\",\n          description: message,\n          variant: \"destructive\",\n        })\n      } finally {\n        if (!ignore) {\n          setLoading(false)\n        }\n      }\n    }\n    load()\n    return () => {\n      ignore = true\n    }\n  }, [toast])\n\n  const handleSave = () => {\n    toast({\n      title: \"暂未开放在线编辑\",\n      description: \"如需修改参数，请暂时在 .env 中调整并重启服务。\",\n    })\n  }\n\n  const handlePasswordChange = async () => {\n    if (!currentPassword || !newPassword) {\n      toast({ title: \"请填写完整信息\", variant: \"destructive\" })\n      return\n    }\n    if (newPassword.length < 8) {\n      toast({ title: \"新密码至少 8 位字符\", variant: \"destructive\" })\n      return\n    }\n    if (newPassword !== confirmPassword) {\n      toast({ title: \"两次输入的新密码不一致\", variant: \"destructive\" })\n      return\n    }\n    try {\n      setChangingPassword(true)\n      const res = await fetch(\"/api/auth/change-password\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ current_password: currentPassword, new_password: newPassword }),\n      })\n      if (!res.ok) {\n        const body = await res.json().catch(() => ({}))\n        throw new Error(body.detail ?? \"修改失败\")\n      }\n      toast({ title: \"密码修改成功\" })\n      setCurrentPassword(\"\")\n      setNewPassword(\"\")\n      setConfirmPassword(\"\")\n    } catch (error) {\n      toast({\n        title: \"修改失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setChangingPassword(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            <Settings className=\"h-5 w-5\" />\n            机器人设置\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-5\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"page-size\">每页数量</Label>\n            <Input\n              id=\"page-size\"\n              type=\"number\"\n              value={pageSize}\n              onChange={(e) => setPageSize(e.target.value)}\n              disabled={loading}\n              placeholder=\"5\"\n            />\n            <p className=\"text-xs text-muted-foreground\">资源列表每页显示的项目数</p>\n          </div>\n\n          <Button onClick={handleSave} className=\"w-full\" disabled={loading}>\n            <Save className=\"h-4 w-4 mr-2\" />\n            保存设置\n          </Button>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            <Hash className=\"h-5 w-5\" />\n            已连接频道\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {channels.map((channel) => (\n              <div key={channel.id} className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n                <div>\n                  <p className=\"font-medium text-sm\">{channel.name}</p>\n                  <p className=\"text-xs text-muted-foreground font-mono\">{channel.id}</p>\n                </div>\n                <Badge variant=\"secondary\" className=\"bg-success/10 text-success\">\n                  已连接\n                </Badge>\n              </div>\n            ))}\n            {!loading && channels.length === 0 && (\n              <p className=\"text-sm text-muted-foreground\">暂无频道信息</p>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            账户安全\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-1\">\n            <Label>当前账户</Label>\n            <p className=\"text-sm text-muted-foreground\">{username ?? \"管理员\"}</p>\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"current-password\">当前密码</Label>\n            <Input\n              id=\"current-password\"\n              type=\"password\"\n              value={currentPassword}\n              onChange={(e) => setCurrentPassword(e.target.value)}\n              autoComplete=\"current-password\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"new-password\">新密码</Label>\n            <Input\n              id=\"new-password\"\n              type=\"password\"\n              value={newPassword}\n              onChange={(e) => setNewPassword(e.target.value)}\n              autoComplete=\"new-password\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"confirm-password\">确认新密码</Label>\n            <Input\n              id=\"confirm-password\"\n              type=\"password\"\n              value={confirmPassword}\n              onChange={(e) => setConfirmPassword(e.target.value)}\n              autoComplete=\"new-password\"\n            />\n          </div>\n          <Button onClick={handlePasswordChange} disabled={changingPassword}>\n            {changingPassword ? \"更新中...\" : \"修改密码\"}\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5752, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/separator.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SeparatorPrimitive from '@radix-ui/react-separator'\n\nimport { cn } from '@/lib/utils'\n\nfunction Separator({\n  className,\n  orientation = 'horizontal',\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        'bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,4TAAC,iYAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,qHAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf;KAlBS"}},
    {"offset": {"line": 5787, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/search-button-manager.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useMemo, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Button } from \"@/components/ui/button\"\nimport { Label } from \"@/components/ui/label\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Copy, Link2, Plus, Save, Trash2 } from \"lucide-react\"\nimport {\n  createSearchButton,\n  deleteSearchButton,\n  fetchSearchButtons,\n  type SearchButtonRecord,\n  updateSearchButton,\n} from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ntype EditState = Record<\n  number,\n  {\n    label: string\n    url: string\n    sortOrder: string\n    dirty: boolean\n    saving: boolean\n  }\n>\n\nexport function SearchButtonManager() {\n  const [buttons, setButtons] = useState<SearchButtonRecord[]>([])\n  const [editMap, setEditMap] = useState<EditState>({})\n  const [newLabel, setNewLabel] = useState(\"\")\n  const [newUrl, setNewUrl] = useState(\"\")\n  const [newOrder, setNewOrder] = useState(\"\")\n  const [loading, setLoading] = useState(false)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let ignore = false\n    const load = async () => {\n      try {\n        setLoading(true)\n        const data = await fetchSearchButtons()\n        if (!ignore) {\n          setButtons(data)\n          const draft: EditState = {}\n          data.forEach((item) => {\n            draft[item.id] = {\n              label: item.label,\n              url: item.url,\n              sortOrder: String(item.sortOrder),\n              dirty: false,\n              saving: false,\n            }\n          })\n          setEditMap(draft)\n        }\n      } catch (error) {\n        toast({\n          title: \"读取按钮失败\",\n          description: error instanceof Error ? error.message : \"网络异常\",\n          variant: \"destructive\",\n        })\n      } finally {\n        if (!ignore) {\n          setLoading(false)\n        }\n      }\n    }\n    load()\n    return () => {\n      ignore = true\n    }\n  }, [toast])\n\n  const nextSortOrder = useMemo(() => {\n    if (!buttons.length) return 0\n    return Math.max(...buttons.map((b) => b.sortOrder)) + 1\n  }, [buttons])\n\n  useEffect(() => {\n    if (!newOrder) {\n      setNewOrder(String(nextSortOrder))\n    }\n  }, [nextSortOrder, newOrder])\n\n  const handleFieldChange = (id: number, field: keyof Pick<EditState[number], \"label\" | \"url\" | \"sortOrder\">, value: string) => {\n    setEditMap((prev) => {\n      const current = prev[id] ?? { label: \"\", url: \"\", sortOrder: \"0\", dirty: false, saving: false }\n      return {\n        ...prev,\n        [id]: { ...current, [field]: value, dirty: true },\n      }\n    })\n  }\n\n  const persistRow = async (button: SearchButtonRecord) => {\n    const state = editMap[button.id]\n    if (!state || state.saving || !state.dirty) return\n    if (!state.label.trim() || !state.url.trim()) {\n      toast({ title: \"请输入完整信息\", variant: \"destructive\" })\n      return\n    }\n    const sortOrder = Number(state.sortOrder)\n    if (Number.isNaN(sortOrder)) {\n      toast({ title: \"排序必须是数字\", variant: \"destructive\" })\n      return\n    }\n    setEditMap((prev) => ({ ...prev, [button.id]: { ...state, saving: true } }))\n    try {\n      const updated = await updateSearchButton(button.id, {\n        label: state.label.trim(),\n        url: state.url.trim(),\n        sort_order: sortOrder,\n      })\n      setButtons((prev) =>\n        prev\n          .map((item) => (item.id === updated.id ? updated : item))\n          .sort((a, b) => a.sortOrder - b.sortOrder),\n      )\n      setEditMap((prev) => ({\n        ...prev,\n        [button.id]: {\n          label: updated.label,\n          url: updated.url,\n          sortOrder: String(updated.sortOrder),\n          dirty: false,\n          saving: false,\n        },\n      }))\n      toast({ title: \"按钮已保存\" })\n    } catch (error) {\n      toast({\n        title: \"保存失败\",\n        description: error instanceof Error ? error.message : \"请稍后重试\",\n        variant: \"destructive\",\n      })\n      setEditMap((prev) => ({ ...prev, [button.id]: { ...state, saving: false } }))\n    }\n  }\n\n  const handleAdd = async () => {\n    if (!newLabel.trim() || !newUrl.trim()) {\n      toast({ title: \"请填写按钮文本和链接\", variant: \"destructive\" })\n      return\n    }\n    const sortOrder = Number(newOrder || nextSortOrder)\n    if (Number.isNaN(sortOrder)) {\n      toast({ title: \"排序编号需为数字\", variant: \"destructive\" })\n      return\n    }\n    try {\n      const created = await createSearchButton({\n        label: newLabel.trim(),\n        url: newUrl.trim(),\n        sort_order: sortOrder,\n      })\n      setButtons((prev) => [...prev, created].sort((a, b) => a.sortOrder - b.sortOrder))\n      setEditMap((prev) => ({\n        ...prev,\n        [created.id]: {\n          label: created.label,\n          url: created.url,\n          sortOrder: String(created.sortOrder),\n          dirty: false,\n          saving: false,\n        },\n      }))\n      setNewLabel(\"\")\n      setNewUrl(\"\")\n      setNewOrder(String(created.sortOrder + 1))\n      toast({ title: \"新增按钮成功\" })\n    } catch (error) {\n      toast({\n        title: \"新增失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleDelete = async (id: number) => {\n    try {\n      await deleteSearchButton(id)\n      setButtons((prev) => prev.filter((btn) => btn.id !== id))\n      setEditMap((prev) => {\n        const clone = { ...prev }\n        delete clone[id]\n        return clone\n      })\n      toast({ title: \"已删除按钮\" })\n    } catch (error) {\n      toast({\n        title: \"删除失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleClearAll = async () => {\n    if (buttons.length === 0) {\n      toast({ title: \"没有可清除的按钮\", variant: \"destructive\" })\n      return\n    }\n    \n    if (!confirm(`确定要清除所有 ${buttons.length} 个按钮吗？此操作不可恢复。`)) {\n      return\n    }\n\n    try {\n      // 循环删除所有按钮\n      for (const button of buttons) {\n        await deleteSearchButton(button.id)\n      }\n      setButtons([])\n      setEditMap({})\n      toast({ title: `已清除所有 ${buttons.length} 个按钮` })\n    } catch (error) {\n      toast({\n        title: \"清除失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleCopy = async (text: string) => {\n    try {\n      await navigator.clipboard.writeText(text)\n      toast({ title: \"已复制到剪贴板\" })\n    } catch (error) {\n      toast({\n        title: \"复制失败\",\n        description: error instanceof Error ? error.message : \"浏览器未授权\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            <Link2 className=\"h-5 w-5\" />\n            搜索结果底部按钮\n          </CardTitle>\n          {buttons.length > 0 && (\n            <Button variant=\"destructive\" onClick={handleClearAll} disabled={loading}>\n              <Trash2 className=\"h-4 w-4 mr-2\" />\n              清除所有按钮\n            </Button>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        <div className=\"grid gap-4 sm:grid-cols-3\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"new-label\">按钮文本</Label>\n            <Input\n              id=\"new-label\"\n              placeholder=\"例如：联系客服\"\n              value={newLabel}\n              onChange={(e) => setNewLabel(e.target.value)}\n            />\n          </div>\n          <div className=\"space-y-2 sm:col-span-2\">\n            <Label htmlFor=\"new-url\">按钮链接</Label>\n            <Input\n              id=\"new-url\"\n              placeholder=\"https://t.me/...\"\n              value={newUrl}\n              onChange={(e) => setNewUrl(e.target.value)}\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"new-order\">排序（越小越靠前）</Label>\n            <Input\n              id=\"new-order\"\n              type=\"number\"\n              value={newOrder}\n              onChange={(e) => setNewOrder(e.target.value)}\n            />\n          </div>\n        </div>\n        <Button onClick={handleAdd} disabled={loading} className=\"w-full sm:w-auto\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          新增按钮\n        </Button>\n\n        <Separator />\n\n        <div className=\"rounded-lg border border-border overflow-hidden\">\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-muted/50\">\n                <TableHead className=\"w-1/4\">按钮文本</TableHead>\n                <TableHead>跳转链接</TableHead>\n                <TableHead className=\"w-24\">排序</TableHead>\n                <TableHead className=\"w-48 text-right\">操作</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {buttons.map((button) => {\n                const entry = editMap[button.id]\n                return (\n                  <TableRow key={button.id}>\n                    <TableCell>\n                      <Input\n                        value={entry?.label ?? button.label}\n                        onChange={(e) => handleFieldChange(button.id, \"label\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Input\n                        value={entry?.url ?? button.url}\n                        onChange={(e) => handleFieldChange(button.id, \"url\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Input\n                        type=\"number\"\n                        value={entry?.sortOrder ?? String(button.sortOrder)}\n                        onChange={(e) => handleFieldChange(button.id, \"sortOrder\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex justify-end gap-2\">\n                        <Button variant=\"secondary\" size=\"icon\" onClick={() => handleCopy(entry?.url ?? button.url)}>\n                          <Copy className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          onClick={() => persistRow(button)}\n                          disabled={!entry?.dirty || entry?.saving}\n                        >\n                          <Save className=\"h-4 w-4\" />\n                        </Button>\n                        <Button variant=\"destructive\" size=\"icon\" onClick={() => handleDelete(button.id)}>\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                )\n              })}\n              {!buttons.length && (\n                <TableRow>\n                  <TableCell colSpan={4} className=\"text-center py-6 text-muted-foreground\">\n                    暂无按钮，请先添加\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6489, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/user-manager.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useEffect, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\nimport { Search, Trash2, Edit, Crown, Ban } from \"lucide-react\"\nimport {\n  Pagination,\n  PaginationContent,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n} from \"@/components/ui/pagination\"\nimport { useToast } from \"@/components/ui/use-toast\"\nimport {\n  fetchUsers,\n  updateUser,\n  deleteUser,\n  batchDeleteUsers,\n  type UserRecord,\n} from \"@/lib/api\"\n\nexport function UserManager() {\n  const [users, setUsers] = useState<UserRecord[]>([])\n  const [loading, setLoading] = useState(false)\n  const [search, setSearch] = useState(\"\")\n  const [selectedIds, setSelectedIds] = useState<Set<number>>(new Set())\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false)\n  const [batchDeleteDialogOpen, setBatchDeleteDialogOpen] = useState(false)\n  const [editingUser, setEditingUser] = useState<UserRecord | null>(null)\n  const [deletingUserId, setDeletingUserId] = useState<number | null>(null)\n  const [vipLoadingId, setVipLoadingId] = useState<number | null>(null)\n  const [page, setPage] = useState(1)\n  const [totalCount, setTotalCount] = useState(0)\n  const pageSize = 50\n  const { toast } = useToast()\n\n  useEffect(() => {\n    loadUsers()\n  }, [search, page])\n\n  const loadUsers = async () => {\n    try {\n      setLoading(true)\n      const skip = (page - 1) * pageSize\n      const data = await fetchUsers(search || undefined, skip, pageSize)\n      setUsers(data)\n      setSelectedIds(new Set())\n      \n      // 获取总数\n      const countParams = new URLSearchParams()\n      if (search) {\n        countParams.append(\"search\", search)\n      }\n      const countResponse = await fetch(`/api/users/count?${countParams.toString()}`)\n      if (countResponse.ok) {\n        const countData = await countResponse.json()\n        setTotalCount(countData.count || 0)\n      }\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"加载失败\"\n      toast({\n        title: \"加载用户失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n  \n  // 当搜索改变时，重置到第一页\n  useEffect(() => {\n    setPage(1)\n  }, [search])\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIds(new Set(users.map((u) => u.userId)))\n    } else {\n      setSelectedIds(new Set())\n    }\n  }\n\n  const handleSelectOne = (userId: number, checked: boolean) => {\n    const next = new Set(selectedIds)\n    if (checked) {\n      next.add(userId)\n    } else {\n      next.delete(userId)\n    }\n    setSelectedIds(next)\n  }\n\n  const handleDelete = async (userId: number) => {\n    try {\n      await deleteUser(userId)\n      toast({ title: \"已删除用户\" })\n      await loadUsers()\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"删除失败\"\n      toast({\n        title: \"删除失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleBatchDelete = async () => {\n    if (selectedIds.size === 0) return\n    try {\n      await batchDeleteUsers(Array.from(selectedIds))\n      toast({ title: `已删除 ${selectedIds.size} 个用户` })\n      setBatchDeleteDialogOpen(false)\n      await loadUsers()\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"批量删除失败\"\n      toast({\n        title: \"批量删除失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleSave = async (user: Partial<UserRecord>) => {\n    if (!editingUser) return\n    try {\n      await updateUser(editingUser.userId, user)\n      toast({ title: \"已更新用户\" })\n      setEditingUser(null)\n      await loadUsers()\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"保存失败\"\n      toast({\n        title: \"保存失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const isVip = (user: UserRecord) => {\n    if (!user.vipExpiry) return false\n    return new Date(user.vipExpiry) > new Date()\n  }\n\n  const handleGrantVip = async (userId: number, days = 30) => {\n    try {\n      setVipLoadingId(userId)\n      const expiry = new Date()\n      expiry.setDate(expiry.getDate() + days)\n      await updateUser(userId, { vipExpiry: expiry.toISOString() })\n      toast({ title: `已为用户添加 ${days} 天 VIP` })\n      await loadUsers()\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"设置 VIP 失败\"\n      toast({\n        title: \"设置 VIP 失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setVipLoadingId(null)\n    }\n  }\n\n  const handleRemoveVip = async (userId: number) => {\n    try {\n      setVipLoadingId(userId)\n      await updateUser(userId, { vipExpiry: null })\n      toast({ title: \"已取消用户 VIP\" })\n      await loadUsers()\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"取消 VIP 失败\"\n      toast({\n        title: \"取消 VIP 失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setVipLoadingId(null)\n    }\n  }\n\n  return (\n    <>\n      <Card className=\"w-full\">\n        <CardHeader>\n          <CardTitle>用户管理</CardTitle>\n          <div className=\"flex flex-col sm:flex-row gap-3 mt-4\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"搜索用户（ID、用户名、昵称）...\"\n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n                className=\"pl-9\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              {selectedIds.size > 0 && (\n                <Button\n                  variant=\"destructive\"\n                  onClick={() => setBatchDeleteDialogOpen(true)}\n                >\n                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                  批量删除 ({selectedIds.size})\n                </Button>\n              )}\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-lg border border-border overflow-hidden\">\n            <Table>\n              <TableHeader>\n                <TableRow className=\"bg-muted/50\">\n                  <TableHead className=\"w-12\">\n                    <Checkbox\n                      checked={selectedIds.size === users.length && users.length > 0}\n                      onCheckedChange={handleSelectAll}\n                    />\n                  </TableHead>\n                  <TableHead>用户ID</TableHead>\n                  <TableHead>昵称</TableHead>\n                  <TableHead>用户名</TableHead>\n                  <TableHead>VIP</TableHead>\n                  <TableHead>VIP到期</TableHead>\n                  <TableHead>状态</TableHead>\n                  <TableHead className=\"w-40 text-right\">操作</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {users.map((user) => (\n                  <TableRow key={user.userId}>\n                    <TableCell>\n                      <Checkbox\n                        checked={selectedIds.has(user.userId)}\n                        onCheckedChange={(checked) =>\n                          handleSelectOne(user.userId, checked as boolean)\n                        }\n                      />\n                    </TableCell>\n                    <TableCell className=\"font-mono text-sm\">{user.userId}</TableCell>\n                    <TableCell>{user.firstName || \"-\"}</TableCell>\n                    <TableCell>@{user.username || \"-\"}</TableCell>\n                    <TableCell>\n                      {isVip(user) ? (\n                        <Badge className=\"bg-warning text-warning-foreground\">\n                          <Crown className=\"h-3 w-3 mr-1\" />\n                          VIP\n                        </Badge>\n                      ) : (\n                        <span className=\"text-muted-foreground text-sm\">普通</span>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-sm\">\n                      {user.vipExpiry\n                        ? new Date(user.vipExpiry).toLocaleDateString(\"zh-CN\")\n                        : \"-\"}\n                    </TableCell>\n                    <TableCell>\n                      {user.isBlocked ? (\n                        <Badge variant=\"destructive\">\n                          <Ban className=\"h-3 w-3 mr-1\" />\n                          已封禁\n                        </Badge>\n                      ) : (\n                        <Badge variant=\"secondary\">正常</Badge>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex flex-wrap justify-end gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => setEditingUser(user)}\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        {isVip(user) ? (\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            title=\"取消 VIP\"\n                            disabled={vipLoadingId === user.userId}\n                            onClick={() => handleRemoveVip(user.userId)}\n                          >\n                            <Ban className=\"h-4 w-4\" />\n                          </Button>\n                        ) : (\n                          <Button\n                            variant=\"secondary\"\n                            size=\"icon\"\n                            title=\"赋予 30 天 VIP\"\n                            disabled={vipLoadingId === user.userId}\n                            onClick={() => handleGrantVip(user.userId)}\n                          >\n                            <Crown className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => {\n                            setDeletingUserId(user.userId)\n                            setDeleteDialogOpen(true)\n                          }}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                ))}\n                {loading && (\n                  <TableRow>\n                    <TableCell colSpan={8} className=\"text-center py-8 text-muted-foreground\">\n                      正在加载数据...\n                    </TableCell>\n                  </TableRow>\n                )}\n                {!loading && users.length === 0 && (\n                  <TableRow>\n                  <TableCell colSpan={8} className=\"text-center py-8 text-muted-foreground\">\n                    未找到用户\n                    </TableCell>\n                  </TableRow>\n                )}\n              </TableBody>\n            </Table>\n          </div>\n          {totalCount > pageSize && (\n            <div className=\"mt-4 flex justify-center\">\n              <Pagination>\n                <PaginationContent>\n                  <PaginationItem>\n                    <PaginationPrevious\n                      href=\"#\"\n                      onClick={(e) => {\n                        e.preventDefault()\n                        if (page > 1) setPage(page - 1)\n                      }}\n                      className={page === 1 ? \"pointer-events-none opacity-50\" : \"\"}\n                    />\n                  </PaginationItem>\n                  {Array.from({ length: Math.ceil(totalCount / pageSize) }, (_, i) => i + 1)\n                    .filter((p) => {\n                      // 只显示当前页附近的页码\n                      return p === 1 || p === Math.ceil(totalCount / pageSize) || Math.abs(p - page) <= 2\n                    })\n                    .map((p, idx, arr) => {\n                      // 如果当前页码和下一个页码之间有间隔，显示省略号\n                      const prev = arr[idx - 1]\n                      const showEllipsis = prev && p - prev > 1\n                      return (\n                        <React.Fragment key={p}>\n                          {showEllipsis && (\n                            <PaginationItem>\n                              <span className=\"px-2\">...</span>\n                            </PaginationItem>\n                          )}\n                          <PaginationItem>\n                            <PaginationLink\n                              href=\"#\"\n                              onClick={(e) => {\n                                e.preventDefault()\n                                setPage(p)\n                              }}\n                              isActive={p === page}\n                            >\n                              {p}\n                            </PaginationLink>\n                          </PaginationItem>\n                        </React.Fragment>\n                      )\n                    })}\n                  <PaginationItem>\n                    <PaginationNext\n                      href=\"#\"\n                      onClick={(e) => {\n                        e.preventDefault()\n                        if (page < Math.ceil(totalCount / pageSize)) setPage(page + 1)\n                      }}\n                      className={page >= Math.ceil(totalCount / pageSize) ? \"pointer-events-none opacity-50\" : \"\"}\n                    />\n                  </PaginationItem>\n                </PaginationContent>\n              </Pagination>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>确认删除</DialogTitle>\n            <DialogDescription>\n              确定要删除这个用户吗？此操作不可恢复。\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => {\n              setDeleteDialogOpen(false)\n              setDeletingUserId(null)\n            }}>\n              取消\n            </Button>\n            <Button\n              variant=\"destructive\"\n              onClick={async () => {\n                if (deletingUserId) {\n                  await handleDelete(deletingUserId)\n                  setDeleteDialogOpen(false)\n                  setDeletingUserId(null)\n                }\n              }}\n            >\n              删除\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={batchDeleteDialogOpen} onOpenChange={setBatchDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>确认批量删除</DialogTitle>\n            <DialogDescription>\n              确定要删除选中的 {selectedIds.size} 个用户吗？此操作不可恢复。\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setBatchDeleteDialogOpen(false)}>\n              取消\n            </Button>\n            <Button variant=\"destructive\" onClick={handleBatchDelete}>\n              删除\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {editingUser && (\n        <UserEditDialog\n          open={editingUser !== null}\n          user={editingUser}\n          onClose={() => setEditingUser(null)}\n          onSave={handleSave}\n        />\n      )}\n    </>\n  )\n}\n\nfunction UserEditDialog({\n  open,\n  user,\n  onClose,\n  onSave,\n}: {\n  open: boolean\n  user: UserRecord | null\n  onClose: () => void\n  onSave: (user: Partial<UserRecord>) => Promise<void>\n}) {\n  const [vipExpiry, setVipExpiry] = useState(\"\")\n\n  useEffect(() => {\n    if (user?.vipExpiry) {\n      setVipExpiry(new Date(user.vipExpiry).toISOString().split(\"T\")[0])\n    } else {\n      setVipExpiry(\"\")\n    }\n  }, [user, open])\n\n  if (!user) {\n    return null\n  }\n\n  const handleSubmit = async () => {\n    await onSave({\n      vipExpiry: vipExpiry ? new Date(vipExpiry).toISOString() : null,\n    })\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>设置 VIP 到期时间</DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div>\n            <p className=\"text-sm text-muted-foreground\">用户 ID</p>\n            <p className=\"font-mono text-base\">{user.userId}</p>\n          </div>\n          <div>\n            <p className=\"text-sm text-muted-foreground\">昵称 / 用户名</p>\n            <p className=\"text-base\">\n              {user.firstName || \"-\"} {user.username ? `(@${user.username})` : \"\"}\n            </p>\n          </div>\n          <div className=\"space-y-2\">\n            <label className=\"text-sm font-medium\">VIP 到期日期</label>\n            <Input type=\"date\" value={vipExpiry} onChange={(e) => setVipExpiry(e.target.value)} />\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>\n            取消\n          </Button>\n          <Button onClick={handleSubmit}>保存</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AAAA;AAAA;AAAA;AAAA;AACA;AAQA;AACA;;;AA3BA;;;;;;;;;;;;;AAmCO,SAAS;;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wSAAQ,EAAe,EAAE;IACnD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wSAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,wSAAQ,EAAC;IACrC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,wSAAQ,EAAc,IAAI;IAChE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,wSAAQ,EAAC;IACzD,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,wSAAQ,EAAC;IACnE,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,wSAAQ,EAAoB;IAClE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,wSAAQ,EAAgB;IACpE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,wSAAQ,EAAgB;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wSAAQ,EAAC;IACjC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,wSAAQ,EAAC;IAC7C,MAAM,WAAW;IACjB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,+IAAQ;IAE1B,IAAA,ySAAS;iCAAC;YACR;QACF;gCAAG;QAAC;QAAQ;KAAK;IAEjB,MAAM,YAAY;QAChB,IAAI;YACF,WAAW;YACX,MAAM,OAAO,CAAC,OAAO,CAAC,IAAI;YAC1B,MAAM,OAAO,MAAM,IAAA,2HAAU,EAAC,UAAU,WAAW,MAAM;YACzD,SAAS;YACT,eAAe,IAAI;YAEnB,OAAO;YACP,MAAM,cAAc,IAAI;YACxB,IAAI,QAAQ;gBACV,YAAY,MAAM,CAAC,UAAU;YAC/B;YACA,MAAM,gBAAgB,MAAM,MAAM,CAAC,iBAAiB,EAAE,YAAY,QAAQ,IAAI;YAC9E,IAAI,cAAc,EAAE,EAAE;gBACpB,MAAM,YAAY,MAAM,cAAc,IAAI;gBAC1C,cAAc,UAAU,KAAK,IAAI;YACnC;QACF,EAAE,OAAO,OAAO;YACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,WAAW;QACb;IACF;IAEA,gBAAgB;IAChB,IAAA,ySAAS;iCAAC;YACR,QAAQ;QACV;gCAAG;QAAC;KAAO;IAEX,MAAM,kBAAkB,CAAC;QACvB,IAAI,SAAS;YACX,eAAe,IAAI,IAAI,MAAM,GAAG,CAAC,CAAC,IAAM,EAAE,MAAM;QAClD,OAAO;YACL,eAAe,IAAI;QACrB;IACF;IAEA,MAAM,kBAAkB,CAAC,QAAgB;QACvC,MAAM,OAAO,IAAI,IAAI;QACrB,IAAI,SAAS;YACX,KAAK,GAAG,CAAC;QACX,OAAO;YACL,KAAK,MAAM,CAAC;QACd;QACA,eAAe;IACjB;IAEA,MAAM,eAAe,OAAO;QAC1B,IAAI;YACF,MAAM,IAAA,2HAAU,EAAC;YACjB,MAAM;gBAAE,OAAO;YAAQ;YACvB,MAAM;QACR,EAAE,OAAO,OAAO;YACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,oBAAoB;QACxB,IAAI,YAAY,IAAI,KAAK,GAAG;QAC5B,IAAI;YACF,MAAM,IAAA,iIAAgB,EAAC,MAAM,IAAI,CAAC;YAClC,MAAM;gBAAE,OAAO,CAAC,IAAI,EAAE,YAAY,IAAI,CAAC,IAAI,CAAC;YAAC;YAC7C,yBAAyB;YACzB,MAAM;QACR,EAAE,OAAO,OAAO;YACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,aAAa,OAAO;QACxB,IAAI,CAAC,aAAa;QAClB,IAAI;YACF,MAAM,IAAA,2HAAU,EAAC,YAAY,MAAM,EAAE;YACrC,MAAM;gBAAE,OAAO;YAAQ;YACvB,eAAe;YACf,MAAM;QACR,EAAE,OAAO,OAAO;YACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,QAAQ,CAAC;QACb,IAAI,CAAC,KAAK,SAAS,EAAE,OAAO;QAC5B,OAAO,IAAI,KAAK,KAAK,SAAS,IAAI,IAAI;IACxC;IAEA,MAAM,iBAAiB,OAAO,QAAgB,OAAO,EAAE;QACrD,IAAI;YACF,gBAAgB;YAChB,MAAM,SAAS,IAAI;YACnB,OAAO,OAAO,CAAC,OAAO,OAAO,KAAK;YAClC,MAAM,IAAA,2HAAU,EAAC,QAAQ;gBAAE,WAAW,OAAO,WAAW;YAAG;YAC3D,MAAM;gBAAE,OAAO,CAAC,OAAO,EAAE,KAAK,MAAM,CAAC;YAAC;YACtC,MAAM;QACR,EAAE,OAAO,OAAO;YACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,MAAM,kBAAkB,OAAO;QAC7B,IAAI;YACF,gBAAgB;YAChB,MAAM,IAAA,2HAAU,EAAC,QAAQ;gBAAE,WAAW;YAAK;YAC3C,MAAM;gBAAE,OAAO;YAAY;YAC3B,MAAM;QACR,EAAE,OAAO,OAAO;YACd,MAAM,UAAU,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,qBACE;;0BACE,4TAAC,oIAAI;gBAAC,WAAU;;kCACd,4TAAC,0IAAU;;0CACT,4TAAC,yIAAS;0CAAC;;;;;;0CACX,4TAAC;gCAAI,WAAU;;kDACb,4TAAC;wCAAI,WAAU;;0DACb,4TAAC,uSAAM;gDAAC,WAAU;;;;;;0DAClB,4TAAC,sIAAK;gDACJ,aAAY;gDACZ,OAAO;gDACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;gDACzC,WAAU;;;;;;;;;;;;kDAGd,4TAAC;wCAAI,WAAU;kDACZ,YAAY,IAAI,GAAG,mBAClB,4TAAC,wIAAM;4CACL,SAAQ;4CACR,SAAS,IAAM,yBAAyB;;8DAExC,4TAAC,2SAAM;oDAAC,WAAU;;;;;;gDAAiB;gDAC5B,YAAY,IAAI;gDAAC;;;;;;;;;;;;;;;;;;;;;;;;kCAMlC,4TAAC,2IAAW;;0CACV,4TAAC;gCAAI,WAAU;0CACb,cAAA,4TAAC,sIAAK;;sDACJ,4TAAC,4IAAW;sDACV,cAAA,4TAAC,yIAAQ;gDAAC,WAAU;;kEAClB,4TAAC,0IAAS;wDAAC,WAAU;kEACnB,cAAA,4TAAC,4IAAQ;4DACP,SAAS,YAAY,IAAI,KAAK,MAAM,MAAM,IAAI,MAAM,MAAM,GAAG;4DAC7D,iBAAiB;;;;;;;;;;;kEAGrB,4TAAC,0IAAS;kEAAC;;;;;;kEACX,4TAAC,0IAAS;kEAAC;;;;;;kEACX,4TAAC,0IAAS;kEAAC;;;;;;kEACX,4TAAC,0IAAS;kEAAC;;;;;;kEACX,4TAAC,0IAAS;kEAAC;;;;;;kEACX,4TAAC,0IAAS;kEAAC;;;;;;kEACX,4TAAC,0IAAS;wDAAC,WAAU;kEAAkB;;;;;;;;;;;;;;;;;sDAG3C,4TAAC,0IAAS;;gDACP,MAAM,GAAG,CAAC,CAAC,qBACV,4TAAC,yIAAQ;;0EACP,4TAAC,0IAAS;0EACR,cAAA,4TAAC,4IAAQ;oEACP,SAAS,YAAY,GAAG,CAAC,KAAK,MAAM;oEACpC,iBAAiB,CAAC,UAChB,gBAAgB,KAAK,MAAM,EAAE;;;;;;;;;;;0EAInC,4TAAC,0IAAS;gEAAC,WAAU;0EAAqB,KAAK,MAAM;;;;;;0EACrD,4TAAC,0IAAS;0EAAE,KAAK,SAAS,IAAI;;;;;;0EAC9B,4TAAC,0IAAS;;oEAAC;oEAAE,KAAK,QAAQ,IAAI;;;;;;;0EAC9B,4TAAC,0IAAS;0EACP,MAAM,sBACL,4TAAC,sIAAK;oEAAC,WAAU;;sFACf,4TAAC,oSAAK;4EAAC,WAAU;;;;;;wEAAiB;;;;;;yFAIpC,4TAAC;oEAAK,WAAU;8EAAgC;;;;;;;;;;;0EAGpD,4TAAC,0IAAS;gEAAC,WAAU;0EAClB,KAAK,SAAS,GACX,IAAI,KAAK,KAAK,SAAS,EAAE,kBAAkB,CAAC,WAC5C;;;;;;0EAEN,4TAAC,0IAAS;0EACP,KAAK,SAAS,iBACb,4TAAC,sIAAK;oEAAC,SAAQ;;sFACb,4TAAC,8RAAG;4EAAC,WAAU;;;;;;wEAAiB;;;;;;yFAIlC,4TAAC,sIAAK;oEAAC,SAAQ;8EAAY;;;;;;;;;;;0EAG/B,4TAAC,0IAAS;gEAAC,WAAU;0EACnB,cAAA,4TAAC;oEAAI,WAAU;;sFACb,4TAAC,wIAAM;4EACL,SAAQ;4EACR,MAAK;4EACL,SAAS,IAAM,eAAe;sFAE9B,cAAA,4TAAC,0SAAI;gFAAC,WAAU;;;;;;;;;;;wEAEjB,MAAM,sBACL,4TAAC,wIAAM;4EACL,SAAQ;4EACR,MAAK;4EACL,OAAM;4EACN,UAAU,iBAAiB,KAAK,MAAM;4EACtC,SAAS,IAAM,gBAAgB,KAAK,MAAM;sFAE1C,cAAA,4TAAC,8RAAG;gFAAC,WAAU;;;;;;;;;;iGAGjB,4TAAC,wIAAM;4EACL,SAAQ;4EACR,MAAK;4EACL,OAAM;4EACN,UAAU,iBAAiB,KAAK,MAAM;4EACtC,SAAS,IAAM,eAAe,KAAK,MAAM;sFAEzC,cAAA,4TAAC,oSAAK;gFAAC,WAAU;;;;;;;;;;;sFAGrB,4TAAC,wIAAM;4EACL,SAAQ;4EACR,MAAK;4EACL,SAAS;gFACP,kBAAkB,KAAK,MAAM;gFAC7B,oBAAoB;4EACtB;sFAEA,cAAA,4TAAC,2SAAM;gFAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;uDA3EX,KAAK,MAAM;;;;;gDAiF3B,yBACC,4TAAC,yIAAQ;8DACP,cAAA,4TAAC,0IAAS;wDAAC,SAAS;wDAAG,WAAU;kEAAyC;;;;;;;;;;;gDAK7E,CAAC,WAAW,MAAM,MAAM,KAAK,mBAC5B,4TAAC,yIAAQ;8DACT,cAAA,4TAAC,0IAAS;wDAAC,SAAS;wDAAG,WAAU;kEAAyC;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAQjF,aAAa,0BACZ,4TAAC;gCAAI,WAAU;0CACb,cAAA,4TAAC,gJAAU;8CACT,cAAA,4TAAC,uJAAiB;;0DAChB,4TAAC,oJAAc;0DACb,cAAA,4TAAC,wJAAkB;oDACjB,MAAK;oDACL,SAAS,CAAC;wDACR,EAAE,cAAc;wDAChB,IAAI,OAAO,GAAG,QAAQ,OAAO;oDAC/B;oDACA,WAAW,SAAS,IAAI,mCAAmC;;;;;;;;;;;4CAG9D,MAAM,IAAI,CAAC;gDAAE,QAAQ,KAAK,IAAI,CAAC,aAAa;4CAAU,GAAG,CAAC,GAAG,IAAM,IAAI,GACrE,MAAM,CAAC,CAAC;gDACP,cAAc;gDACd,OAAO,MAAM,KAAK,MAAM,KAAK,IAAI,CAAC,aAAa,aAAa,KAAK,GAAG,CAAC,IAAI,SAAS;4CACpF,GACC,GAAG,CAAC,CAAC,GAAG,KAAK;gDACZ,0BAA0B;gDAC1B,MAAM,OAAO,GAAG,CAAC,MAAM,EAAE;gDACzB,MAAM,eAAe,QAAQ,IAAI,OAAO;gDACxC,qBACE,4TAAC,uSAAK,CAAC,QAAQ;;wDACZ,8BACC,4TAAC,oJAAc;sEACb,cAAA,4TAAC;gEAAK,WAAU;0EAAO;;;;;;;;;;;sEAG3B,4TAAC,oJAAc;sEACb,cAAA,4TAAC,oJAAc;gEACb,MAAK;gEACL,SAAS,CAAC;oEACR,EAAE,cAAc;oEAChB,QAAQ;gEACV;gEACA,UAAU,MAAM;0EAEf;;;;;;;;;;;;mDAfc;;;;;4CAoBzB;0DACF,4TAAC,oJAAc;0DACb,cAAA,4TAAC,oJAAc;oDACb,MAAK;oDACL,SAAS,CAAC;wDACR,EAAE,cAAc;wDAChB,IAAI,OAAO,KAAK,IAAI,CAAC,aAAa,WAAW,QAAQ,OAAO;oDAC9D;oDACA,WAAW,QAAQ,KAAK,IAAI,CAAC,aAAa,YAAY,mCAAmC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAUzG,4TAAC,wIAAM;gBAAC,MAAM;gBAAkB,cAAc;0BAC5C,cAAA,4TAAC,+IAAa;;sCACZ,4TAAC,8IAAY;;8CACX,4TAAC,6IAAW;8CAAC;;;;;;8CACb,4TAAC,mJAAiB;8CAAC;;;;;;;;;;;;sCAIrB,4TAAC,8IAAY;;8CACX,4TAAC,wIAAM;oCAAC,SAAQ;oCAAU,SAAS;wCACjC,oBAAoB;wCACpB,kBAAkB;oCACpB;8CAAG;;;;;;8CAGH,4TAAC,wIAAM;oCACL,SAAQ;oCACR,SAAS;wCACP,IAAI,gBAAgB;4CAClB,MAAM,aAAa;4CACnB,oBAAoB;4CACpB,kBAAkB;wCACpB;oCACF;8CACD;;;;;;;;;;;;;;;;;;;;;;;0BAOP,4TAAC,wIAAM;gBAAC,MAAM;gBAAuB,cAAc;0BACjD,cAAA,4TAAC,+IAAa;;sCACZ,4TAAC,8IAAY;;8CACX,4TAAC,6IAAW;8CAAC;;;;;;8CACb,4TAAC,mJAAiB;;wCAAC;wCACP,YAAY,IAAI;wCAAC;;;;;;;;;;;;;sCAG/B,4TAAC,8IAAY;;8CACX,4TAAC,wIAAM;oCAAC,SAAQ;oCAAU,SAAS,IAAM,yBAAyB;8CAAQ;;;;;;8CAG1E,4TAAC,wIAAM;oCAAC,SAAQ;oCAAc,SAAS;8CAAmB;;;;;;;;;;;;;;;;;;;;;;;YAO/D,6BACC,4TAAC;gBACC,MAAM,gBAAgB;gBACtB,MAAM;gBACN,SAAS,IAAM,eAAe;gBAC9B,QAAQ;;;;;;;;AAKlB;GAlbgB;;QAaI,+IAAQ;;;KAbZ;AAobhB,SAAS,eAAe,EACtB,IAAI,EACJ,IAAI,EACJ,OAAO,EACP,MAAM,EAMP;;IACC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,wSAAQ,EAAC;IAE3C,IAAA,ySAAS;oCAAC;YACR,IAAI,MAAM,WAAW;gBACnB,aAAa,IAAI,KAAK,KAAK,SAAS,EAAE,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACnE,OAAO;gBACL,aAAa;YACf;QACF;mCAAG;QAAC;QAAM;KAAK;IAEf,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,MAAM,eAAe;QACnB,MAAM,OAAO;YACX,WAAW,YAAY,IAAI,KAAK,WAAW,WAAW,KAAK;QAC7D;IACF;IAEA,qBACE,4TAAC,wIAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,4TAAC,+IAAa;;8BACZ,4TAAC,8IAAY;8BACX,cAAA,4TAAC,6IAAW;kCAAC;;;;;;;;;;;8BAEf,4TAAC;oBAAI,WAAU;;sCACb,4TAAC;;8CACC,4TAAC;oCAAE,WAAU;8CAAgC;;;;;;8CAC7C,4TAAC;oCAAE,WAAU;8CAAuB,KAAK,MAAM;;;;;;;;;;;;sCAEjD,4TAAC;;8CACC,4TAAC;oCAAE,WAAU;8CAAgC;;;;;;8CAC7C,4TAAC;oCAAE,WAAU;;wCACV,KAAK,SAAS,IAAI;wCAAI;wCAAE,KAAK,QAAQ,GAAG,CAAC,EAAE,EAAE,KAAK,QAAQ,CAAC,CAAC,CAAC,GAAG;;;;;;;;;;;;;sCAGrE,4TAAC;4BAAI,WAAU;;8CACb,4TAAC;oCAAM,WAAU;8CAAsB;;;;;;8CACvC,4TAAC,sIAAK;oCAAC,MAAK;oCAAO,OAAO;oCAAW,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;;8BAGrF,4TAAC,8IAAY;;sCACX,4TAAC,wIAAM;4BAAC,SAAQ;4BAAU,SAAS;sCAAS;;;;;;sCAG5C,4TAAC,wIAAM;4BAAC,SAAS;sCAAc;;;;;;;;;;;;;;;;;;;;;;;AAKzC;IA9DS;MAAA"}},
    {"offset": {"line": 7575, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { Sidebar } from \"@/components/sidebar\"\nimport { NovelAudioForm } from \"@/components/novel-audio-form\"\nimport { ComicUploadWizard } from \"@/components/comic-upload-wizard\"\nimport { ResourceList } from \"@/components/resource-list\"\nimport { SettingsDrawer } from \"@/components/settings-drawer\"\nimport { SearchButtonManager } from \"@/components/search-button-manager\"\nimport { UserManager } from \"@/components/user-manager\"\nimport { Button } from \"@/components/ui/button\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ntype NavItem = \"novel-audio\" | \"comic\" | \"resources\" | \"buttons\" | \"users\" | \"settings\"\n\ninterface Session {\n  username: string\n}\n\nexport default function Dashboard() {\n  const [activeItem, setActiveItem] = useState<NavItem>(\"novel-audio\")\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false)\n  const [session, setSession] = useState<Session | null>(null)\n  const [checkingAuth, setCheckingAuth] = useState(true)\n  const router = useRouter()\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let cancelled = false\n    const check = async () => {\n      try {\n        const res = await fetch(\"/api/auth/session\", { cache: \"no-store\" })\n        if (!res.ok) {\n          router.replace(\"/login\")\n          return\n        }\n        const data = (await res.json()) as Session\n        if (!cancelled) {\n          setSession(data)\n        }\n      } catch {\n        router.replace(\"/login\")\n      } finally {\n        if (!cancelled) {\n          setCheckingAuth(false)\n        }\n      }\n    }\n    check()\n    return () => {\n      cancelled = true\n    }\n  }, [router])\n\n  const handleLogout = async () => {\n    await fetch(\"/api/auth/logout\", { method: \"POST\" })\n    toast({ title: \"已退出登录\" })\n    router.replace(\"/login\")\n  }\n\n  if (checkingAuth) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center text-muted-foreground\">\n        验证身份中...\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-background\">\n      <Sidebar\n        activeItem={activeItem}\n        onItemChange={setActiveItem}\n        collapsed={sidebarCollapsed}\n        onCollapsedChange={setSidebarCollapsed}\n        onLogout={handleLogout}\n      />\n\n      <main className=\"flex-1 overflow-auto flex justify-center\">\n        <div className=\"w-full p-6 lg:p-8 max-w-[90rem] mx-auto space-y-6\">\n          <header className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n            <div>\n            <h1 className=\"text-2xl font-bold text-foreground\">\n              {activeItem === \"novel-audio\" && \"索引小说 / 音频\"}\n              {activeItem === \"comic\" && \"上传漫画\"}\n              {activeItem === \"resources\" && \"管理资源\"}\n                {activeItem === \"buttons\" && \"搜索结果底部按钮\"}\n                {activeItem === \"users\" && \"用户管理\"}\n              {activeItem === \"settings\" && \"设置\"}\n            </h1>\n            <p className=\"text-muted-foreground mt-1\">\n              {activeItem === \"novel-audio\" && \"添加新的小说或有声书到你的 Telegram 机器人\"}\n              {activeItem === \"comic\" && \"批量上传漫画图片\"}\n              {activeItem === \"resources\" && \"查看和管理所有已索引的资源\"}\n                {activeItem === \"buttons\" && \"自定义搜索回复下方的跳转按钮\"}\n                {activeItem === \"users\" && \"查看所有使用机器人用户，并手动配置 VIP 权限\"}\n                {activeItem === \"settings\" && \"配置机器人设置与账户安全\"}\n            </p>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              {session && <span className=\"text-sm text-muted-foreground\">👤 {session.username}</span>}\n              <Button variant=\"outline\" onClick={handleLogout}>\n                退出登录\n              </Button>\n            </div>\n          </header>\n\n          {activeItem === \"novel-audio\" && <NovelAudioForm className=\"w-full\" />}\n          {activeItem === \"comic\" && <ComicUploadWizard className=\"w-full\" />}\n          {activeItem === \"resources\" && <ResourceList />}\n          {activeItem === \"buttons\" && <SearchButtonManager />}\n          {activeItem === \"users\" && <UserManager />}\n          {activeItem === \"settings\" && <SettingsDrawer username={session?.username} />}\n        </div>\n      </main>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAZA;;;;;;;;;;;;AAoBe,SAAS;;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,wSAAQ,EAAU;IACtD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,wSAAQ,EAAC;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wSAAQ,EAAiB;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,wSAAQ,EAAC;IACjD,MAAM,SAAS,IAAA,iRAAS;IACxB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,+IAAQ;IAE1B,IAAA,ySAAS;+BAAC;YACR,IAAI,YAAY;YAChB,MAAM;6CAAQ;oBACZ,IAAI;wBACF,MAAM,MAAM,MAAM,MAAM,qBAAqB;4BAAE,OAAO;wBAAW;wBACjE,IAAI,CAAC,IAAI,EAAE,EAAE;4BACX,OAAO,OAAO,CAAC;4BACf;wBACF;wBACA,MAAM,OAAQ,MAAM,IAAI,IAAI;wBAC5B,IAAI,CAAC,WAAW;4BACd,WAAW;wBACb;oBACF,EAAE,OAAM;wBACN,OAAO,OAAO,CAAC;oBACjB,SAAU;wBACR,IAAI,CAAC,WAAW;4BACd,gBAAgB;wBAClB;oBACF;gBACF;;YACA;YACA;uCAAO;oBACL,YAAY;gBACd;;QACF;8BAAG;QAAC;KAAO;IAEX,MAAM,eAAe;QACnB,MAAM,MAAM,oBAAoB;YAAE,QAAQ;QAAO;QACjD,MAAM;YAAE,OAAO;QAAQ;QACvB,OAAO,OAAO,CAAC;IACjB;IAEA,IAAI,cAAc;QAChB,qBACE,4TAAC;YAAI,WAAU;sBAAsE;;;;;;IAIzF;IAEA,qBACE,4TAAC;QAAI,WAAU;;0BACb,4TAAC,oIAAO;gBACN,YAAY;gBACZ,cAAc;gBACd,WAAW;gBACX,mBAAmB;gBACnB,UAAU;;;;;;0BAGZ,4TAAC;gBAAK,WAAU;0BACd,cAAA,4TAAC;oBAAI,WAAU;;sCACb,4TAAC;4BAAO,WAAU;;8CAChB,4TAAC;;sDACD,4TAAC;4CAAG,WAAU;;gDACX,eAAe,iBAAiB;gDAChC,eAAe,WAAW;gDAC1B,eAAe,eAAe;gDAC5B,eAAe,aAAa;gDAC5B,eAAe,WAAW;gDAC5B,eAAe,cAAc;;;;;;;sDAEhC,4TAAC;4CAAE,WAAU;;gDACV,eAAe,iBAAiB;gDAChC,eAAe,WAAW;gDAC1B,eAAe,eAAe;gDAC5B,eAAe,aAAa;gDAC5B,eAAe,WAAW;gDAC1B,eAAe,cAAc;;;;;;;;;;;;;8CAGlC,4TAAC;oCAAI,WAAU;;wCACZ,yBAAW,4TAAC;4CAAK,WAAU;;gDAAgC;gDAAI,QAAQ,QAAQ;;;;;;;sDAChF,4TAAC,wIAAM;4CAAC,SAAQ;4CAAU,SAAS;sDAAc;;;;;;;;;;;;;;;;;;wBAMpD,eAAe,+BAAiB,4TAAC,0JAAc;4BAAC,WAAU;;;;;;wBAC1D,eAAe,yBAAW,4TAAC,gKAAiB;4BAAC,WAAU;;;;;;wBACvD,eAAe,6BAAe,4TAAC,kJAAY;;;;;wBAC3C,eAAe,2BAAa,4TAAC,oKAAmB;;;;;wBAChD,eAAe,yBAAW,4TAAC,gJAAW;;;;;wBACtC,eAAe,4BAAc,4TAAC,sJAAc;4BAAC,UAAU,SAAS;;;;;;;;;;;;;;;;;;;;;;;AAK3E;GAlGwB;;QAKP,iRAAS;QACN,+IAAQ;;;KANJ"}}]
}