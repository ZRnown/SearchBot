{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/lib/admin-api.ts"],"sourcesContent":["// 获取后端 API 地址\n// 优先使用 ADMIN_API_BASE_URL，如果没有则使用默认值\nconst getBaseUrl = () => {\n  if (process.env.ADMIN_API_BASE_URL) {\n    return process.env.ADMIN_API_BASE_URL\n  }\n  // 默认使用 localhost\n  const port = process.env.WEB_PORT ?? \"8000\"\n  return `http://127.0.0.1:${port}`\n}\n\nconst BASE_URL = getBaseUrl()\n\n// 调试：输出 BASE_URL（仅在开发环境）\nif (process.env.NODE_ENV !== \"production\") {\n  console.log(\"[admin-api] BASE_URL:\", BASE_URL)\n}\n\nexport async function adminFetch(path: string, init?: RequestInit, token?: string) {\n  const url = path.startsWith(\"http\") ? path : `${BASE_URL}${path}`\n  const headers = new Headers(init?.headers)\n  if (token) {\n    headers.set(\"Authorization\", `Bearer ${token}`)\n  }\n  const response = await fetch(url, {\n    ...init,\n    headers,\n  })\n  return response\n}\n\n"],"names":[],"mappings":"AAAA,cAAc;AACd,qCAAqC;;;;;AACrC,MAAM,aAAa;IACjB,IAAI,QAAQ,GAAG,CAAC,kBAAkB,EAAE;QAClC,OAAO,QAAQ,GAAG,CAAC,kBAAkB;IACvC;IACA,iBAAiB;IACjB,MAAM,OAAO,QAAQ,GAAG,CAAC,QAAQ,IAAI;IACrC,OAAO,CAAC,iBAAiB,EAAE,MAAM;AACnC;AAEA,MAAM,WAAW;AAEjB,yBAAyB;AACzB,wCAA2C;IACzC,QAAQ,GAAG,CAAC,yBAAyB;AACvC;AAEO,eAAe,WAAW,IAAY,EAAE,IAAkB,EAAE,KAAc;IAC/E,MAAM,MAAM,KAAK,UAAU,CAAC,UAAU,OAAO,GAAG,WAAW,MAAM;IACjE,MAAM,UAAU,IAAI,QAAQ,MAAM;IAClC,IAAI,OAAO;QACT,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IAChD;IACA,MAAM,WAAW,MAAM,MAAM,KAAK;QAChC,GAAG,IAAI;QACP;IACF;IACA,OAAO;AACT"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/app/api/resources/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { cookies } from \"next/headers\"\nimport { adminFetch } from \"@/lib/admin-api\"\n\nexport async function GET(request: NextRequest) {\n  const { searchParams } = new URL(request.url)\n  const type = searchParams.get(\"type\")\n  const skip = searchParams.get(\"skip\") || \"0\"\n  const limit = searchParams.get(\"limit\") || \"50\"\n  \n  const params = new URLSearchParams()\n  if (type && type !== \"all\") {\n    params.append(\"resource_type\", type)\n  }\n  params.append(\"skip\", skip)\n  params.append(\"limit\", limit)\n  const query = params.toString() ? `?${params.toString()}` : \"\"\n\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"admin_token\")?.value\n  if (!token) {\n    return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 })\n  }\n\n  const upstream = await adminFetch(`/resources${query}`, undefined, token)\n  const body = await upstream.text()\n  if (!body) {\n    return NextResponse.json([], { status: upstream.status })\n  }\n  try {\n    return NextResponse.json(JSON.parse(body), { status: upstream.status })\n  } catch {\n    return new NextResponse(body, {\n      status: upstream.status,\n      headers: { \"content-type\": upstream.headers.get(\"content-type\") ?? \"text/plain\" },\n    })\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,OAAO,aAAa,GAAG,CAAC;IAC9B,MAAM,OAAO,aAAa,GAAG,CAAC,WAAW;IACzC,MAAM,QAAQ,aAAa,GAAG,CAAC,YAAY;IAE3C,MAAM,SAAS,IAAI;IACnB,IAAI,QAAQ,SAAS,OAAO;QAC1B,OAAO,MAAM,CAAC,iBAAiB;IACjC;IACA,OAAO,MAAM,CAAC,QAAQ;IACtB,OAAO,MAAM,CAAC,SAAS;IACvB,MAAM,QAAQ,OAAO,QAAQ,KAAK,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IAE5D,MAAM,cAAc,MAAM,IAAA,2QAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,gBAAgB;IAC9C,IAAI,CAAC,OAAO;QACV,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;IACtE;IAEA,MAAM,WAAW,MAAM,IAAA,mIAAU,EAAC,CAAC,UAAU,EAAE,OAAO,EAAE,WAAW;IACnE,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,IAAI,CAAC,MAAM;QACT,OAAO,+QAAY,CAAC,IAAI,CAAC,EAAE,EAAE;YAAE,QAAQ,SAAS,MAAM;QAAC;IACzD;IACA,IAAI;QACF,OAAO,+QAAY,CAAC,IAAI,CAAC,KAAK,KAAK,CAAC,OAAO;YAAE,QAAQ,SAAS,MAAM;QAAC;IACvE,EAAE,OAAM;QACN,OAAO,IAAI,+QAAY,CAAC,MAAM;YAC5B,QAAQ,SAAS,MAAM;YACvB,SAAS;gBAAE,gBAAgB,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;YAAa;QAClF;IACF;AACF"}}]
}