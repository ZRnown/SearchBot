{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,uOAAO,EAAC,IAAA,iMAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,qPAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,+SAAI,GAAG;IAE9B,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/sidebar.tsx"],"sourcesContent":["\"use client\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Book, Heart, Settings, List, PanelLeftClose, PanelLeft } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\n\ntype NavItem = \"novel-audio\" | \"comic\" | \"resources\" | \"settings\"\n\ninterface SidebarProps {\n  activeItem: NavItem\n  onItemChange: (item: NavItem) => void\n  collapsed: boolean\n  onCollapsedChange: (collapsed: boolean) => void\n  onLogout?: () => void\n}\n\nconst navItems = [\n  { id: \"novel-audio\" as const, label: \"小说 / 音频\", icon: Book },\n  { id: \"comic\" as const, label: \"漫画上传\", icon: Heart },\n  { id: \"resources\" as const, label: \"资源管理\", icon: List },\n  { id: \"settings\" as const, label: \"设置\", icon: Settings },\n]\n\nexport function Sidebar({ activeItem, onItemChange, collapsed, onCollapsedChange, onLogout }: SidebarProps) {\n  return (\n    <aside\n      className={cn(\n        \"flex flex-col border-r border-border bg-sidebar h-screen transition-all duration-300 sticky top-0\",\n        collapsed ? \"w-16\" : \"w-60\",\n      )}\n    >\n      <div className=\"flex items-center justify-between p-4 border-b border-border\">\n        {!collapsed && <span className=\"font-semibold text-sidebar-foreground text-balance\">TG 资源管理器</span>}\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => onCollapsedChange(!collapsed)}\n          className=\"text-sidebar-foreground\"\n        >\n          {collapsed ? <PanelLeft className=\"h-5 w-5\" /> : <PanelLeftClose className=\"h-5 w-5\" />}\n        </Button>\n      </div>\n\n      <nav className=\"flex-1 p-2 space-y-1\">\n        {navItems.map((item) => {\n          const Icon = item.icon\n          const isActive = activeItem === item.id\n          return (\n            <button\n              key={item.id}\n              onClick={() => onItemChange(item.id)}\n              className={cn(\n                \"flex items-center gap-3 w-full px-3 py-2.5 rounded-lg text-sm font-medium transition-colors\",\n                isActive\n                  ? \"bg-sidebar-accent text-sidebar-primary\"\n                  : \"text-sidebar-foreground hover:bg-sidebar-accent/50\",\n              )}\n            >\n              <Icon className=\"h-5 w-5 shrink-0\" />\n              {!collapsed && <span>{item.label}</span>}\n            </button>\n          )\n        })}\n      </nav>\n\n      <div className=\"p-2 border-t border-border\">\n        <Button\n          variant=\"ghost\"\n          className=\"w-full justify-center text-sm text-sidebar-foreground\"\n          onClick={onLogout}\n          disabled={!onLogout}\n        >\n          退出登录\n        </Button>\n      </div>\n    </aside>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;;;;;AAgBA,MAAM,WAAW;IACf;QAAE,IAAI;QAAwB,OAAO;QAAW,MAAM,iSAAI;IAAC;IAC3D;QAAE,IAAI;QAAkB,OAAO;QAAQ,MAAM,oSAAK;IAAC;IACnD;QAAE,IAAI;QAAsB,OAAO;QAAQ,MAAM,iSAAI;IAAC;IACtD;QAAE,IAAI;QAAqB,OAAO;QAAM,MAAM,6SAAQ;IAAC;CACxD;AAEM,SAAS,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAE,SAAS,EAAE,iBAAiB,EAAE,QAAQ,EAAgB;IACxG,qBACE,4TAAC;QACC,WAAW,IAAA,qHAAE,EACX,qGACA,YAAY,SAAS;;0BAGvB,4TAAC;gBAAI,WAAU;;oBACZ,CAAC,2BAAa,4TAAC;wBAAK,WAAU;kCAAqD;;;;;;kCACpF,4TAAC,wIAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS,IAAM,kBAAkB,CAAC;wBAClC,WAAU;kCAET,0BAAY,4TAAC,oTAAS;4BAAC,WAAU;;;;;iDAAe,4TAAC,uUAAc;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAI/E,4TAAC;gBAAI,WAAU;0BACZ,SAAS,GAAG,CAAC,CAAC;oBACb,MAAM,OAAO,KAAK,IAAI;oBACtB,MAAM,WAAW,eAAe,KAAK,EAAE;oBACvC,qBACE,4TAAC;wBAEC,SAAS,IAAM,aAAa,KAAK,EAAE;wBACnC,WAAW,IAAA,qHAAE,EACX,+FACA,WACI,2CACA;;0CAGN,4TAAC;gCAAK,WAAU;;;;;;4BACf,CAAC,2BAAa,4TAAC;0CAAM,KAAK,KAAK;;;;;;;uBAV3B,KAAK,EAAE;;;;;gBAalB;;;;;;0BAGF,4TAAC;gBAAI,WAAU;0BACb,cAAA,4TAAC,wIAAM;oBACL,SAAQ;oBACR,WAAU;oBACV,SAAS;oBACT,UAAU,CAAC;8BACZ;;;;;;;;;;;;;;;;;AAMT;KAtDgB"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 361, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,4TAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 392, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/label.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as LabelPrimitive from '@radix-ui/react-label'\n\nimport { cn } from '@/lib/utils'\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,4TAAC,gYAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/badge.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst badgeVariants = cva(\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\n        destructive:\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'span'> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : 'span'\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,qPAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,+SAAI,GAAG;IAE9B,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS"}},
    {"offset": {"line": 477, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/lib/api.ts"],"sourcesContent":["export type ResourceRecord = {\n  id: string\n  title: string\n  type: \"novel\" | \"audio\" | \"comic\"\n  isVip: boolean\n  link: string\n  previewLink?: string | null\n  deepLink?: string | null\n  createdAt: string\n}\n\nexport type ComicUploadResult = {\n  id: string\n  pages: number\n  deepLink: string\n  previewLink: string\n}\n\nexport type SearchButtonRecord = {\n  id: number\n  label: string\n  url: string\n  sortOrder: number\n}\n\nexport type SettingsPayload = {\n  comicBatchSize: number\n  freeViewLimit: number\n  pageSize: number\n  searchChannelId: number\n  comicPreviewChannelId: number\n  storageChannelId: number\n}\n\nasync function handleJson<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    const text = await response.text()\n    throw new Error(text || `Request failed with status ${response.status}`)\n  }\n  return (await response.json()) as T\n}\n\nexport async function fetchResources(filter: \"all\" | \"novel\" | \"audio\" | \"comic\" = \"all\") {\n  const query = filter !== \"all\" ? `?type=${filter}` : \"\"\n  const response = await fetch(`/api/resources${query}`, { cache: \"no-store\" })\n  const data = await handleJson<any[]>(response)\n  return data.map((item) => ({\n    id: item.id,\n    title: item.title,\n    type: item.type,\n    isVip: item.is_vip,\n    link: item.link,\n    previewLink: item.preview_link,\n    deepLink: item.deep_link,\n    createdAt: item.created_at,\n  })) as ResourceRecord[]\n}\n\nexport async function createIndexedResource(payload: {\n  title: string\n  type: \"novel\" | \"audio\"\n  jump_url: string\n}) {\n  const response = await fetch(\"/api/resources/indexed\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    title: item.title,\n    type: item.type,\n    isVip: item.is_vip ?? false,\n    link: item.link,\n    previewLink: item.link,\n    deepLink: null,\n    createdAt: new Date().toISOString(),\n  } as ResourceRecord\n}\n\nexport async function deleteResource(resourceId: string) {\n  const response = await fetch(`/api/resources/${resourceId}`, { method: \"DELETE\" })\n  if (!response.ok) {\n    const message = await response.text()\n    throw new Error(message || \"删除失败\")\n  }\n}\n\nexport async function updateResource(resourceId: string, payload: { title?: string; jump_url?: string }) {\n  const response = await fetch(`/api/resources/${resourceId}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    title: item.title,\n    type: item.type,\n    isVip: item.is_vip,\n    link: item.link,\n    previewLink: item.preview_link,\n    deepLink: item.deep_link,\n    createdAt: item.created_at,\n  } as ResourceRecord\n}\n\nexport async function uploadComic(payload: { title: string; isVip: boolean; files: File[]; previewLink: string }) {\n  const form = new FormData()\n  form.append(\"title\", payload.title)\n  form.append(\"preview_link\", payload.previewLink)\n  form.append(\"is_vip\", String(payload.isVip))\n  payload.files.forEach((file) => form.append(\"files\", file, file.name))\n  const response = await fetch(\"/api/resources/comics\", {\n    method: \"POST\",\n    body: form,\n  })\n  const data = await handleJson<any>(response)\n  return {\n    id: data.id,\n    pages: data.pages,\n    deepLink: data.deep_link,\n    previewLink: data.preview_link,\n  } as ComicUploadResult\n}\n\nexport async function fetchSettings() {\n  const response = await fetch(\"/api/settings\", { cache: \"no-store\" })\n  const data = await handleJson<any>(response)\n  return {\n    comicBatchSize: data.comic_batch_size,\n    freeViewLimit: data.free_view_limit,\n    pageSize: data.page_size,\n    searchChannelId: data.search_channel_id,\n    comicPreviewChannelId: data.comic_preview_channel_id,\n    storageChannelId: data.storage_channel_id,\n  } as SettingsPayload\n}\n\nexport async function fetchSearchButtons() {\n  const response = await fetch(\"/api/search-buttons\", { cache: \"no-store\" })\n  const data = await handleJson<any[]>(response)\n  return data.map((item) => ({\n    id: item.id,\n    label: item.label,\n    url: item.url,\n    sortOrder: item.sort_order,\n  })) as SearchButtonRecord[]\n}\n\nexport async function createSearchButton(payload: { label: string; url: string; sort_order: number }) {\n  const response = await fetch(\"/api/search-buttons\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    label: item.label,\n    url: item.url,\n    sortOrder: item.sort_order,\n  } as SearchButtonRecord\n}\n\nexport async function updateSearchButton(\n  buttonId: number,\n  payload: { label: string; url: string; sort_order: number },\n) {\n  const response = await fetch(`/api/search-buttons/${buttonId}`, {\n    method: \"PUT\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(payload),\n  })\n  const item = await handleJson<any>(response)\n  return {\n    id: item.id,\n    label: item.label,\n    url: item.url,\n    sortOrder: item.sort_order,\n  } as SearchButtonRecord\n}\n\nexport async function deleteSearchButton(buttonId: number) {\n  const response = await fetch(`/api/search-buttons/${buttonId}`, { method: \"DELETE\" })\n  if (!response.ok) {\n    const text = await response.text()\n    throw new Error(text || \"删除失败\")\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 664, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/use-toast.ts"],"sourcesContent":["'use client'\n\n// Inspired by react-hot-toast library\nimport * as React from 'react'\n\nimport type { ToastActionElement, ToastProps } from '@/components/ui/toast'\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: 'ADD_TOAST',\n  UPDATE_TOAST: 'UPDATE_TOAST',\n  DISMISS_TOAST: 'DISMISS_TOAST',\n  REMOVE_TOAST: 'REMOVE_TOAST',\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType['ADD_TOAST']\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType['UPDATE_TOAST']\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType['DISMISS_TOAST']\n      toastId?: ToasterToast['id']\n    }\n  | {\n      type: ActionType['REMOVE_TOAST']\n      toastId?: ToasterToast['id']\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: 'REMOVE_TOAST',\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case 'ADD_TOAST':\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case 'UPDATE_TOAST':\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t,\n        ),\n      }\n\n    case 'DISMISS_TOAST': {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t,\n        ),\n      }\n    }\n    case 'REMOVE_TOAST':\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, 'id'>\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: 'UPDATE_TOAST',\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id })\n\n  dispatch({\n    type: 'ADD_TOAST',\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":";;;;;;;;AAEA,sCAAsC;AACtC;;AAHA;;AAOA,MAAM,cAAc;AACpB,MAAM,qBAAqB;AAS3B,MAAM,cAAc;IAClB,WAAW;IACX,cAAc;IACd,eAAe;IACf,cAAc;AAChB;AAEA,IAAI,QAAQ;AAEZ,SAAS;IACP,QAAQ,CAAC,QAAQ,CAAC,IAAI,OAAO,gBAAgB;IAC7C,OAAO,MAAM,QAAQ;AACvB;AA0BA,MAAM,gBAAgB,IAAI;AAE1B,MAAM,mBAAmB,CAAC;IACxB,IAAI,cAAc,GAAG,CAAC,UAAU;QAC9B;IACF;IAEA,MAAM,UAAU,WAAW;QACzB,cAAc,MAAM,CAAC;QACrB,SAAS;YACP,MAAM;YACN,SAAS;QACX;IACF,GAAG;IAEH,cAAc,GAAG,CAAC,SAAS;AAC7B;AAEO,MAAM,UAAU,CAAC,OAAc;IACpC,OAAQ,OAAO,IAAI;QACjB,KAAK;YACH,OAAO;gBACL,GAAG,KAAK;gBACR,QAAQ;oBAAC,OAAO,KAAK;uBAAK,MAAM,MAAM;iBAAC,CAAC,KAAK,CAAC,GAAG;YACnD;QAEF,KAAK;YACH,OAAO;gBACL,GAAG,KAAK;gBACR,QAAQ,MAAM,MAAM,CAAC,GAAG,CAAC,CAAC,IACxB,EAAE,EAAE,KAAK,OAAO,KAAK,CAAC,EAAE,GAAG;wBAAE,GAAG,CAAC;wBAAE,GAAG,OAAO,KAAK;oBAAC,IAAI;YAE3D;QAEF,KAAK;YAAiB;gBACpB,MAAM,EAAE,OAAO,EAAE,GAAG;gBAEpB,2EAA2E;gBAC3E,uCAAuC;gBACvC,IAAI,SAAS;oBACX,iBAAiB;gBACnB,OAAO;oBACL,MAAM,MAAM,CAAC,OAAO,CAAC,CAAC;wBACpB,iBAAiB,MAAM,EAAE;oBAC3B;gBACF;gBAEA,OAAO;oBACL,GAAG,KAAK;oBACR,QAAQ,MAAM,MAAM,CAAC,GAAG,CAAC,CAAC,IACxB,EAAE,EAAE,KAAK,WAAW,YAAY,YAC5B;4BACE,GAAG,CAAC;4BACJ,MAAM;wBACR,IACA;gBAER;YACF;QACA,KAAK;YACH,IAAI,OAAO,OAAO,KAAK,WAAW;gBAChC,OAAO;oBACL,GAAG,KAAK;oBACR,QAAQ,EAAE;gBACZ;YACF;YACA,OAAO;gBACL,GAAG,KAAK;gBACR,QAAQ,MAAM,MAAM,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,OAAO,OAAO;YAC5D;IACJ;AACF;AAEA,MAAM,YAA2C,EAAE;AAEnD,IAAI,cAAqB;IAAE,QAAQ,EAAE;AAAC;AAEtC,SAAS,SAAS,MAAc;IAC9B,cAAc,QAAQ,aAAa;IACnC,UAAU,OAAO,CAAC,CAAC;QACjB,SAAS;IACX;AACF;AAIA,SAAS,MAAM,EAAE,GAAG,OAAc;IAChC,MAAM,KAAK;IAEX,MAAM,SAAS,CAAC,QACd,SAAS;YACP,MAAM;YACN,OAAO;gBAAE,GAAG,KAAK;gBAAE;YAAG;QACxB;IACF,MAAM,UAAU,IAAM,SAAS;YAAE,MAAM;YAAiB,SAAS;QAAG;IAEpE,SAAS;QACP,MAAM;QACN,OAAO;YACL,GAAG,KAAK;YACR;YACA,MAAM;YACN,cAAc,CAAC;gBACb,IAAI,CAAC,MAAM;YACb;QACF;IACF;IAEA,OAAO;QACL,IAAI;QACJ;QACA;IACF;AACF;AAEA,SAAS;;IACP,MAAM,CAAC,OAAO,SAAS,GAAG,wSAAc,CAAQ;IAEhD,ySAAe;8BAAC;YACd,UAAU,IAAI,CAAC;YACf;sCAAO;oBACL,MAAM,QAAQ,UAAU,OAAO,CAAC;oBAChC,IAAI,QAAQ,CAAC,GAAG;wBACd,UAAU,MAAM,CAAC,OAAO;oBAC1B;gBACF;;QACF;6BAAG;QAAC;KAAM;IAEV,OAAO;QACL,GAAG,KAAK;QACR;QACA,SAAS,CAAC,UAAqB,SAAS;gBAAE,MAAM;gBAAiB;YAAQ;IAC3E;AACF;GAlBS"}},
    {"offset": {"line": 831, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/novel-audio-form.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Book, Headphones, CheckCircle2 } from \"lucide-react\"\nimport { createIndexedResource } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\nexport function NovelAudioForm({ className = \"\" }: { className?: string } = {}) {\n  const [title, setTitle] = useState(\"\")\n  const [type, setType] = useState<\"novel\" | \"audio\">(\"novel\")\n  const [telegramLink, setTelegramLink] = useState(\"\")\n  const [synced, setSynced] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const { toast } = useToast()\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!title.trim() || !telegramLink.trim()) {\n      toast({\n        title: \"请填写完整信息\",\n        description: \"标题与 Telegram 链接不能为空\",\n        variant: \"destructive\",\n      })\n      return\n    }\n    try {\n      setLoading(true)\n      const resource = await createIndexedResource({\n        title: title.trim(),\n        type,\n        jump_url: telegramLink.trim(),\n      })\n    setSynced(true)\n      toast({\n        title: \"索引成功\",\n        description: `已创建资源：${resource.title}`,\n      })\n    setTimeout(() => setSynced(false), 3000)\n      setTitle(\"\")\n      setTelegramLink(\"\")\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"保存失败\"\n      toast({\n        title: \"保存失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Card className={className}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-card-foreground\">索引小说 / 音频</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <form onSubmit={handleSubmit} className=\"space-y-5\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"title\">标题</Label>\n            <Input id=\"title\" placeholder=\"输入资源标题...\" value={title} onChange={(e) => setTitle(e.target.value)} />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>资源类型</Label>\n            <div className=\"flex gap-2\">\n              <Button\n                type=\"button\"\n                variant={type === \"novel\" ? \"default\" : \"outline\"}\n                onClick={() => setType(\"novel\")}\n                className=\"flex-1\"\n              >\n                <Book className=\"h-4 w-4 mr-2\" />\n                小说\n              </Button>\n              <Button\n                type=\"button\"\n                variant={type === \"audio\" ? \"default\" : \"outline\"}\n                onClick={() => setType(\"audio\")}\n                className=\"flex-1\"\n              >\n                <Headphones className=\"h-4 w-4 mr-2\" />\n                音频\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"link\">Telegram 链接</Label>\n            <Input\n              id=\"link\"\n              placeholder=\"https://t.me/...\"\n              value={telegramLink}\n              onChange={(e) => setTelegramLink(e.target.value)}\n            />\n          </div>\n\n          <Button type=\"submit\" className=\"w-full\" disabled={loading}>\n            保存并同步到频道\n          </Button>\n\n          {synced && (\n            <Badge className=\"w-full justify-center py-2 bg-success text-success-foreground\">\n              <CheckCircle2 className=\"h-4 w-4 mr-2\" />\n              已同步到预览频道\n            </Badge>\n          )}\n        </form>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1104, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/switch.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SwitchPrimitive from '@radix-ui/react-switch'\n\nimport { cn } from '@/lib/utils'\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        'peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={\n          'bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0'\n        }\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,4TAAC,iYAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,4TAAC,kYAAqB;YACpB,aAAU;YACV,WACE;;;;;;;;;;;AAKV;KArBS"}},
    {"offset": {"line": 1145, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/progress.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ProgressPrimitive from '@radix-ui/react-progress'\n\nimport { cn } from '@/lib/utils'\n\nfunction Progress({\n  className,\n  value,\n  ...props\n}: React.ComponentProps<typeof ProgressPrimitive.Root>) {\n  return (\n    <ProgressPrimitive.Root\n      data-slot=\"progress\"\n      className={cn(\n        'bg-primary/20 relative h-2 w-full overflow-hidden rounded-full',\n        className,\n      )}\n      {...props}\n    >\n      <ProgressPrimitive.Indicator\n        data-slot=\"progress-indicator\"\n        className=\"bg-primary h-full w-full flex-1 transition-all\"\n        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n      />\n    </ProgressPrimitive.Root>\n  )\n}\n\nexport { Progress }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,SAAS,EAChB,SAAS,EACT,KAAK,EACL,GAAG,OACiD;IACpD,qBACE,4TAAC,gYAAsB;QACrB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;kBAET,cAAA,4TAAC,qYAA2B;YAC1B,aAAU;YACV,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;AAIlE;KArBS"}},
    {"offset": {"line": 1189, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/upload-dropzone.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useCallback, useState, useEffect } from \"react\"\nimport { useDropzone } from \"react-dropzone\"\nimport { Upload, X, GripVertical } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Progress } from \"@/components/ui/progress\"\nimport { cn } from \"@/lib/utils\"\n\ninterface UploadDropzoneProps {\n  images: File[]\n  onImagesChange: (images: File[]) => void\n  maxImages?: number\n}\n\nexport function UploadDropzone({ images, onImagesChange, maxImages = 200 }: UploadDropzoneProps) {\n  const [uploadProgress, setUploadProgress] = useState(0)\n  const [draggedIndex, setDraggedIndex] = useState<number | null>(null)\n  const [dragOverIndex, setDragOverIndex] = useState<number | null>(null)\n  const [previewUrls, setPreviewUrls] = useState<string[]>([])\n\n  useEffect(() => {\n    const urls = images.map((file) => URL.createObjectURL(file))\n    setPreviewUrls(urls)\n\n    return () => {\n      urls.forEach((url) => URL.revokeObjectURL(url))\n    }\n  }, [images])\n\n  const onDrop = useCallback(\n    (acceptedFiles: File[]) => {\n      const newImages = [...images, ...acceptedFiles].slice(0, maxImages)\n      onImagesChange(newImages)\n\n      setUploadProgress(0)\n      const interval = setInterval(() => {\n        setUploadProgress((prev) => {\n          if (prev >= 100) {\n            clearInterval(interval)\n            return 100\n          }\n          return prev + 10\n        })\n      }, 100)\n    },\n    [images, onImagesChange, maxImages],\n  )\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: { \"image/*\": [\".png\", \".jpg\", \".jpeg\", \".webp\"] },\n    maxFiles: maxImages - images.length,\n  })\n\n  const removeImage = (index: number) => {\n    onImagesChange(images.filter((_, i) => i !== index))\n  }\n\n  const handleDragStart = (e: React.DragEvent, index: number) => {\n    setDraggedIndex(index)\n    e.dataTransfer.effectAllowed = \"move\"\n  }\n\n  const handleDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault()\n    setDragOverIndex(index)\n  }\n\n  const handleDragEnd = () => {\n    if (draggedIndex !== null && dragOverIndex !== null && draggedIndex !== dragOverIndex) {\n      const newImages = [...images]\n      const [removed] = newImages.splice(draggedIndex, 1)\n      newImages.splice(dragOverIndex, 0, removed)\n      onImagesChange(newImages)\n    }\n    setDraggedIndex(null)\n    setDragOverIndex(null)\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\n          isDragActive ? \"border-primary bg-primary/5\" : \"border-border hover:border-primary/50\",\n        )}\n      >\n        <input {...getInputProps()} />\n        <Upload className=\"h-10 w-10 mx-auto text-muted-foreground mb-3\" />\n        <p className=\"text-sm text-muted-foreground\">{isDragActive ? \"将图片放在这里...\" : \"拖放图片，或点击选择\"}</p>\n        <p className=\"text-xs text-muted-foreground mt-1\">\n          {images.length} / {maxImages} 张图片\n        </p>\n      </div>\n\n      {uploadProgress > 0 && uploadProgress < 100 && (\n        <div className=\"space-y-2\">\n          <Progress value={uploadProgress} />\n          <p className=\"text-xs text-muted-foreground text-center\">上传中... {uploadProgress}%</p>\n        </div>\n      )}\n\n      {images.length > 0 && (\n        <div className=\"space-y-2\">\n          <p className=\"text-xs text-muted-foreground\">拖动图片可调整顺序</p>\n          <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3 max-h-80 overflow-y-auto p-2 bg-muted rounded-lg\">\n            {images.map((file, index) => (\n              <div\n                key={index}\n                draggable\n                onDragStart={(e) => handleDragStart(e, index)}\n                onDragOver={(e) => handleDragOver(e, index)}\n                onDragEnd={handleDragEnd}\n                className={cn(\n                  \"relative group aspect-[3/4] cursor-move transition-all rounded-lg overflow-hidden border-2 border-transparent\",\n                  draggedIndex === index && \"opacity-50 scale-95\",\n                  dragOverIndex === index && draggedIndex !== index && \"border-primary\",\n                )}\n              >\n                <img\n                  src={previewUrls[index] || \"/placeholder.svg\"}\n                  alt={`第 ${index + 1} 页`}\n                  className=\"w-full h-full object-cover\"\n                />\n                {/* 拖动手柄 */}\n                <div className=\"absolute top-1 left-1 bg-black/50 rounded p-0.5 opacity-0 group-hover:opacity-100 transition-opacity\">\n                  <GripVertical className=\"h-4 w-4 text-white\" />\n                </div>\n                {/* 删除按钮 */}\n                <Button\n                  variant=\"destructive\"\n                  size=\"icon\"\n                  className=\"absolute top-1 right-1 h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity\"\n                  onClick={() => removeImage(index)}\n                >\n                  <X className=\"h-3 w-3\" />\n                </Button>\n                {/* 页码标签 */}\n                <span className=\"absolute bottom-0 left-0 right-0 text-xs text-center bg-primary/90 text-primary-foreground font-medium py-1\">\n                  第 {index + 1} 页\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1483, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/comic-upload-wizard.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Switch } from \"@/components/ui/switch\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { UploadDropzone } from \"./upload-dropzone\"\nimport { Heart, ChevronRight, ChevronLeft, Check, Link2, Copy } from \"lucide-react\"\nimport { uploadComic } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ntype Step = 1 | 2 | 3\n\nexport function ComicUploadWizard({ className = \"\" }: { className?: string } = {}) {\n  const [step, setStep] = useState<Step>(1)\n  const [title, setTitle] = useState(\"\")\n  const [isVip, setIsVip] = useState(false)\n  const [images, setImages] = useState<File[]>([])\n  const [deepLink, setDeepLink] = useState(\"\")\n  const [previewLink, setPreviewLink] = useState(\"\")\n  const [previewInput, setPreviewInput] = useState(\"\")\n  const [isUploading, setIsUploading] = useState(false)\n  const { toast } = useToast()\n\n  const canProceedStep1 = title.trim().length > 0 && previewInput.trim().length > 0\n  const canProceedStep2 = images.length > 0\n\n  const handleFinish = async () => {\n    if (!canProceedStep1 || !canProceedStep2 || isUploading) return\n    try {\n      setIsUploading(true)\n      const result = await uploadComic({\n        title: title.trim(),\n        isVip,\n        files: images,\n        previewLink: previewInput.trim(),\n      })\n      setDeepLink(result.deepLink)\n      setPreviewLink(result.previewLink)\n      setStep(3)\n      toast({\n        title: \"上传成功\",\n        description: `共 ${result.pages} 张图片，已记录预览链接`,\n      })\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"上传失败\"\n      toast({\n        title: \"上传失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    } finally {\n      setIsUploading(false)\n    }\n  }\n\n  const copyLink = () => {\n    navigator.clipboard.writeText(deepLink)\n  }\n\n  const resetWizard = () => {\n    setStep(1)\n    setTitle(\"\")\n    setIsVip(false)\n    setImages([])\n    setDeepLink(\"\")\n    setPreviewLink(\"\")\n    setPreviewInput(\"\")\n  }\n\n  return (\n    <Card className={className}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n          <Heart className=\"h-5 w-5 text-chart-5\" />\n          上传漫画\n        </CardTitle>\n        <div className=\"flex items-center gap-2 mt-4\">\n          {[1, 2, 3].map((s) => (\n            <div key={s} className=\"flex items-center\">\n              <div\n                className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${step >= s ? \"bg-primary text-primary-foreground\" : \"bg-muted text-muted-foreground\"}`}\n              >\n                {step > s ? <Check className=\"h-4 w-4\" /> : s}\n              </div>\n              {s < 3 && <div className={`w-12 h-0.5 mx-1 ${step > s ? \"bg-primary\" : \"bg-muted\"}`}></div>}\n            </div>\n          ))}\n        </div>\n      </CardHeader>\n      <CardContent>\n        {step === 1 && (\n          <div className=\"space-y-5\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"comic-title\">漫画标题</Label>\n              <Input\n                id=\"comic-title\"\n                placeholder=\"输入漫画标题...\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"comic-preview-link\">预览频道消息链接</Label>\n              <Input\n                id=\"comic-preview-link\"\n                placeholder=\"https://t.me/c/xxxxxxxxxx/123\"\n                value={previewInput}\n                onChange={(e) => setPreviewInput(e.target.value)}\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                先在预览频道发送含有深度链接的消息，然后复制该消息的链接粘贴到这里。\n              </p>\n            </div>\n\n            <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n              <div className=\"space-y-0.5\">\n                <Label htmlFor=\"comic-vip\" className=\"cursor-pointer\">\n                  仅限 VIP\n                </Label>\n                <p className=\"text-xs text-muted-foreground\">限制为 VIP 会员访问</p>\n              </div>\n              <Switch id=\"comic-vip\" checked={isVip} onCheckedChange={setIsVip} />\n            </div>\n\n            <Button className=\"w-full\" onClick={() => setStep(2)} disabled={!canProceedStep1}>\n              下一步：上传图片\n              <ChevronRight className=\"h-4 w-4 ml-2\" />\n            </Button>\n          </div>\n        )}\n\n        {step === 2 && (\n          <div className=\"space-y-5\">\n            <UploadDropzone images={images} onImagesChange={setImages} maxImages={200} />\n\n            <div className=\"flex gap-3\">\n              <Button variant=\"outline\" onClick={() => setStep(1)} className=\"flex-1\">\n                <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                返回\n              </Button>\n              <Button onClick={handleFinish} disabled={!canProceedStep2 || isUploading} className=\"flex-1\">\n                {isUploading ? \"上传中...\" : \"完成上传\"}\n                <ChevronRight className=\"h-4 w-4 ml-2\" />\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {step === 3 && (\n          <div className=\"space-y-5 text-center\">\n            <div className=\"w-16 h-16 rounded-full bg-success/10 flex items-center justify-center mx-auto\">\n              <Check className=\"h-8 w-8 text-success\" />\n            </div>\n\n            <div>\n              <h3 className=\"font-semibold text-lg text-card-foreground\">{title}</h3>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                已上传 {images.length} 张图片\n                {isVip && \" • 仅限 VIP\"}\n              </p>\n            </div>\n\n            <div className=\"p-4 bg-muted rounded-lg space-y-2\">\n              <Label className=\"text-xs text-muted-foreground\">深度链接</Label>\n              <div className=\"flex gap-2\">\n                <Input value={deepLink} readOnly className=\"font-mono text-xs\" />\n                <Button variant=\"outline\" size=\"icon\" onClick={copyLink}>\n                  <Copy className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n\n            <div className=\"p-4 bg-muted rounded-lg space-y-2\">\n              <Label className=\"text-xs text-muted-foreground\">预览频道链接</Label>\n              <Input value={previewLink} readOnly className=\"font-mono text-xs\" />\n            </div>\n\n            <Badge className=\"bg-success text-success-foreground\">\n              <Link2 className=\"h-3 w-3 mr-1\" />\n              已准备好分享\n            </Badge>\n\n            <Button variant=\"outline\" onClick={resetWizard} className=\"w-full bg-transparent\">\n              上传另一部漫画\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n\nfunction cn(...classes: (string | boolean | undefined)[]) {\n  return classes.filter(Boolean).join(\" \")\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2028, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/table.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Table({ className, ...props }: React.ComponentProps<'table'>) {\n  return (\n    <div\n      data-slot=\"table-container\"\n      className=\"relative w-full overflow-x-auto\"\n    >\n      <table\n        data-slot=\"table\"\n        className={cn('w-full caption-bottom text-sm', className)}\n        {...props}\n      />\n    </div>\n  )\n}\n\nfunction TableHeader({ className, ...props }: React.ComponentProps<'thead'>) {\n  return (\n    <thead\n      data-slot=\"table-header\"\n      className={cn('[&_tr]:border-b', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableBody({ className, ...props }: React.ComponentProps<'tbody'>) {\n  return (\n    <tbody\n      data-slot=\"table-body\"\n      className={cn('[&_tr:last-child]:border-0', className)}\n      {...props}\n    />\n  )\n}\n\nfunction TableFooter({ className, ...props }: React.ComponentProps<'tfoot'>) {\n  return (\n    <tfoot\n      data-slot=\"table-footer\"\n      className={cn(\n        'bg-muted/50 border-t font-medium [&>tr]:last:border-b-0',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableRow({ className, ...props }: React.ComponentProps<'tr'>) {\n  return (\n    <tr\n      data-slot=\"table-row\"\n      className={cn(\n        'hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableHead({ className, ...props }: React.ComponentProps<'th'>) {\n  return (\n    <th\n      data-slot=\"table-head\"\n      className={cn(\n        'text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCell({ className, ...props }: React.ComponentProps<'td'>) {\n  return (\n    <td\n      data-slot=\"table-cell\"\n      className={cn(\n        'p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TableCaption({\n  className,\n  ...props\n}: React.ComponentProps<'caption'>) {\n  return (\n    <caption\n      data-slot=\"table-caption\"\n      className={cn('text-muted-foreground mt-4 text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAIA;AAJA;;;AAMA,SAAS,MAAM,EAAE,SAAS,EAAE,GAAG,OAAsC;IACnE,qBACE,4TAAC;QACC,aAAU;QACV,WAAU;kBAEV,cAAA,4TAAC;YACC,aAAU;YACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;AAIjB;KAbS;AAeT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,mBAAmB;QAChC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAsC;IACvE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAsC;IACzE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAmC;IACnE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,sJACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAmC;IACpE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,aAAa,EACpB,SAAS,EACT,GAAG,OAC6B;IAChC,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 2172, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/dialog.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\nimport { XIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\n          className,\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn('text-lg leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,4TAAC,iYAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,4TAAC,oYAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,4TAAC,mYAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,4TAAC,kYAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,4TAAC,oYAAuB;QACtB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,4TAAC;QAAa,aAAU;;0BACtB,4TAAC;;;;;0BACD,4TAAC,oYAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,qHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,4TAAC,kYAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,4TAAC,gSAAK;;;;;0CACN,4TAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;MAhCS;AAkCT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,4TAAC,kYAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,4TAAC,wYAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS"}},
    {"offset": {"line": 2378, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/resource-list.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Dialog, DialogContent, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\"\nimport { Label } from \"@/components/ui/label\"\nimport { Book, Headphones, Heart, Crown, Search, ExternalLink, Trash2, Save, Copy } from \"lucide-react\"\nimport { deleteResource, fetchResources, type ResourceRecord, updateResource } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ntype ResourceType = \"all\" | \"novel\" | \"audio\" | \"comic\"\n\nconst typeConfig = {\n  novel: { icon: Book, label: \"小说\", className: \"bg-primary/10 text-primary\" },\n  audio: { icon: Headphones, label: \"音频\", className: \"bg-chart-2/10 text-chart-2\" },\n  comic: { icon: Heart, label: \"漫画\", className: \"bg-chart-5/10 text-chart-5\" },\n}\n\nconst filterLabels: Record<ResourceType, string> = {\n  all: \"全部\",\n  novel: \"小说\",\n  audio: \"音频\",\n  comic: \"漫画\",\n}\n\nexport function ResourceList() {\n  const [filter, setFilter] = useState<ResourceType>(\"all\")\n  const [search, setSearch] = useState(\"\")\n  const [resources, setResources] = useState<ResourceRecord[]>([])\n  const [loading, setLoading] = useState(false)\n  const [editMap, setEditMap] = useState<\n    Record<\n      string,\n      {\n        title: string\n        link: string\n        dirty: boolean\n        saving: boolean\n      }\n    >\n  >({})\n  const [editing, setEditing] = useState<ResourceRecord | null>(null)\n  const [editTitle, setEditTitle] = useState(\"\")\n  const [editLink, setEditLink] = useState(\"\")\n  const [savingEdit, setSavingEdit] = useState(false)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let ignore = false\n    const load = async () => {\n      try {\n        setLoading(true)\n        const data = await fetchResources(filter)\n        if (!ignore) {\n          setResources(data)\n          const nextMap: typeof editMap = {}\n          data.forEach((item) => {\n            nextMap[item.id] = {\n              title: item.title,\n              link: item.link,\n              dirty: false,\n              saving: false,\n            }\n          })\n          setEditMap(nextMap)\n        }\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"加载失败\"\n        toast({\n          title: \"读取资源失败\",\n          description: message,\n          variant: \"destructive\",\n        })\n      } finally {\n        if (!ignore) {\n          setLoading(false)\n        }\n      }\n    }\n    load()\n    return () => {\n      ignore = true\n    }\n  }, [filter, toast])\n\n  const filteredResources = resources.filter((r) => {\n    const matchesType = filter === \"all\" || r.type === filter\n    const matchesSearch = r.title.toLowerCase().includes(search.toLowerCase())\n    return matchesType && matchesSearch\n  })\n\n  const removeResource = async (id: string) => {\n    try {\n      await deleteResource(id)\n      setResources((prev) => prev.filter((item) => item.id !== id))\n      setEditMap((prev) => {\n        const clone = { ...prev }\n        delete clone[id]\n        return clone\n      })\n      toast({ title: \"已删除资源\" })\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"删除失败\"\n      toast({\n        title: \"删除失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleCopyDeepLink = async (resource: ResourceRecord) => {\n    const link = resource.deepLink ?? resource.link\n    if (!link) {\n      toast({ title: \"没有可复制的链接\", variant: \"destructive\" })\n      return\n    }\n    try {\n      await navigator.clipboard.writeText(link)\n      toast({ title: \"深度链接已复制\" })\n    } catch (error) {\n      toast({\n        title: \"复制失败\",\n        description: error instanceof Error ? error.message : \"浏览器未授权\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleFieldChange = (id: string, field: \"title\" | \"link\", value: string) => {\n    setEditMap((prev) => {\n      const current = prev[id] ?? {\n        title: \"\",\n        link: \"\",\n        dirty: false,\n        saving: false,\n      }\n      return {\n        ...prev,\n        [id]: {\n          ...current,\n          [field]: value,\n          dirty: true,\n        },\n      }\n    })\n  }\n\n  const handleRowSave = async (resource: ResourceRecord) => {\n    const entry = editMap[resource.id]\n    if (!entry || entry.saving || !entry.dirty) {\n      return\n    }\n    if (!entry.title.trim() || !entry.link.trim()) {\n      toast({ title: \"请填写完整信息\", variant: \"destructive\" })\n      return\n    }\n    try {\n      setEditMap((prev) => ({\n        ...prev,\n        [resource.id]: { ...entry, saving: true },\n      }))\n      const updated = await updateResource(resource.id, {\n        title: entry.title.trim(),\n        jump_url: entry.link.trim(),\n      })\n      setResources((prev) =>\n        prev.map((item) => (item.id === updated.id ? updated : item)),\n      )\n      setEditMap((prev) => ({\n        ...prev,\n        [resource.id]: {\n          title: updated.title,\n          link: updated.link,\n          dirty: false,\n          saving: false,\n        },\n      }))\n      toast({ title: \"已更新资源\" })\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"更新失败\"\n      toast({\n        title: \"更新失败\",\n        description: message,\n        variant: \"destructive\",\n      })\n      setEditMap((prev) => ({\n        ...prev,\n        [resource.id]: { ...entry, saving: false },\n      }))\n    }\n  }\n\n  const openEdit = (resource: ResourceRecord) => {\n    if (resource.type === \"comic\") {\n      toast({\n        title: \"暂不支持\",\n        description: \"漫画请通过上传流程重新发布。\",\n        variant: \"destructive\",\n      })\n      return\n    }\n    setEditing(resource)\n    setEditTitle(resource.title)\n    setEditLink(resource.link)\n  }\n\n  const handleEditSave = async () => {\n    if (!editing) return\n    if (!editTitle.trim() || !editLink.trim()) {\n      toast({ title: \"请输入完整信息\", variant: \"destructive\" })\n      return\n    }\n    try {\n      setSavingEdit(true)\n      const updated = await updateResource(editing.id, {\n        title: editTitle.trim(),\n        jump_url: editLink.trim(),\n      })\n      setResources((prev) =>\n        prev.map((item) => (item.id === updated.id ? updated : item)),\n      )\n      toast({ title: \"已更新资源\" })\n      setEditing(null)\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"更新失败\"\n      toast({ title: \"更新失败\", description: message, variant: \"destructive\" })\n    } finally {\n      setSavingEdit(false)\n    }\n  }\n\n  return (\n    <>\n      <Card className=\"w-full\">\n        <CardHeader>\n        <CardTitle className=\"text-card-foreground\">资源列表</CardTitle>\n        <div className=\"flex flex-col sm:flex-row gap-3 mt-4\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"搜索资源...\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              className=\"pl-9\"\n            />\n          </div>\n          <div className=\"flex gap-1\">\n            {([\"all\", \"novel\", \"audio\", \"comic\"] as const).map((type) => (\n              <Button\n                key={type}\n                variant={filter === type ? \"default\" : \"outline\"}\n                size=\"sm\"\n                onClick={() => setFilter(type)}\n              >\n                {filterLabels[type]}\n              </Button>\n            ))}\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <p className=\"text-sm text-muted-foreground px-1\">\n          小说和音频默认免费；可在此直接修改标题与链接，并保存到数据库。\n        </p>\n        <div className=\"rounded-lg border border-border overflow-hidden px-1\">\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-muted/50\">\n                <TableHead className=\"w-1/4\">标题</TableHead>\n                <TableHead className=\"w-1/4\">Telegram 链接</TableHead>\n                <TableHead>类型</TableHead>\n                <TableHead>状态</TableHead>\n                <TableHead>创建日期</TableHead>\n                <TableHead className=\"w-48 text-right\">操作</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredResources.map((resource) => {\n                const config = typeConfig[resource.type]\n                const Icon = config.icon\n                const entry = editMap[resource.id]\n                return (\n                  <TableRow key={resource.id}>\n                    <TableCell className=\"font-medium\">\n                      <Input\n                        value={entry?.title ?? resource.title}\n                        onChange={(e) => handleFieldChange(resource.id, \"title\", e.target.value)}\n                        disabled={resource.type === \"comic\"}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Input\n                        value={entry?.link ?? resource.link}\n                        onChange={(e) => handleFieldChange(resource.id, \"link\", e.target.value)}\n                        disabled={resource.type === \"comic\"}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"secondary\" className={config.className}>\n                        <Icon className=\"h-3 w-3 mr-1\" />\n                        {config.label}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      {resource.isVip && (\n                        <Badge className=\"bg-warning text-warning-foreground\">\n                          <Crown className=\"h-3 w-3 mr-1\" />\n                          VIP\n                        </Badge>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-muted-foreground text-sm\">{resource.createdAt}</TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex flex-wrap justify-end gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => window.open(resource.link, \"_blank\")}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                        </Button>\n                        <Button variant=\"secondary\" size=\"icon\" onClick={() => handleCopyDeepLink(resource)}>\n                          <Copy className=\"h-4 w-4\" />\n                        </Button>\n                        {resource.type !== \"comic\" && (\n                          <Button\n                            size=\"icon\"\n                            onClick={() => handleRowSave(resource)}\n                            disabled={!entry?.dirty || entry?.saving}\n                          >\n                            <Save className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => removeResource(resource.id)}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                )\n              })}\n              {loading && (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center py-8 text-muted-foreground\">\n                    正在加载数据...\n                  </TableCell>\n                </TableRow>\n              )}\n              {!loading && filteredResources.length === 0 && (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center py-8 text-muted-foreground\">\n                    未找到资源\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </div>\n        </CardContent>\n      </Card>\n      <Dialog open={Boolean(editing)} onOpenChange={(open) => !open && !savingEdit && setEditing(null)}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>编辑资源</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-title\">标题</Label>\n              <Input\n                id=\"edit-title\"\n                value={editTitle}\n                onChange={(e) => setEditTitle(e.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-link\">Telegram 链接</Label>\n              <Input\n                id=\"edit-link\"\n                value={editLink}\n                onChange={(e) => setEditLink(e.target.value)}\n                placeholder=\"https://t.me/...\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => !savingEdit && setEditing(null)}>\n              取消\n            </Button>\n            <Button onClick={handleEditSave} disabled={savingEdit}>\n              {savingEdit ? \"保存中...\" : \"保存\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3192, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/settings-drawer.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Settings, Save, Hash } from \"lucide-react\"\nimport { fetchSettings } from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ninterface SettingsDrawerProps {\n  username?: string | null\n}\n\nexport function SettingsDrawer({ username }: SettingsDrawerProps) {\n  const [batchSize, setBatchSize] = useState(\"\")\n  const [freeViewLimit, setFreeViewLimit] = useState(\"\")\n  const [pageSize, setPageSize] = useState(\"\")\n  const [channels, setChannels] = useState<\n    { id: number; name: string }[]\n  >([])\n  const [loading, setLoading] = useState(true)\n  const [currentPassword, setCurrentPassword] = useState(\"\")\n  const [newPassword, setNewPassword] = useState(\"\")\n  const [confirmPassword, setConfirmPassword] = useState(\"\")\n  const [changingPassword, setChangingPassword] = useState(false)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let ignore = false\n    const load = async () => {\n      try {\n        setLoading(true)\n        const data = await fetchSettings()\n        if (!ignore) {\n          setBatchSize(String(data.comicBatchSize))\n          setFreeViewLimit(String(data.freeViewLimit))\n          setPageSize(String(data.pageSize))\n          setChannels([\n            { id: data.searchChannelId, name: \"搜索频道\" },\n            { id: data.comicPreviewChannelId, name: \"漫画预览频道\" },\n            { id: data.storageChannelId, name: \"漫画仓库频道\" },\n          ])\n        }\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"加载失败\"\n        toast({\n          title: \"读取设置失败\",\n          description: message,\n          variant: \"destructive\",\n        })\n      } finally {\n        if (!ignore) {\n          setLoading(false)\n        }\n      }\n    }\n    load()\n    return () => {\n      ignore = true\n    }\n  }, [toast])\n\n  const handleSave = () => {\n    toast({\n      title: \"暂未开放在线编辑\",\n      description: \"如需修改参数，请暂时在 .env 中调整并重启服务。\",\n    })\n  }\n\n  const handlePasswordChange = async () => {\n    if (!currentPassword || !newPassword) {\n      toast({ title: \"请填写完整信息\", variant: \"destructive\" })\n      return\n    }\n    if (newPassword.length < 8) {\n      toast({ title: \"新密码至少 8 位字符\", variant: \"destructive\" })\n      return\n    }\n    if (newPassword !== confirmPassword) {\n      toast({ title: \"两次输入的新密码不一致\", variant: \"destructive\" })\n      return\n    }\n    try {\n      setChangingPassword(true)\n      const res = await fetch(\"/api/auth/change-password\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ current_password: currentPassword, new_password: newPassword }),\n      })\n      if (!res.ok) {\n        const body = await res.json().catch(() => ({}))\n        throw new Error(body.detail ?? \"修改失败\")\n      }\n      toast({ title: \"密码修改成功\" })\n      setCurrentPassword(\"\")\n      setNewPassword(\"\")\n      setConfirmPassword(\"\")\n    } catch (error) {\n      toast({\n        title: \"修改失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    } finally {\n      setChangingPassword(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            <Settings className=\"h-5 w-5\" />\n            机器人设置\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-5\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"batch-size\">批量大小</Label>\n            <Input\n              id=\"batch-size\"\n              type=\"number\"\n              value={batchSize}\n              onChange={(e) => setBatchSize(e.target.value)}\n              disabled={loading}\n              placeholder=\"10\"\n            />\n            <p className=\"text-xs text-muted-foreground\">每批上传的图片数量</p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"free-limit\">免费浏览限制</Label>\n            <Input\n              id=\"free-limit\"\n              type=\"number\"\n              value={freeViewLimit}\n              onChange={(e) => setFreeViewLimit(e.target.value)}\n              disabled={loading}\n              placeholder=\"20\"\n            />\n            <p className=\"text-xs text-muted-foreground\">需要 VIP 前的最大免费浏览次数</p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"page-size\">每页数量</Label>\n            <Input\n              id=\"page-size\"\n              type=\"number\"\n              value={pageSize}\n              onChange={(e) => setPageSize(e.target.value)}\n              disabled={loading}\n              placeholder=\"5\"\n            />\n            <p className=\"text-xs text-muted-foreground\">资源列表每页显示的项目数</p>\n          </div>\n\n          <Button onClick={handleSave} className=\"w-full\" disabled={loading}>\n            <Save className=\"h-4 w-4 mr-2\" />\n            保存设置\n          </Button>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            <Hash className=\"h-5 w-5\" />\n            已连接频道\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {channels.map((channel) => (\n              <div key={channel.id} className=\"flex items-center justify-between p-3 rounded-lg bg-muted\">\n                <div>\n                  <p className=\"font-medium text-sm\">{channel.name}</p>\n                  <p className=\"text-xs text-muted-foreground font-mono\">{channel.id}</p>\n                </div>\n                <Badge variant=\"secondary\" className=\"bg-success/10 text-success\">\n                  已连接\n                </Badge>\n              </div>\n            ))}\n            {!loading && channels.length === 0 && (\n              <p className=\"text-sm text-muted-foreground\">暂无频道信息</p>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n            账户安全\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-1\">\n            <Label>当前账户</Label>\n            <p className=\"text-sm text-muted-foreground\">{username ?? \"管理员\"}</p>\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"current-password\">当前密码</Label>\n            <Input\n              id=\"current-password\"\n              type=\"password\"\n              value={currentPassword}\n              onChange={(e) => setCurrentPassword(e.target.value)}\n              autoComplete=\"current-password\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"new-password\">新密码</Label>\n            <Input\n              id=\"new-password\"\n              type=\"password\"\n              value={newPassword}\n              onChange={(e) => setNewPassword(e.target.value)}\n              autoComplete=\"new-password\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"confirm-password\">确认新密码</Label>\n            <Input\n              id=\"confirm-password\"\n              type=\"password\"\n              value={confirmPassword}\n              onChange={(e) => setConfirmPassword(e.target.value)}\n              autoComplete=\"new-password\"\n            />\n          </div>\n          <Button onClick={handlePasswordChange} disabled={changingPassword}>\n            {changingPassword ? \"更新中...\" : \"修改密码\"}\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3782, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/ui/separator.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SeparatorPrimitive from '@radix-ui/react-separator'\n\nimport { cn } from '@/lib/utils'\n\nfunction Separator({\n  className,\n  orientation = 'horizontal',\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        'bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,4TAAC,iYAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,qHAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf;KAlBS"}},
    {"offset": {"line": 3817, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/components/search-button-manager.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useMemo, useState } from \"react\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Button } from \"@/components/ui/button\"\nimport { Label } from \"@/components/ui/label\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Copy, Link2, Plus, Save, Trash2 } from \"lucide-react\"\nimport {\n  createSearchButton,\n  deleteSearchButton,\n  fetchSearchButtons,\n  type SearchButtonRecord,\n  updateSearchButton,\n} from \"@/lib/api\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ntype EditState = Record<\n  number,\n  {\n    label: string\n    url: string\n    sortOrder: string\n    dirty: boolean\n    saving: boolean\n  }\n>\n\nexport function SearchButtonManager() {\n  const [buttons, setButtons] = useState<SearchButtonRecord[]>([])\n  const [editMap, setEditMap] = useState<EditState>({})\n  const [newLabel, setNewLabel] = useState(\"\")\n  const [newUrl, setNewUrl] = useState(\"\")\n  const [newOrder, setNewOrder] = useState(\"\")\n  const [loading, setLoading] = useState(false)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let ignore = false\n    const load = async () => {\n      try {\n        setLoading(true)\n        const data = await fetchSearchButtons()\n        if (!ignore) {\n          setButtons(data)\n          const draft: EditState = {}\n          data.forEach((item) => {\n            draft[item.id] = {\n              label: item.label,\n              url: item.url,\n              sortOrder: String(item.sortOrder),\n              dirty: false,\n              saving: false,\n            }\n          })\n          setEditMap(draft)\n        }\n      } catch (error) {\n        toast({\n          title: \"读取按钮失败\",\n          description: error instanceof Error ? error.message : \"网络异常\",\n          variant: \"destructive\",\n        })\n      } finally {\n        if (!ignore) {\n          setLoading(false)\n        }\n      }\n    }\n    load()\n    return () => {\n      ignore = true\n    }\n  }, [toast])\n\n  const nextSortOrder = useMemo(() => {\n    if (!buttons.length) return 0\n    return Math.max(...buttons.map((b) => b.sortOrder)) + 1\n  }, [buttons])\n\n  useEffect(() => {\n    if (!newOrder) {\n      setNewOrder(String(nextSortOrder))\n    }\n  }, [nextSortOrder, newOrder])\n\n  const handleFieldChange = (id: number, field: keyof Pick<EditState[number], \"label\" | \"url\" | \"sortOrder\">, value: string) => {\n    setEditMap((prev) => {\n      const current = prev[id] ?? { label: \"\", url: \"\", sortOrder: \"0\", dirty: false, saving: false }\n      return {\n        ...prev,\n        [id]: { ...current, [field]: value, dirty: true },\n      }\n    })\n  }\n\n  const persistRow = async (button: SearchButtonRecord) => {\n    const state = editMap[button.id]\n    if (!state || state.saving || !state.dirty) return\n    if (!state.label.trim() || !state.url.trim()) {\n      toast({ title: \"请输入完整信息\", variant: \"destructive\" })\n      return\n    }\n    const sortOrder = Number(state.sortOrder)\n    if (Number.isNaN(sortOrder)) {\n      toast({ title: \"排序必须是数字\", variant: \"destructive\" })\n      return\n    }\n    setEditMap((prev) => ({ ...prev, [button.id]: { ...state, saving: true } }))\n    try {\n      const updated = await updateSearchButton(button.id, {\n        label: state.label.trim(),\n        url: state.url.trim(),\n        sort_order: sortOrder,\n      })\n      setButtons((prev) =>\n        prev\n          .map((item) => (item.id === updated.id ? updated : item))\n          .sort((a, b) => a.sortOrder - b.sortOrder),\n      )\n      setEditMap((prev) => ({\n        ...prev,\n        [button.id]: {\n          label: updated.label,\n          url: updated.url,\n          sortOrder: String(updated.sortOrder),\n          dirty: false,\n          saving: false,\n        },\n      }))\n      toast({ title: \"按钮已保存\" })\n    } catch (error) {\n      toast({\n        title: \"保存失败\",\n        description: error instanceof Error ? error.message : \"请稍后重试\",\n        variant: \"destructive\",\n      })\n      setEditMap((prev) => ({ ...prev, [button.id]: { ...state, saving: false } }))\n    }\n  }\n\n  const handleAdd = async () => {\n    if (!newLabel.trim() || !newUrl.trim()) {\n      toast({ title: \"请填写按钮文本和链接\", variant: \"destructive\" })\n      return\n    }\n    const sortOrder = Number(newOrder || nextSortOrder)\n    if (Number.isNaN(sortOrder)) {\n      toast({ title: \"排序编号需为数字\", variant: \"destructive\" })\n      return\n    }\n    try {\n      const created = await createSearchButton({\n        label: newLabel.trim(),\n        url: newUrl.trim(),\n        sort_order: sortOrder,\n      })\n      setButtons((prev) => [...prev, created].sort((a, b) => a.sortOrder - b.sortOrder))\n      setEditMap((prev) => ({\n        ...prev,\n        [created.id]: {\n          label: created.label,\n          url: created.url,\n          sortOrder: String(created.sortOrder),\n          dirty: false,\n          saving: false,\n        },\n      }))\n      setNewLabel(\"\")\n      setNewUrl(\"\")\n      setNewOrder(String(created.sortOrder + 1))\n      toast({ title: \"新增按钮成功\" })\n    } catch (error) {\n      toast({\n        title: \"新增失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleDelete = async (id: number) => {\n    try {\n      await deleteSearchButton(id)\n      setButtons((prev) => prev.filter((btn) => btn.id !== id))\n      setEditMap((prev) => {\n        const clone = { ...prev }\n        delete clone[id]\n        return clone\n      })\n      toast({ title: \"已删除按钮\" })\n    } catch (error) {\n      toast({\n        title: \"删除失败\",\n        description: error instanceof Error ? error.message : \"请稍后再试\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  const handleCopy = async (text: string) => {\n    try {\n      await navigator.clipboard.writeText(text)\n      toast({ title: \"已复制到剪贴板\" })\n    } catch (error) {\n      toast({\n        title: \"复制失败\",\n        description: error instanceof Error ? error.message : \"浏览器未授权\",\n        variant: \"destructive\",\n      })\n    }\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-card-foreground\">\n          <Link2 className=\"h-5 w-5\" />\n          搜索结果底部按钮\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        <div className=\"grid gap-4 sm:grid-cols-3\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"new-label\">按钮文本</Label>\n            <Input\n              id=\"new-label\"\n              placeholder=\"例如：联系客服\"\n              value={newLabel}\n              onChange={(e) => setNewLabel(e.target.value)}\n            />\n          </div>\n          <div className=\"space-y-2 sm:col-span-2\">\n            <Label htmlFor=\"new-url\">按钮链接</Label>\n            <Input\n              id=\"new-url\"\n              placeholder=\"https://t.me/...\"\n              value={newUrl}\n              onChange={(e) => setNewUrl(e.target.value)}\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"new-order\">排序（越小越靠前）</Label>\n            <Input\n              id=\"new-order\"\n              type=\"number\"\n              value={newOrder}\n              onChange={(e) => setNewOrder(e.target.value)}\n            />\n          </div>\n        </div>\n        <Button onClick={handleAdd} disabled={loading} className=\"w-full sm:w-auto\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          新增按钮\n        </Button>\n\n        <Separator />\n\n        <div className=\"rounded-lg border border-border overflow-hidden\">\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-muted/50\">\n                <TableHead className=\"w-1/4\">按钮文本</TableHead>\n                <TableHead>跳转链接</TableHead>\n                <TableHead className=\"w-24\">排序</TableHead>\n                <TableHead className=\"w-48 text-right\">操作</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {buttons.map((button) => {\n                const entry = editMap[button.id]\n                return (\n                  <TableRow key={button.id}>\n                    <TableCell>\n                      <Input\n                        value={entry?.label ?? button.label}\n                        onChange={(e) => handleFieldChange(button.id, \"label\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Input\n                        value={entry?.url ?? button.url}\n                        onChange={(e) => handleFieldChange(button.id, \"url\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Input\n                        type=\"number\"\n                        value={entry?.sortOrder ?? String(button.sortOrder)}\n                        onChange={(e) => handleFieldChange(button.id, \"sortOrder\", e.target.value)}\n                      />\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex justify-end gap-2\">\n                        <Button variant=\"secondary\" size=\"icon\" onClick={() => handleCopy(entry?.url ?? button.url)}>\n                          <Copy className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          onClick={() => persistRow(button)}\n                          disabled={!entry?.dirty || entry?.saving}\n                        >\n                          <Save className=\"h-4 w-4\" />\n                        </Button>\n                        <Button variant=\"destructive\" size=\"icon\" onClick={() => handleDelete(button.id)}>\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                )\n              })}\n              {!buttons.length && (\n                <TableRow>\n                  <TableCell colSpan={4} className=\"text-center py-6 text-muted-foreground\">\n                    暂无按钮，请先添加\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4462, "column": 0}, "map": {"version":3,"sources":["file:///Users/wanghaixin/Development/telegramBotWork/SearchBot/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { Sidebar } from \"@/components/sidebar\"\nimport { NovelAudioForm } from \"@/components/novel-audio-form\"\nimport { ComicUploadWizard } from \"@/components/comic-upload-wizard\"\nimport { ResourceList } from \"@/components/resource-list\"\nimport { SettingsDrawer } from \"@/components/settings-drawer\"\nimport { SearchButtonManager } from \"@/components/search-button-manager\"\nimport { Button } from \"@/components/ui/button\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\ntype NavItem = \"novel-audio\" | \"comic\" | \"resources\" | \"settings\"\n\ninterface Session {\n  username: string\n}\n\nexport default function Dashboard() {\n  const [activeItem, setActiveItem] = useState<NavItem>(\"novel-audio\")\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false)\n  const [session, setSession] = useState<Session | null>(null)\n  const [checkingAuth, setCheckingAuth] = useState(true)\n  const router = useRouter()\n  const { toast } = useToast()\n\n  useEffect(() => {\n    let cancelled = false\n    const check = async () => {\n      try {\n        const res = await fetch(\"/api/auth/session\", { cache: \"no-store\" })\n        if (!res.ok) {\n          router.replace(\"/login\")\n          return\n        }\n        const data = (await res.json()) as Session\n        if (!cancelled) {\n          setSession(data)\n        }\n      } catch {\n        router.replace(\"/login\")\n      } finally {\n        if (!cancelled) {\n          setCheckingAuth(false)\n        }\n      }\n    }\n    check()\n    return () => {\n      cancelled = true\n    }\n  }, [router])\n\n  const handleLogout = async () => {\n    await fetch(\"/api/auth/logout\", { method: \"POST\" })\n    toast({ title: \"已退出登录\" })\n    router.replace(\"/login\")\n  }\n\n  if (checkingAuth) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center text-muted-foreground\">\n        验证身份中...\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-background\">\n      <Sidebar\n        activeItem={activeItem}\n        onItemChange={setActiveItem}\n        collapsed={sidebarCollapsed}\n        onCollapsedChange={setSidebarCollapsed}\n        onLogout={handleLogout}\n      />\n\n      <main className=\"flex-1 overflow-auto flex justify-center\">\n        <div className=\"w-full p-6 lg:p-8 max-w-6xl mx-auto space-y-6\">\n          <header className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-foreground\">\n                {activeItem === \"novel-audio\" && \"索引小说 / 音频\"}\n                {activeItem === \"comic\" && \"上传漫画\"}\n                {activeItem === \"resources\" && \"管理资源\"}\n                {activeItem === \"settings\" && \"设置\"}\n              </h1>\n              <p className=\"text-muted-foreground mt-1\">\n                {activeItem === \"novel-audio\" && \"添加新的小说或有声书到你的 Telegram 机器人\"}\n                {activeItem === \"comic\" && \"批量上传漫画图片\"}\n                {activeItem === \"resources\" && \"查看和管理所有已索引的资源\"}\n                {activeItem === \"settings\" && \"配置机器人设置并查看已连接的频道\"}\n              </p>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              {session && <span className=\"text-sm text-muted-foreground\">👤 {session.username}</span>}\n              <Button variant=\"outline\" onClick={handleLogout}>\n                退出登录\n              </Button>\n            </div>\n          </header>\n\n          {activeItem === \"novel-audio\" && <NovelAudioForm className=\"w-full\" />}\n          {activeItem === \"comic\" && <ComicUploadWizard className=\"w-full\" />}\n          {activeItem === \"resources\" && <ResourceList />}\n          {activeItem === \"settings\" && (\n            <div className=\"space-y-6\">\n              <SettingsDrawer username={session?.username} />\n              <SearchButtonManager />\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAXA;;;;;;;;;;;AAmBe,SAAS;;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,wSAAQ,EAAU;IACtD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,wSAAQ,EAAC;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wSAAQ,EAAiB;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,wSAAQ,EAAC;IACjD,MAAM,SAAS,IAAA,iRAAS;IACxB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,+IAAQ;IAE1B,IAAA,ySAAS;+BAAC;YACR,IAAI,YAAY;YAChB,MAAM;6CAAQ;oBACZ,IAAI;wBACF,MAAM,MAAM,MAAM,MAAM,qBAAqB;4BAAE,OAAO;wBAAW;wBACjE,IAAI,CAAC,IAAI,EAAE,EAAE;4BACX,OAAO,OAAO,CAAC;4BACf;wBACF;wBACA,MAAM,OAAQ,MAAM,IAAI,IAAI;wBAC5B,IAAI,CAAC,WAAW;4BACd,WAAW;wBACb;oBACF,EAAE,OAAM;wBACN,OAAO,OAAO,CAAC;oBACjB,SAAU;wBACR,IAAI,CAAC,WAAW;4BACd,gBAAgB;wBAClB;oBACF;gBACF;;YACA;YACA;uCAAO;oBACL,YAAY;gBACd;;QACF;8BAAG;QAAC;KAAO;IAEX,MAAM,eAAe;QACnB,MAAM,MAAM,oBAAoB;YAAE,QAAQ;QAAO;QACjD,MAAM;YAAE,OAAO;QAAQ;QACvB,OAAO,OAAO,CAAC;IACjB;IAEA,IAAI,cAAc;QAChB,qBACE,4TAAC;YAAI,WAAU;sBAAsE;;;;;;IAIzF;IAEA,qBACE,4TAAC;QAAI,WAAU;;0BACb,4TAAC,oIAAO;gBACN,YAAY;gBACZ,cAAc;gBACd,WAAW;gBACX,mBAAmB;gBACnB,UAAU;;;;;;0BAGZ,4TAAC;gBAAK,WAAU;0BACd,cAAA,4TAAC;oBAAI,WAAU;;sCACb,4TAAC;4BAAO,WAAU;;8CAChB,4TAAC;;sDACC,4TAAC;4CAAG,WAAU;;gDACX,eAAe,iBAAiB;gDAChC,eAAe,WAAW;gDAC1B,eAAe,eAAe;gDAC9B,eAAe,cAAc;;;;;;;sDAEhC,4TAAC;4CAAE,WAAU;;gDACV,eAAe,iBAAiB;gDAChC,eAAe,WAAW;gDAC1B,eAAe,eAAe;gDAC9B,eAAe,cAAc;;;;;;;;;;;;;8CAGlC,4TAAC;oCAAI,WAAU;;wCACZ,yBAAW,4TAAC;4CAAK,WAAU;;gDAAgC;gDAAI,QAAQ,QAAQ;;;;;;;sDAChF,4TAAC,wIAAM;4CAAC,SAAQ;4CAAU,SAAS;sDAAc;;;;;;;;;;;;;;;;;;wBAMpD,eAAe,+BAAiB,4TAAC,0JAAc;4BAAC,WAAU;;;;;;wBAC1D,eAAe,yBAAW,4TAAC,gKAAiB;4BAAC,WAAU;;;;;;wBACvD,eAAe,6BAAe,4TAAC,kJAAY;;;;;wBAC3C,eAAe,4BACd,4TAAC;4BAAI,WAAU;;8CACb,4TAAC,sJAAc;oCAAC,UAAU,SAAS;;;;;;8CACnC,4TAAC,oKAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOlC;GAjGwB;;QAKP,iRAAS;QACN,+IAAQ;;;KANJ"}}]
}